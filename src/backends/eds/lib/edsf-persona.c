/* edsf-persona.c generated by valac 0.20.1.30-1b1d, the Vala compiler
 * generated from edsf-persona.vala, do not modify */

/*
 * Copyright (C) 2011 Collabora Ltd.
 * Copyright (C) 2013 Philip Withnall
 *
 * This library is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 2.1 of the License, or
 * (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Authors:
 *       Travis Reitter <travis.reitter@collabora.co.uk>
 *       Marco Barisione <marco.barisione@collabora.co.uk>
 *       Raul Gutierrez Segales <raul.gutierrez.segales@collabora.co.uk>
 */

#include <glib.h>
#include <glib-object.h>
#include <folks/folks.h>
#include <libebook-contacts/libebook-contacts.h>
#include <gee.h>
#include <stdlib.h>
#include <string.h>
#include <folks/small-set.h>
#include <gio/gio.h>
#include <libebook/libebook.h>
#include <folks/small-set-internal.h>
#include <folks-internal.h>


#define EDSF_TYPE_PERSONA (edsf_persona_get_type ())
#define EDSF_PERSONA(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), EDSF_TYPE_PERSONA, EdsfPersona))
#define EDSF_PERSONA_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), EDSF_TYPE_PERSONA, EdsfPersonaClass))
#define EDSF_IS_PERSONA(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), EDSF_TYPE_PERSONA))
#define EDSF_IS_PERSONA_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), EDSF_TYPE_PERSONA))
#define EDSF_PERSONA_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), EDSF_TYPE_PERSONA, EdsfPersonaClass))

typedef struct _EdsfPersona EdsfPersona;
typedef struct _EdsfPersonaClass EdsfPersonaClass;
typedef struct _EdsfPersonaPrivate EdsfPersonaPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_date_time_unref0(var) ((var == NULL) ? NULL : (var = (g_date_time_unref (var), NULL)))

#define EDSF_PERSONA_TYPE_URL_TYPE_MAPPING (edsf_persona_url_type_mapping_get_type ())
typedef struct _EdsfPersonaUrlTypeMapping EdsfPersonaUrlTypeMapping;

#define EDSF_TYPE_PERSONA_STORE (edsf_persona_store_get_type ())
#define EDSF_PERSONA_STORE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore))
#define EDSF_PERSONA_STORE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), EDSF_TYPE_PERSONA_STORE, EdsfPersonaStoreClass))
#define EDSF_IS_PERSONA_STORE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), EDSF_TYPE_PERSONA_STORE))
#define EDSF_IS_PERSONA_STORE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), EDSF_TYPE_PERSONA_STORE))
#define EDSF_PERSONA_STORE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), EDSF_TYPE_PERSONA_STORE, EdsfPersonaStoreClass))

typedef struct _EdsfPersonaStore EdsfPersonaStore;
typedef struct _EdsfPersonaStoreClass EdsfPersonaStoreClass;
typedef struct _EdsfPersonaChangeWebServiceAddressesData EdsfPersonaChangeWebServiceAddressesData;
typedef struct _EdsfPersonaChangeLocalIdsData EdsfPersonaChangeLocalIdsData;
typedef struct _EdsfPersonaChangeLocationData EdsfPersonaChangeLocationData;
typedef struct _EdsfPersonaChangePostalAddressesData EdsfPersonaChangePostalAddressesData;
typedef struct _EdsfPersonaChangePhoneNumbersData EdsfPersonaChangePhoneNumbersData;
typedef struct _EdsfPersonaChangeEmailAddressesData EdsfPersonaChangeEmailAddressesData;
typedef struct _EdsfPersonaChangeNotesData EdsfPersonaChangeNotesData;
typedef struct _EdsfPersonaChangeAvatarData EdsfPersonaChangeAvatarData;
typedef struct _EdsfPersonaChangeStructuredNameData EdsfPersonaChangeStructuredNameData;
typedef struct _EdsfPersonaChangeFullNameData EdsfPersonaChangeFullNameData;
typedef struct _EdsfPersonaChangeNicknameData EdsfPersonaChangeNicknameData;
typedef struct _EdsfPersonaChangeGenderData EdsfPersonaChangeGenderData;
typedef struct _EdsfPersonaChangeUrlsData EdsfPersonaChangeUrlsData;
typedef struct _EdsfPersonaChangeImAddressesData EdsfPersonaChangeImAddressesData;
typedef struct _EdsfPersonaChangeGroupData EdsfPersonaChangeGroupData;
typedef struct _EdsfPersonaChangeGroupsData EdsfPersonaChangeGroupsData;
typedef struct _EdsfPersonaChangeSystemGroupsData EdsfPersonaChangeSystemGroupsData;
typedef struct _EdsfPersonaChangeInGooglePersonalGroupData EdsfPersonaChangeInGooglePersonalGroupData;
typedef struct _EdsfPersonaChangeBirthdayData EdsfPersonaChangeBirthdayData;
typedef struct _EdsfPersonaChangeRolesData EdsfPersonaChangeRolesData;
typedef struct _EdsfPersonaChangeIsFavouriteData EdsfPersonaChangeIsFavouriteData;
typedef struct _EdsfPersonaChangeAntiLinksData EdsfPersonaChangeAntiLinksData;
#define __vala_EVCardAttribute_free0(var) ((var == NULL) ? NULL : (var = (_vala_EVCardAttribute_free (var), NULL)))
#define __vala_EContactDate_free0(var) ((var == NULL) ? NULL : (var = (_vala_EContactDate_free (var), NULL)))
#define __vala_EVCardAttributeParam_free0(var) ((var == NULL) ? NULL : (var = (_vala_EVCardAttributeParam_free (var), NULL)))
#define __g_list_free___vala_EVCardAttribute_free0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free___vala_EVCardAttribute_free0_ (var), NULL)))
#define __vala_EContactName_free0(var) ((var == NULL) ? NULL : (var = (_vala_EContactName_free (var), NULL)))
#define __vala_EContactPhoto_free0(var) ((var == NULL) ? NULL : (var = (_vala_EContactPhoto_free (var), NULL)))

#define EDSF_TYPE_MEMORY_ICON (edsf_memory_icon_get_type ())
#define EDSF_MEMORY_ICON(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), EDSF_TYPE_MEMORY_ICON, EdsfMemoryIcon))
#define EDSF_MEMORY_ICON_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), EDSF_TYPE_MEMORY_ICON, EdsfMemoryIconClass))
#define EDSF_IS_MEMORY_ICON(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), EDSF_TYPE_MEMORY_ICON))
#define EDSF_IS_MEMORY_ICON_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), EDSF_TYPE_MEMORY_ICON))
#define EDSF_MEMORY_ICON_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), EDSF_TYPE_MEMORY_ICON, EdsfMemoryIconClass))

typedef struct _EdsfMemoryIcon EdsfMemoryIcon;
typedef struct _EdsfMemoryIconClass EdsfMemoryIconClass;
typedef struct _Block1Data Block1Data;
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))
#define _g_hash_table_unref0(var) ((var == NULL) ? NULL : (var = (g_hash_table_unref (var), NULL)))
#define __g_list_free__g_free0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free__g_free0_ (var), NULL)))
#define __vala_EContactGeo_free0(var) ((var == NULL) ? NULL : (var = (_vala_EContactGeo_free (var), NULL)))
#define _t_destroy_func0(var) (((var == NULL) || (t_destroy_func == NULL)) ? NULL : (var = (t_destroy_func (var), NULL)))

struct _EdsfPersona {
	FolksPersona parent_instance;
	EdsfPersonaPrivate * priv;
};

struct _EdsfPersonaClass {
	FolksPersonaClass parent_class;
};

struct _EdsfPersonaPrivate {
	EContact* _contact;
	GeeHashMultiMap* _web_service_addresses;
	FolksSmallSet* _local_ids;
	GeeSet* _local_ids_ro;
	FolksLocation* _location;
	FolksSmallSet* _postal_addresses;
	GeeSet* _postal_addresses_ro;
	FolksSmallSet* _phone_numbers;
	GeeSet* _phone_numbers_ro;
	FolksSmallSet* _email_addresses;
	GeeSet* _email_addresses_ro;
	FolksSmallSet* _notes;
	GeeSet* _notes_ro;
	GLoadableIcon* _avatar;
	FolksStructuredName* _structured_name;
	gchar* _contact_id;
	gchar* _full_name;
	gchar* _nickname;
	FolksGender _gender;
	FolksSmallSet* _urls;
	GeeSet* _urls_ro;
	GeeHashMultiMap* _im_addresses;
	FolksSmallSet* _groups;
	GeeSet* _groups_ro;
	GDateTime* _birthday;
	FolksSmallSet* _roles;
	GeeSet* _roles_ro;
	gboolean _is_favourite;
	FolksSmallSet* _anti_links;
	GeeSet* _anti_links_ro;
	FolksSmallSet* _system_groups;
	GeeSet* _system_groups_ro;
	gboolean _in_google_personal_group;
};

struct _EdsfPersonaUrlTypeMapping {
	gchar* vcard_field_name;
	gchar* folks_type;
};

struct _EdsfPersonaChangeWebServiceAddressesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeMultiMap* web_service_addresses;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeMultiMap* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeLocalIdsData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* local_ids;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeLocationData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	FolksLocation* location;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	FolksLocation* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangePostalAddressesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* postal_addresses;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangePhoneNumbersData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* phone_numbers;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeEmailAddressesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* email_addresses;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeNotesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* notes;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeAvatarData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GLoadableIcon* avatar;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GLoadableIcon* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeStructuredNameData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	FolksStructuredName* structured_name;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	FolksStructuredName* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeFullNameData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	gchar* full_name;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	const gchar* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeNicknameData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	gchar* nickname;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	const gchar* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeGenderData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	FolksGender gender;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	FolksGender _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeUrlsData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* urls;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeImAddressesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeMultiMap* im_addresses;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeMultiMap* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeGroupData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	gchar* group;
	gboolean is_member;
	gboolean _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
	GeeSet* _tmp3_;
	GeeSet* _tmp4_;
	const gchar* _tmp5_;
	gboolean _tmp6_;
	gboolean _tmp7_;
	gboolean _tmp8_;
	gboolean _tmp9_;
	GeeSet* _tmp10_;
	GeeSet* _tmp11_;
	const gchar* _tmp12_;
	gboolean _tmp13_;
	gboolean _tmp14_;
	gboolean _tmp15_;
	FolksSmallSet* new_groups;
	GeeSet* _tmp16_;
	GeeSet* _tmp17_;
	FolksSmallSet* _tmp18_;
	gboolean _tmp19_;
	FolksSmallSet* _tmp20_;
	const gchar* _tmp21_;
	FolksSmallSet* _tmp22_;
	const gchar* _tmp23_;
	FolksSmallSet* _tmp24_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeGroupsData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* groups;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeSystemGroupsData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* system_groups;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeInGooglePersonalGroupData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	gboolean in_personal;
	gboolean _tmp0_;
	gboolean _tmp1_;
	FolksSmallSet* new_system_groups;
	FolksSmallSet* _tmp2_;
	FolksSmallSet* _tmp3_;
	gboolean _tmp4_;
	FolksSmallSet* _tmp5_;
	FolksSmallSet* _tmp6_;
	FolksPersonaStore* _tmp7_;
	FolksPersonaStore* _tmp8_;
	FolksSmallSet* _tmp9_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeBirthdayData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GDateTime* bday;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GDateTime* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeRolesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* roles;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeIsFavouriteData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	gboolean is_favourite;
	gboolean _tmp0_;
	gboolean _tmp1_;
	FolksPersonaStore* _tmp2_;
	FolksPersonaStore* _tmp3_;
	gboolean _tmp4_;
	GError * _inner_error_;
};

struct _EdsfPersonaChangeAntiLinksData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	EdsfPersona* self;
	GeeSet* anti_links;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	GeeSet* _tmp2_;
	GError * _inner_error_;
};

struct _Block1Data {
	int _ref_count_;
	EdsfPersona * self;
	FolksAvatarCache* cache;
	GLoadableIcon* new_avatar;
};


static gpointer edsf_persona_parent_class = NULL;
static GHashTable* edsf_persona__im_eds_map;
static GStaticRecMutex __lock_edsf_persona__im_eds_map = {0};
static GHashTable* edsf_persona__im_eds_map = NULL;
static GTimeZone* edsf_persona__local_time_zone;
static GTimeZone* edsf_persona__local_time_zone = NULL;
static FolksAntiLinkableIface* edsf_persona_folks_anti_linkable_parent_iface = NULL;
static FolksAvatarDetailsIface* edsf_persona_folks_avatar_details_parent_iface = NULL;
static FolksBirthdayDetailsIface* edsf_persona_folks_birthday_details_parent_iface = NULL;
static FolksEmailDetailsIface* edsf_persona_folks_email_details_parent_iface = NULL;
static FolksFavouriteDetailsIface* edsf_persona_folks_favourite_details_parent_iface = NULL;
static FolksGenderDetailsIface* edsf_persona_folks_gender_details_parent_iface = NULL;
static FolksGroupDetailsIface* edsf_persona_folks_group_details_parent_iface = NULL;
static FolksImDetailsIface* edsf_persona_folks_im_details_parent_iface = NULL;
static FolksLocalIdDetailsIface* edsf_persona_folks_local_id_details_parent_iface = NULL;
static FolksLocationDetailsIface* edsf_persona_folks_location_details_parent_iface = NULL;
static FolksNameDetailsIface* edsf_persona_folks_name_details_parent_iface = NULL;
static FolksNoteDetailsIface* edsf_persona_folks_note_details_parent_iface = NULL;
static FolksPhoneDetailsIface* edsf_persona_folks_phone_details_parent_iface = NULL;
static FolksRoleDetailsIface* edsf_persona_folks_role_details_parent_iface = NULL;
static FolksUrlDetailsIface* edsf_persona_folks_url_details_parent_iface = NULL;
static FolksPostalAddressDetailsIface* edsf_persona_folks_postal_address_details_parent_iface = NULL;
static FolksWebServiceDetailsIface* edsf_persona_folks_web_service_details_parent_iface = NULL;

GType edsf_persona_get_type (void) G_GNUC_CONST;
#define EDSF_PERSONA_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), EDSF_TYPE_PERSONA, EdsfPersonaPrivate))
enum  {
	EDSF_PERSONA_DUMMY_PROPERTY,
	EDSF_PERSONA_CONTACT,
	EDSF_PERSONA_WEB_SERVICE_ADDRESSES,
	EDSF_PERSONA_LOCAL_IDS,
	EDSF_PERSONA_LOCATION,
	EDSF_PERSONA_POSTAL_ADDRESSES,
	EDSF_PERSONA_PHONE_NUMBERS,
	EDSF_PERSONA_EMAIL_ADDRESSES,
	EDSF_PERSONA_NOTES,
	EDSF_PERSONA_LINKABLE_PROPERTIES,
	EDSF_PERSONA_WRITEABLE_PROPERTIES,
	EDSF_PERSONA_AVATAR,
	EDSF_PERSONA_STRUCTURED_NAME,
	EDSF_PERSONA_CONTACT_ID,
	EDSF_PERSONA_FULL_NAME,
	EDSF_PERSONA_NICKNAME,
	EDSF_PERSONA_GENDER,
	EDSF_PERSONA_URLS,
	EDSF_PERSONA_IM_ADDRESSES,
	EDSF_PERSONA_GROUPS,
	EDSF_PERSONA_CALENDAR_EVENT_ID,
	EDSF_PERSONA_BIRTHDAY,
	EDSF_PERSONA_ROLES,
	EDSF_PERSONA_IS_FAVOURITE,
	EDSF_PERSONA_ANTI_LINKS,
	EDSF_PERSONA_SYSTEM_GROUPS,
	EDSF_PERSONA_IN_GOOGLE_PERSONAL_GROUP
};
static guint _folks_abstract_field_details_hash_static_gee_hash_data_func (gconstpointer v, gpointer self);
static gboolean _folks_abstract_field_details_equal_static_gee_equal_data_func (gconstpointer a, gconstpointer b, gpointer self);
static GType edsf_persona_url_type_mapping_get_type (void) G_GNUC_CONST G_GNUC_UNUSED;
static EdsfPersonaUrlTypeMapping* edsf_persona_url_type_mapping_dup (const EdsfPersonaUrlTypeMapping* self);
static void edsf_persona_url_type_mapping_free (EdsfPersonaUrlTypeMapping* self);
static void edsf_persona_url_type_mapping_copy (const EdsfPersonaUrlTypeMapping* self, EdsfPersonaUrlTypeMapping* dest);
static void edsf_persona_url_type_mapping_destroy (EdsfPersonaUrlTypeMapping* self);
#define EDSF_PERSONA_gender_attribute_name "X-GENDER"
#define EDSF_PERSONA_gender_male "M"
#define EDSF_PERSONA_gender_female "F"
#define EDSF_PERSONA_GOOGLE_PERSONAL_GROUP_NAME "Contacts"
static void edsf_persona_real_change_web_service_addresses_data_free (gpointer _data);
static void edsf_persona_real_change_web_service_addresses (FolksWebServiceDetails* base, GeeMultiMap* web_service_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_web_service_addresses_co (EdsfPersonaChangeWebServiceAddressesData* _data_);
GType edsf_persona_store_get_type (void) G_GNUC_CONST;
void _edsf_persona_store_set_web_service_addresses (EdsfPersonaStore* self, EdsfPersona* persona, GeeMultiMap* web_service_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_web_service_addresses_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_web_service_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_local_ids_data_free (gpointer _data);
static void edsf_persona_real_change_local_ids (FolksLocalIdDetails* base, GeeSet* local_ids, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_local_ids_co (EdsfPersonaChangeLocalIdsData* _data_);
void _edsf_persona_store_set_local_ids (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* local_ids, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_local_ids_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_local_ids_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_location_data_free (gpointer _data);
static void edsf_persona_real_change_location (FolksLocationDetails* base, FolksLocation* location, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_location_co (EdsfPersonaChangeLocationData* _data_);
void _edsf_persona_store_set_location (EdsfPersonaStore* self, EdsfPersona* persona, FolksLocation* location, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_location_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_location_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_postal_addresses_data_free (gpointer _data);
static void edsf_persona_real_change_postal_addresses (FolksPostalAddressDetails* base, GeeSet* postal_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_postal_addresses_co (EdsfPersonaChangePostalAddressesData* _data_);
void _edsf_persona_store_set_postal_addresses (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* postal_fds, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_postal_addresses_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_postal_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_phone_numbers_data_free (gpointer _data);
static void edsf_persona_real_change_phone_numbers (FolksPhoneDetails* base, GeeSet* phone_numbers, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_phone_numbers_co (EdsfPersonaChangePhoneNumbersData* _data_);
void _edsf_persona_store_set_phones (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* phones, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_phones_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_phone_numbers_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_email_addresses_data_free (gpointer _data);
static void edsf_persona_real_change_email_addresses (FolksEmailDetails* base, GeeSet* email_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_email_addresses_co (EdsfPersonaChangeEmailAddressesData* _data_);
void _edsf_persona_store_set_emails (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* emails, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_emails_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_email_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_notes_data_free (gpointer _data);
static void edsf_persona_real_change_notes (FolksNoteDetails* base, GeeSet* notes, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_notes_co (EdsfPersonaChangeNotesData* _data_);
void _edsf_persona_store_set_notes (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* notes, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_notes_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_notes_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_avatar_data_free (gpointer _data);
static void edsf_persona_real_change_avatar (FolksAvatarDetails* base, GLoadableIcon* avatar, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_avatar_co (EdsfPersonaChangeAvatarData* _data_);
void _edsf_persona_store_set_avatar (EdsfPersonaStore* self, EdsfPersona* persona, GLoadableIcon* avatar, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_avatar_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_avatar_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_structured_name_data_free (gpointer _data);
static void edsf_persona_real_change_structured_name (FolksNameDetails* base, FolksStructuredName* structured_name, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_structured_name_co (EdsfPersonaChangeStructuredNameData* _data_);
void _edsf_persona_store_set_structured_name (EdsfPersonaStore* self, EdsfPersona* persona, FolksStructuredName* sname, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_structured_name_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_structured_name_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_full_name_data_free (gpointer _data);
static void edsf_persona_real_change_full_name (FolksNameDetails* base, const gchar* full_name, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_full_name_co (EdsfPersonaChangeFullNameData* _data_);
void _edsf_persona_store_set_full_name (EdsfPersonaStore* self, EdsfPersona* persona, const gchar* full_name, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_full_name_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_full_name_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_nickname_data_free (gpointer _data);
static void edsf_persona_real_change_nickname (FolksNameDetails* base, const gchar* nickname, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_nickname_co (EdsfPersonaChangeNicknameData* _data_);
void _edsf_persona_store_set_nickname (EdsfPersonaStore* self, EdsfPersona* persona, const gchar* nickname, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_nickname_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_nickname_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_gender_data_free (gpointer _data);
static void edsf_persona_real_change_gender (FolksGenderDetails* base, FolksGender gender, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_gender_co (EdsfPersonaChangeGenderData* _data_);
void _edsf_persona_store_set_gender (EdsfPersonaStore* self, EdsfPersona* persona, FolksGender gender, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_gender_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_gender_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_urls_data_free (gpointer _data);
static void edsf_persona_real_change_urls (FolksUrlDetails* base, GeeSet* urls, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_urls_co (EdsfPersonaChangeUrlsData* _data_);
void _edsf_persona_store_set_urls (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* urls, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_urls_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_urls_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_im_addresses_data_free (gpointer _data);
static void edsf_persona_real_change_im_addresses (FolksImDetails* base, GeeMultiMap* im_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_im_addresses_co (EdsfPersonaChangeImAddressesData* _data_);
void _edsf_persona_store_set_im_fds (EdsfPersonaStore* self, EdsfPersona* persona, GeeMultiMap* im_fds, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_im_fds_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_im_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_group_data_free (gpointer _data);
static void edsf_persona_real_change_group (FolksGroupDetails* base, const gchar* group, gboolean is_member, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_group_co (EdsfPersonaChangeGroupData* _data_);
static void edsf_persona_change_group_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_groups_data_free (gpointer _data);
static void edsf_persona_real_change_groups (FolksGroupDetails* base, GeeSet* groups, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_groups_co (EdsfPersonaChangeGroupsData* _data_);
void _edsf_persona_store_set_groups (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* groups, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_groups_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_groups_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_change_system_groups_data_free (gpointer _data);
void edsf_persona_change_system_groups (EdsfPersona* self, GeeSet* system_groups, GAsyncReadyCallback _callback_, gpointer _user_data_);
void edsf_persona_change_system_groups_finish (EdsfPersona* self, GAsyncResult* _res_, GError** error);
static gboolean edsf_persona_change_system_groups_co (EdsfPersonaChangeSystemGroupsData* _data_);
void _edsf_persona_store_set_system_groups (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* system_groups, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_system_groups_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_system_groups_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_change_in_google_personal_group_data_free (gpointer _data);
void edsf_persona_change_in_google_personal_group (EdsfPersona* self, gboolean in_personal, GAsyncReadyCallback _callback_, gpointer _user_data_);
void edsf_persona_change_in_google_personal_group_finish (EdsfPersona* self, GAsyncResult* _res_, GError** error);
static gboolean edsf_persona_change_in_google_personal_group_co (EdsfPersonaChangeInGooglePersonalGroupData* _data_);
static void edsf_persona_change_in_google_personal_group_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_birthday_data_free (gpointer _data);
static void edsf_persona_real_change_birthday (FolksBirthdayDetails* base, GDateTime* bday, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_birthday_co (EdsfPersonaChangeBirthdayData* _data_);
void _edsf_persona_store_set_birthday (EdsfPersonaStore* self, EdsfPersona* persona, GDateTime* bday, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_birthday_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_birthday_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_roles_data_free (gpointer _data);
static void edsf_persona_real_change_roles (FolksRoleDetails* base, GeeSet* roles, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_roles_co (EdsfPersonaChangeRolesData* _data_);
void _edsf_persona_store_set_roles (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* roles, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_roles_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_roles_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_is_favourite_data_free (gpointer _data);
static void edsf_persona_real_change_is_favourite (FolksFavouriteDetails* base, gboolean is_favourite, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_is_favourite_co (EdsfPersonaChangeIsFavouriteData* _data_);
void _edsf_persona_store_set_is_favourite (EdsfPersonaStore* self, EdsfPersona* persona, gboolean is_favourite, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_is_favourite_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_is_favourite_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
static void edsf_persona_real_change_anti_links_data_free (gpointer _data);
static void edsf_persona_real_change_anti_links (FolksAntiLinkable* base, GeeSet* anti_links, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean edsf_persona_real_change_anti_links_co (EdsfPersonaChangeAntiLinksData* _data_);
void _edsf_persona_store_set_anti_links (EdsfPersonaStore* self, EdsfPersona* persona, GeeSet* anti_links, GAsyncReadyCallback _callback_, gpointer _user_data_);
void _edsf_persona_store_set_anti_links_finish (EdsfPersonaStore* self, GAsyncResult* _res_, GError** error);
static void edsf_persona_change_anti_links_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
gchar* edsf_persona_build_iid_from_contact (const gchar* store_id, EContact* contact);
gpointer _edsf_persona_get_property_from_contact (GType t_type, GBoxedCopyFunc t_dup_func, GDestroyNotify t_destroy_func, EContact* contact, const gchar* prop_name);
gchar* edsf_persona_build_iid (const gchar* store_id, const gchar* contact_id);
EdsfPersona* edsf_persona_new (EdsfPersonaStore* store, EContact* contact);
EdsfPersona* edsf_persona_construct (GType object_type, EdsfPersonaStore* store, EContact* contact);
static void edsf_persona_real_linkable_property_to_links (FolksPersona* base, const gchar* prop_name, FolksPersonaLinkablePropertyCallback callback, void* callback_target);
void _edsf_persona_update (EdsfPersona* self, EContact* updated_contact);
static void _edsf_persona_update_names (EdsfPersona* self);
static void _edsf_persona_update_avatar (EdsfPersona* self);
static void _edsf_persona_update_urls (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification);
static void _edsf_persona_update_phones (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification);
static void _edsf_persona_update_addresses (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification);
static void _edsf_persona_update_emails (EdsfPersona* self, gboolean emit_notification);
static void _edsf_persona_update_im_addresses (EdsfPersona* self);
static void _edsf_persona_update_groups (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification);
static void _edsf_persona_update_notes (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification);
static void _edsf_persona_update_local_ids (EdsfPersona* self);
static void _edsf_persona_update_location (EdsfPersona* self);
static void _edsf_persona_update_web_services_addresses (EdsfPersona* self);
static void _edsf_persona_update_gender (EdsfPersona* self);
static void _edsf_persona_update_birthday (EdsfPersona* self);
static void _edsf_persona_update_roles (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification);
static void _edsf_persona_update_favourite (EdsfPersona* self);
static void _edsf_persona_update_anti_links (EdsfPersona* self);
static void _edsf_persona_update_params (EdsfPersona* self, FolksAbstractFieldDetails* details, EVCardAttribute* attr);
EContact* edsf_persona_get_contact (EdsfPersona* self);
static EVCardAttribute* _vala_EVCardAttribute_copy (EVCardAttribute* self);
static void _vala_EVCardAttribute_free (EVCardAttribute* self);
static gpointer _edsf_persona_get_property (EdsfPersona* self, GType t_type, GBoxedCopyFunc t_dup_func, GDestroyNotify t_destroy_func, const gchar* prop_name);
static EContactDate* _vala_EContactDate_copy (EContactDate* self);
static void _vala_EContactDate_free (EContactDate* self);
static FolksRoleFieldDetails* _edsf_persona_get_default_role (EdsfPersona* self);
static EVCardAttributeParam* _vala_EVCardAttributeParam_copy (EVCardAttributeParam* self);
static void _vala_EVCardAttributeParam_free (EVCardAttributeParam* self);
static void __vala_EVCardAttribute_free0_ (gpointer var);
static void _g_list_free___vala_EVCardAttribute_free0_ (GList* self);
static EContactName* _vala_EContactName_copy (EContactName* self);
static void _vala_EContactName_free (EContactName* self);
static GLoadableIcon* _edsf_persona_contact_photo_to_loadable_icon (EdsfPersona* self, EContactPhoto* _p);
static EContactPhoto* _vala_EContactPhoto_copy (EContactPhoto* self);
static void _vala_EContactPhoto_free (EContactPhoto* self);
static guint8* _vala_array_dup1 (guint8* self, int length);
EdsfMemoryIcon* edsf_memory_icon_new (const gchar* image_type, guint8* image_data, int image_data_length1);
EdsfMemoryIcon* edsf_memory_icon_construct (GType object_type, const gchar* image_type, guint8* image_data, int image_data_length1);
GType edsf_memory_icon_get_type (void) G_GNUC_CONST;
static Block1Data* block1_data_ref (Block1Data* _data1_);
static void block1_data_unref (void * _userdata_);
static void ___lambda7_ (Block1Data* _data1_, GObject* obj, GAsyncResult* res);
static void ____lambda7__gasync_ready_callback (GObject* source_object, GAsyncResult* res, gpointer self);
static void ____lambda8_ (Block1Data* _data1_, GObject* obj, GAsyncResult* res);
static void _____lambda8__gasync_ready_callback (GObject* source_object, GAsyncResult* res, gpointer self);
GHashTable* _edsf_persona_get_im_eds_map (void);
static gchar* _edsf_persona_im_proto_from_addr (EdsfPersona* self, const gchar* addr);
gboolean _edsf_persona_store_is_google_contacts_address_book (EdsfPersonaStore* self);
#define EDSF_PERSONA_STORE_android_favourite_group_name "Starred in Android"
static void _g_free0_ (gpointer var);
static void _g_list_free__g_free0_ (GList* self);
static FolksPostalAddress* _edsf_persona_postal_address_from_attribute (EdsfPersona* self, EVCardAttribute* attr);
static EContactGeo* _vala_EContactGeo_copy (EContactGeo* self);
static void _vala_EContactGeo_free (EContactGeo* self);
#define EDSF_PERSONA_STORE_anti_links_attribute_name "X-FOLKS-ANTI-LINKS"
static void edsf_persona_set_contact (EdsfPersona* self, EContact* value);
const gchar* edsf_persona_get_contact_id (EdsfPersona* self);
static void edsf_persona_set_contact_id (EdsfPersona* self, const gchar* value);
GeeSet* edsf_persona_get_system_groups (EdsfPersona* self);
void edsf_persona_set_system_groups (EdsfPersona* self, GeeSet* value);
gboolean edsf_persona_get_in_google_personal_group (EdsfPersona* self);
void edsf_persona_set_in_google_personal_group (EdsfPersona* self, gboolean value);
static GObject * edsf_persona_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties);
static void edsf_persona_finalize (GObject* obj);
static void _vala_edsf_persona_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_edsf_persona_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);

const gchar* EDSF_PERSONA_phone_fields[12] = {"assistant_phone", "business_phone", "business_phone_2", "callback_phone", "car_phone", "company_phone", "home_phone", "home_phone_2", "isdn_phone", "mobile_phone", "other_phone", "primary_phone"};
const gchar* EDSF_PERSONA_address_fields[3] = {"address_home", "address_other", "address_work"};
const gchar* EDSF_PERSONA_email_fields[4] = {"email_1", "email_2", "email_3", "email_4"};
const gchar* EDSF_PERSONA_url_properties[4] = {"blog_url", "fburl", "homepage_url", "video_url"};
const EdsfPersonaUrlTypeMapping EDSF_PERSONA__url_properties[4] = {{"homepage_url", FOLKS_URL_FIELD_DETAILS_PARAM_TYPE_HOME_PAGE}, {"blog_url", FOLKS_URL_FIELD_DETAILS_PARAM_TYPE_BLOG}, {"fburl", "x-free-busy"}, {"video_url", "x-video"}};
static const gchar* EDSF_PERSONA__linkable_properties[4] = {"im-addresses", "email-addresses", "local-ids", "web-service-addresses"};

static guint _folks_abstract_field_details_hash_static_gee_hash_data_func (gconstpointer v, gpointer self) {
	guint result;
	result = folks_abstract_field_details_hash_static (v);
	return result;
}


static gboolean _folks_abstract_field_details_equal_static_gee_equal_data_func (gconstpointer a, gconstpointer b, gpointer self) {
	gboolean result;
	result = folks_abstract_field_details_equal_static (a, b);
	return result;
}


static void edsf_persona_real_change_web_service_addresses_data_free (gpointer _data) {
	EdsfPersonaChangeWebServiceAddressesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->web_service_addresses);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeWebServiceAddressesData, _data_);
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static void edsf_persona_real_change_web_service_addresses (FolksWebServiceDetails* base, GeeMultiMap* web_service_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeWebServiceAddressesData* _data_;
	EdsfPersona* _tmp0_;
	GeeMultiMap* _tmp1_;
	GeeMultiMap* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeWebServiceAddressesData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_web_service_addresses);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_web_service_addresses_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = web_service_addresses;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->web_service_addresses);
	_data_->web_service_addresses = _tmp2_;
	edsf_persona_real_change_web_service_addresses_co (_data_);
}


static void edsf_persona_real_change_web_service_addresses_finish (FolksWebServiceDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeWebServiceAddressesData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_web_service_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeWebServiceAddressesData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_web_service_addresses_co (_data_);
}


static gboolean edsf_persona_real_change_web_service_addresses_co (EdsfPersonaChangeWebServiceAddressesData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->web_service_addresses;
	_data_->_state_ = 1;
	_edsf_persona_store_set_web_service_addresses (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_web_service_addresses_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_web_service_addresses_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_local_ids_data_free (gpointer _data) {
	EdsfPersonaChangeLocalIdsData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->local_ids);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeLocalIdsData, _data_);
}


static void edsf_persona_real_change_local_ids (FolksLocalIdDetails* base, GeeSet* local_ids, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeLocalIdsData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeLocalIdsData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_local_ids);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_local_ids_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = local_ids;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->local_ids);
	_data_->local_ids = _tmp2_;
	edsf_persona_real_change_local_ids_co (_data_);
}


static void edsf_persona_real_change_local_ids_finish (FolksLocalIdDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeLocalIdsData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_local_ids_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeLocalIdsData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_local_ids_co (_data_);
}


static gboolean edsf_persona_real_change_local_ids_co (EdsfPersonaChangeLocalIdsData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->local_ids;
	_data_->_state_ = 1;
	_edsf_persona_store_set_local_ids (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_local_ids_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_local_ids_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_location_data_free (gpointer _data) {
	EdsfPersonaChangeLocationData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->location);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeLocationData, _data_);
}


static void edsf_persona_real_change_location (FolksLocationDetails* base, FolksLocation* location, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeLocationData* _data_;
	EdsfPersona* _tmp0_;
	FolksLocation* _tmp1_;
	FolksLocation* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeLocationData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_location);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_location_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = location;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->location);
	_data_->location = _tmp2_;
	edsf_persona_real_change_location_co (_data_);
}


static void edsf_persona_real_change_location_finish (FolksLocationDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeLocationData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.9.2
   */
static void edsf_persona_change_location_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeLocationData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_location_co (_data_);
}


static gboolean edsf_persona_real_change_location_co (EdsfPersonaChangeLocationData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->location;
	_data_->_state_ = 1;
	_edsf_persona_store_set_location (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_location_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_location_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_postal_addresses_data_free (gpointer _data) {
	EdsfPersonaChangePostalAddressesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->postal_addresses);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangePostalAddressesData, _data_);
}


static void edsf_persona_real_change_postal_addresses (FolksPostalAddressDetails* base, GeeSet* postal_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangePostalAddressesData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangePostalAddressesData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_postal_addresses);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_postal_addresses_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = postal_addresses;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->postal_addresses);
	_data_->postal_addresses = _tmp2_;
	edsf_persona_real_change_postal_addresses_co (_data_);
}


static void edsf_persona_real_change_postal_addresses_finish (FolksPostalAddressDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangePostalAddressesData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_postal_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangePostalAddressesData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_postal_addresses_co (_data_);
}


static gboolean edsf_persona_real_change_postal_addresses_co (EdsfPersonaChangePostalAddressesData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->postal_addresses;
	_data_->_state_ = 1;
	_edsf_persona_store_set_postal_addresses (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_postal_addresses_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_postal_addresses_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_phone_numbers_data_free (gpointer _data) {
	EdsfPersonaChangePhoneNumbersData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->phone_numbers);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangePhoneNumbersData, _data_);
}


static void edsf_persona_real_change_phone_numbers (FolksPhoneDetails* base, GeeSet* phone_numbers, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangePhoneNumbersData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangePhoneNumbersData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_phone_numbers);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_phone_numbers_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = phone_numbers;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->phone_numbers);
	_data_->phone_numbers = _tmp2_;
	edsf_persona_real_change_phone_numbers_co (_data_);
}


static void edsf_persona_real_change_phone_numbers_finish (FolksPhoneDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangePhoneNumbersData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_phone_numbers_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangePhoneNumbersData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_phone_numbers_co (_data_);
}


static gboolean edsf_persona_real_change_phone_numbers_co (EdsfPersonaChangePhoneNumbersData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->phone_numbers;
	_data_->_state_ = 1;
	_edsf_persona_store_set_phones (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_phone_numbers_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_phones_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_email_addresses_data_free (gpointer _data) {
	EdsfPersonaChangeEmailAddressesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->email_addresses);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeEmailAddressesData, _data_);
}


static void edsf_persona_real_change_email_addresses (FolksEmailDetails* base, GeeSet* email_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeEmailAddressesData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeEmailAddressesData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_email_addresses);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_email_addresses_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = email_addresses;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->email_addresses);
	_data_->email_addresses = _tmp2_;
	edsf_persona_real_change_email_addresses_co (_data_);
}


static void edsf_persona_real_change_email_addresses_finish (FolksEmailDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeEmailAddressesData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_email_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeEmailAddressesData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_email_addresses_co (_data_);
}


static gboolean edsf_persona_real_change_email_addresses_co (EdsfPersonaChangeEmailAddressesData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->email_addresses;
	_data_->_state_ = 1;
	_edsf_persona_store_set_emails (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_email_addresses_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_emails_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_notes_data_free (gpointer _data) {
	EdsfPersonaChangeNotesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->notes);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeNotesData, _data_);
}


static void edsf_persona_real_change_notes (FolksNoteDetails* base, GeeSet* notes, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeNotesData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeNotesData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_notes);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_notes_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = notes;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->notes);
	_data_->notes = _tmp2_;
	edsf_persona_real_change_notes_co (_data_);
}


static void edsf_persona_real_change_notes_finish (FolksNoteDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeNotesData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_notes_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeNotesData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_notes_co (_data_);
}


static gboolean edsf_persona_real_change_notes_co (EdsfPersonaChangeNotesData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->notes;
	_data_->_state_ = 1;
	_edsf_persona_store_set_notes (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_notes_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_notes_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_avatar_data_free (gpointer _data) {
	EdsfPersonaChangeAvatarData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->avatar);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeAvatarData, _data_);
}


static void edsf_persona_real_change_avatar (FolksAvatarDetails* base, GLoadableIcon* avatar, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeAvatarData* _data_;
	EdsfPersona* _tmp0_;
	GLoadableIcon* _tmp1_;
	GLoadableIcon* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeAvatarData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_avatar);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_avatar_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = avatar;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->avatar);
	_data_->avatar = _tmp2_;
	edsf_persona_real_change_avatar_co (_data_);
}


static void edsf_persona_real_change_avatar_finish (FolksAvatarDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeAvatarData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_avatar_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeAvatarData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_avatar_co (_data_);
}


static gboolean edsf_persona_real_change_avatar_co (EdsfPersonaChangeAvatarData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->avatar;
	_data_->_state_ = 1;
	_edsf_persona_store_set_avatar (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_avatar_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_avatar_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_structured_name_data_free (gpointer _data) {
	EdsfPersonaChangeStructuredNameData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->structured_name);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeStructuredNameData, _data_);
}


static void edsf_persona_real_change_structured_name (FolksNameDetails* base, FolksStructuredName* structured_name, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeStructuredNameData* _data_;
	EdsfPersona* _tmp0_;
	FolksStructuredName* _tmp1_;
	FolksStructuredName* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeStructuredNameData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_structured_name);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_structured_name_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = structured_name;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->structured_name);
	_data_->structured_name = _tmp2_;
	edsf_persona_real_change_structured_name_co (_data_);
}


static void edsf_persona_real_change_structured_name_finish (FolksNameDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeStructuredNameData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_structured_name_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeStructuredNameData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_structured_name_co (_data_);
}


static gboolean edsf_persona_real_change_structured_name_co (EdsfPersonaChangeStructuredNameData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->structured_name;
	_data_->_state_ = 1;
	_edsf_persona_store_set_structured_name (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_structured_name_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_structured_name_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_full_name_data_free (gpointer _data) {
	EdsfPersonaChangeFullNameData* _data_;
	_data_ = _data;
	_g_free0 (_data_->full_name);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeFullNameData, _data_);
}


static void edsf_persona_real_change_full_name (FolksNameDetails* base, const gchar* full_name, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeFullNameData* _data_;
	EdsfPersona* _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeFullNameData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_full_name);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_full_name_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = full_name;
	_tmp2_ = g_strdup (_tmp1_);
	_g_free0 (_data_->full_name);
	_data_->full_name = _tmp2_;
	edsf_persona_real_change_full_name_co (_data_);
}


static void edsf_persona_real_change_full_name_finish (FolksNameDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeFullNameData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_full_name_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeFullNameData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_full_name_co (_data_);
}


static gboolean edsf_persona_real_change_full_name_co (EdsfPersonaChangeFullNameData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->full_name;
	_data_->_state_ = 1;
	_edsf_persona_store_set_full_name (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_full_name_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_full_name_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_nickname_data_free (gpointer _data) {
	EdsfPersonaChangeNicknameData* _data_;
	_data_ = _data;
	_g_free0 (_data_->nickname);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeNicknameData, _data_);
}


static void edsf_persona_real_change_nickname (FolksNameDetails* base, const gchar* nickname, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeNicknameData* _data_;
	EdsfPersona* _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeNicknameData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_nickname);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_nickname_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = nickname;
	_tmp2_ = g_strdup (_tmp1_);
	_g_free0 (_data_->nickname);
	_data_->nickname = _tmp2_;
	edsf_persona_real_change_nickname_co (_data_);
}


static void edsf_persona_real_change_nickname_finish (FolksNameDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeNicknameData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_nickname_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeNicknameData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_nickname_co (_data_);
}


static gboolean edsf_persona_real_change_nickname_co (EdsfPersonaChangeNicknameData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->nickname;
	_data_->_state_ = 1;
	_edsf_persona_store_set_nickname (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_nickname_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_nickname_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_gender_data_free (gpointer _data) {
	EdsfPersonaChangeGenderData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeGenderData, _data_);
}


static void edsf_persona_real_change_gender (FolksGenderDetails* base, FolksGender gender, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeGenderData* _data_;
	EdsfPersona* _tmp0_;
	FolksGender _tmp1_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeGenderData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_gender);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_gender_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = gender;
	_data_->gender = _tmp1_;
	edsf_persona_real_change_gender_co (_data_);
}


static void edsf_persona_real_change_gender_finish (FolksGenderDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeGenderData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_gender_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeGenderData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_gender_co (_data_);
}


static gboolean edsf_persona_real_change_gender_co (EdsfPersonaChangeGenderData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->gender;
	_data_->_state_ = 1;
	_edsf_persona_store_set_gender (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_gender_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_gender_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_urls_data_free (gpointer _data) {
	EdsfPersonaChangeUrlsData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->urls);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeUrlsData, _data_);
}


static void edsf_persona_real_change_urls (FolksUrlDetails* base, GeeSet* urls, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeUrlsData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeUrlsData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_urls);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_urls_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = urls;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->urls);
	_data_->urls = _tmp2_;
	edsf_persona_real_change_urls_co (_data_);
}


static void edsf_persona_real_change_urls_finish (FolksUrlDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeUrlsData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_urls_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeUrlsData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_urls_co (_data_);
}


static gboolean edsf_persona_real_change_urls_co (EdsfPersonaChangeUrlsData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->urls;
	_data_->_state_ = 1;
	_edsf_persona_store_set_urls (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_urls_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_urls_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_im_addresses_data_free (gpointer _data) {
	EdsfPersonaChangeImAddressesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->im_addresses);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeImAddressesData, _data_);
}


static void edsf_persona_real_change_im_addresses (FolksImDetails* base, GeeMultiMap* im_addresses, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeImAddressesData* _data_;
	EdsfPersona* _tmp0_;
	GeeMultiMap* _tmp1_;
	GeeMultiMap* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeImAddressesData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_im_addresses);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_im_addresses_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = im_addresses;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->im_addresses);
	_data_->im_addresses = _tmp2_;
	edsf_persona_real_change_im_addresses_co (_data_);
}


static void edsf_persona_real_change_im_addresses_finish (FolksImDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeImAddressesData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_im_addresses_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeImAddressesData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_im_addresses_co (_data_);
}


static gboolean edsf_persona_real_change_im_addresses_co (EdsfPersonaChangeImAddressesData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->im_addresses;
	_data_->_state_ = 1;
	_edsf_persona_store_set_im_fds (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_im_addresses_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_im_fds_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_group_data_free (gpointer _data) {
	EdsfPersonaChangeGroupData* _data_;
	_data_ = _data;
	_g_free0 (_data_->group);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeGroupData, _data_);
}


static void edsf_persona_real_change_group (FolksGroupDetails* base, const gchar* group, gboolean is_member, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeGroupData* _data_;
	EdsfPersona* _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_;
	gboolean _tmp3_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeGroupData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_group);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_group_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = group;
	_tmp2_ = g_strdup (_tmp1_);
	_g_free0 (_data_->group);
	_data_->group = _tmp2_;
	_tmp3_ = is_member;
	_data_->is_member = _tmp3_;
	edsf_persona_real_change_group_co (_data_);
}


static void edsf_persona_real_change_group_finish (FolksGroupDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeGroupData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.0
   */
static void edsf_persona_change_group_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeGroupData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_group_co (_data_);
}


static gboolean edsf_persona_real_change_group_co (EdsfPersonaChangeGroupData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp2_ = _data_->is_member;
	if (_data_->_tmp2_ == TRUE) {
		_data_->_tmp3_ = folks_group_details_get_groups ((FolksGroupDetails*) _data_->self);
		_data_->_tmp4_ = _data_->_tmp3_;
		_data_->_tmp5_ = _data_->group;
		_data_->_tmp6_ = FALSE;
		_data_->_tmp6_ = gee_collection_contains ((GeeCollection*) _data_->_tmp4_, _data_->_tmp5_);
		_data_->_tmp1_ = _data_->_tmp6_ == TRUE;
	} else {
		_data_->_tmp1_ = FALSE;
	}
	_data_->_tmp7_ = _data_->_tmp1_;
	if (_data_->_tmp7_) {
		_data_->_tmp0_ = TRUE;
	} else {
		_data_->_tmp9_ = _data_->is_member;
		if (_data_->_tmp9_ == FALSE) {
			_data_->_tmp10_ = folks_group_details_get_groups ((FolksGroupDetails*) _data_->self);
			_data_->_tmp11_ = _data_->_tmp10_;
			_data_->_tmp12_ = _data_->group;
			_data_->_tmp13_ = FALSE;
			_data_->_tmp13_ = gee_collection_contains ((GeeCollection*) _data_->_tmp11_, _data_->_tmp12_);
			_data_->_tmp8_ = _data_->_tmp13_ == FALSE;
		} else {
			_data_->_tmp8_ = FALSE;
		}
		_data_->_tmp14_ = _data_->_tmp8_;
		_data_->_tmp0_ = _data_->_tmp14_;
	}
	_data_->_tmp15_ = _data_->_tmp0_;
	if (_data_->_tmp15_) {
		if (_data_->_state_ == 0) {
			g_simple_async_result_complete_in_idle (_data_->_async_result);
		} else {
			g_simple_async_result_complete (_data_->_async_result);
		}
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_data_->_tmp16_ = folks_group_details_get_groups ((FolksGroupDetails*) _data_->self);
	_data_->_tmp17_ = _data_->_tmp16_;
	_data_->_tmp18_ = NULL;
	_data_->_tmp18_ = folks_small_set_copy ((GeeIterable*) _data_->_tmp17_, NULL, NULL, NULL, NULL, NULL, NULL);
	_data_->new_groups = _data_->_tmp18_;
	_data_->_tmp19_ = _data_->is_member;
	if (_data_->_tmp19_ == FALSE) {
		_data_->_tmp20_ = _data_->new_groups;
		_data_->_tmp21_ = _data_->group;
		gee_abstract_collection_remove ((GeeAbstractCollection*) _data_->_tmp20_, _data_->_tmp21_);
	} else {
		_data_->_tmp22_ = _data_->new_groups;
		_data_->_tmp23_ = _data_->group;
		gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp22_, _data_->_tmp23_);
	}
	_data_->_tmp24_ = _data_->new_groups;
	_data_->_state_ = 1;
	folks_group_details_change_groups ((FolksGroupDetails*) _data_->self, (GeeSet*) _data_->_tmp24_, edsf_persona_change_group_ready, _data_);
	return FALSE;
	_state_1:
	folks_group_details_change_groups_finish ((FolksGroupDetails*) _data_->self, _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
		g_error_free (_data_->_inner_error_);
		_g_object_unref0 (_data_->new_groups);
		if (_data_->_state_ == 0) {
			g_simple_async_result_complete_in_idle (_data_->_async_result);
		} else {
			g_simple_async_result_complete (_data_->_async_result);
		}
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_g_object_unref0 (_data_->new_groups);
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_groups_data_free (gpointer _data) {
	EdsfPersonaChangeGroupsData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->groups);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeGroupsData, _data_);
}


static void edsf_persona_real_change_groups (FolksGroupDetails* base, GeeSet* groups, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeGroupsData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeGroupsData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_groups);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_groups_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = groups;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->groups);
	_data_->groups = _tmp2_;
	edsf_persona_real_change_groups_co (_data_);
}


static void edsf_persona_real_change_groups_finish (FolksGroupDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeGroupsData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_groups_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeGroupsData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_groups_co (_data_);
}


static gboolean edsf_persona_real_change_groups_co (EdsfPersonaChangeGroupsData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->groups;
	_data_->_state_ = 1;
	_edsf_persona_store_set_groups (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_groups_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_groups_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_change_system_groups_data_free (gpointer _data) {
	EdsfPersonaChangeSystemGroupsData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->system_groups);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeSystemGroupsData, _data_);
}


void edsf_persona_change_system_groups (EdsfPersona* self, GeeSet* system_groups, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersonaChangeSystemGroupsData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	_data_ = g_slice_new0 (EdsfPersonaChangeSystemGroupsData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_change_system_groups);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_change_system_groups_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = system_groups;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->system_groups);
	_data_->system_groups = _tmp2_;
	edsf_persona_change_system_groups_co (_data_);
}


void edsf_persona_change_system_groups_finish (EdsfPersona* self, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeSystemGroupsData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * Change the contact's system groups.
   *
   * The system groups are a property exposed by Google Contacts address books,
   * and can include any combination of the following identifier:
   * - "Contacts"
   * - "Family"
   * - "Friends"
   * - "Coworkers"
   *
   * Setting the system groups will also change the group membership to include
   * the localized version of those groups, and may change the value of
   * {@link Edsf.Persona.in_google_personal_group}.
   *
   * Attempting to call this method on a persona beloging to a PersonaStore which
   * is not Google will throw a PropertyError.
   *
   * It's preferred to call this rather than setting {@link Persona.system_groups}
   * directly, as this method gives error notification and will only return once
   * the groups have been written to the relevant backing store (or the
   * operation's failed).
   *
   * @param system_groups the complete set of system group ids the contact should be a member of
   * @throws PropertyError if setting the groups failed
   * @since 0.9.0
   */
static void edsf_persona_change_system_groups_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeSystemGroupsData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_change_system_groups_co (_data_);
}


static gboolean edsf_persona_change_system_groups_co (EdsfPersonaChangeSystemGroupsData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->system_groups;
	_data_->_state_ = 1;
	_edsf_persona_store_set_system_groups (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_system_groups_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_system_groups_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_change_in_google_personal_group_data_free (gpointer _data) {
	EdsfPersonaChangeInGooglePersonalGroupData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeInGooglePersonalGroupData, _data_);
}


void edsf_persona_change_in_google_personal_group (EdsfPersona* self, gboolean in_personal, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersonaChangeInGooglePersonalGroupData* _data_;
	EdsfPersona* _tmp0_;
	gboolean _tmp1_;
	_data_ = g_slice_new0 (EdsfPersonaChangeInGooglePersonalGroupData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_change_in_google_personal_group);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_change_in_google_personal_group_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = in_personal;
	_data_->in_personal = _tmp1_;
	edsf_persona_change_in_google_personal_group_co (_data_);
}


void edsf_persona_change_in_google_personal_group_finish (EdsfPersona* self, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeInGooglePersonalGroupData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * Change whether this contact belongs to the personal group or not.
   *
   * The personal contact group is a concept that exists only in Google
   * address books. Other backends will throw a PropertyError.
   *
   * It's preferred to call this rather than setting {@link Persona.in_google_personal_group}
   * directly, as this method gives error notification and will only return once
   * the membership has been written to the relevant backing store (or the
   * operation's failed).
   *
   * @param in_personal Whether to add or remove the personal group membership
   * @throws PropertyError if the address book is not Google, or if setting the property failed
   * @since 0.9.0
   */
static void edsf_persona_change_in_google_personal_group_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeInGooglePersonalGroupData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_change_in_google_personal_group_co (_data_);
}


static gboolean edsf_persona_change_in_google_personal_group_co (EdsfPersonaChangeInGooglePersonalGroupData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = _data_->in_personal;
	_data_->_tmp1_ = _data_->self->priv->_in_google_personal_group;
	if (_data_->_tmp0_ == _data_->_tmp1_) {
		if (_data_->_state_ == 0) {
			g_simple_async_result_complete_in_idle (_data_->_async_result);
		} else {
			g_simple_async_result_complete (_data_->_async_result);
		}
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_data_->_tmp2_ = _data_->self->priv->_system_groups;
	_data_->_tmp3_ = NULL;
	_data_->_tmp3_ = folks_small_set_copy ((GeeIterable*) _data_->_tmp2_, NULL, NULL, NULL, NULL, NULL, NULL);
	_data_->new_system_groups = _data_->_tmp3_;
	_data_->_tmp4_ = _data_->in_personal;
	if (_data_->_tmp4_) {
		_data_->_tmp5_ = _data_->new_system_groups;
		gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp5_, EDSF_PERSONA_GOOGLE_PERSONAL_GROUP_NAME);
	} else {
		_data_->_tmp6_ = _data_->new_system_groups;
		gee_abstract_collection_remove ((GeeAbstractCollection*) _data_->_tmp6_, EDSF_PERSONA_GOOGLE_PERSONAL_GROUP_NAME);
	}
	_data_->_tmp7_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp8_ = _data_->_tmp7_;
	_data_->_tmp9_ = _data_->new_system_groups;
	_data_->_state_ = 1;
	_edsf_persona_store_set_system_groups (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp8_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, (GeeSet*) _data_->_tmp9_, edsf_persona_change_in_google_personal_group_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_system_groups_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp8_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			_g_object_unref0 (_data_->new_system_groups);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			_g_object_unref0 (_data_->new_system_groups);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	_g_object_unref0 (_data_->new_system_groups);
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_birthday_data_free (gpointer _data) {
	EdsfPersonaChangeBirthdayData* _data_;
	_data_ = _data;
	_g_date_time_unref0 (_data_->bday);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeBirthdayData, _data_);
}


static gpointer _g_date_time_ref0 (gpointer self) {
	return self ? g_date_time_ref (self) : NULL;
}


static void edsf_persona_real_change_birthday (FolksBirthdayDetails* base, GDateTime* bday, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeBirthdayData* _data_;
	EdsfPersona* _tmp0_;
	GDateTime* _tmp1_;
	GDateTime* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeBirthdayData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_birthday);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_birthday_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = bday;
	_tmp2_ = _g_date_time_ref0 (_tmp1_);
	_g_date_time_unref0 (_data_->bday);
	_data_->bday = _tmp2_;
	edsf_persona_real_change_birthday_co (_data_);
}


static void edsf_persona_real_change_birthday_finish (FolksBirthdayDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeBirthdayData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_birthday_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeBirthdayData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_birthday_co (_data_);
}


static gboolean edsf_persona_real_change_birthday_co (EdsfPersonaChangeBirthdayData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->bday;
	_data_->_state_ = 1;
	_edsf_persona_store_set_birthday (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_birthday_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_birthday_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_roles_data_free (gpointer _data) {
	EdsfPersonaChangeRolesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->roles);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeRolesData, _data_);
}


static void edsf_persona_real_change_roles (FolksRoleDetails* base, GeeSet* roles, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeRolesData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeRolesData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_roles);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_roles_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = roles;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->roles);
	_data_->roles = _tmp2_;
	edsf_persona_real_change_roles_co (_data_);
}


static void edsf_persona_real_change_roles_finish (FolksRoleDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeRolesData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.2
   */
static void edsf_persona_change_roles_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeRolesData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_roles_co (_data_);
}


static gboolean edsf_persona_real_change_roles_co (EdsfPersonaChangeRolesData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->roles;
	_data_->_state_ = 1;
	_edsf_persona_store_set_roles (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_roles_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_roles_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_is_favourite_data_free (gpointer _data) {
	EdsfPersonaChangeIsFavouriteData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeIsFavouriteData, _data_);
}


static void edsf_persona_real_change_is_favourite (FolksFavouriteDetails* base, gboolean is_favourite, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeIsFavouriteData* _data_;
	EdsfPersona* _tmp0_;
	gboolean _tmp1_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeIsFavouriteData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_is_favourite);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_is_favourite_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = is_favourite;
	_data_->is_favourite = _tmp1_;
	edsf_persona_real_change_is_favourite_co (_data_);
}


static void edsf_persona_real_change_is_favourite_finish (FolksFavouriteDetails* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeIsFavouriteData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.5
   */
static void edsf_persona_change_is_favourite_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeIsFavouriteData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_is_favourite_co (_data_);
}


static gboolean edsf_persona_real_change_is_favourite_co (EdsfPersonaChangeIsFavouriteData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = _data_->self->priv->_is_favourite;
	_data_->_tmp1_ = _data_->is_favourite;
	if (_data_->_tmp0_ == _data_->_tmp1_) {
		if (_data_->_state_ == 0) {
			g_simple_async_result_complete_in_idle (_data_->_async_result);
		} else {
			g_simple_async_result_complete (_data_->_async_result);
		}
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_data_->_tmp2_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp3_ = _data_->_tmp2_;
	_data_->_tmp4_ = _data_->is_favourite;
	_data_->_state_ = 1;
	_edsf_persona_store_set_is_favourite (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp3_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp4_, edsf_persona_change_is_favourite_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_is_favourite_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp3_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void edsf_persona_real_change_anti_links_data_free (gpointer _data) {
	EdsfPersonaChangeAntiLinksData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->anti_links);
	_g_object_unref0 (_data_->self);
	g_slice_free (EdsfPersonaChangeAntiLinksData, _data_);
}


static void edsf_persona_real_change_anti_links (FolksAntiLinkable* base, GeeSet* anti_links, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	EdsfPersona * self;
	EdsfPersonaChangeAntiLinksData* _data_;
	EdsfPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	self = (EdsfPersona*) base;
	_data_ = g_slice_new0 (EdsfPersonaChangeAntiLinksData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, edsf_persona_real_change_anti_links);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, edsf_persona_real_change_anti_links_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = anti_links;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (_data_->anti_links);
	_data_->anti_links = _tmp2_;
	edsf_persona_real_change_anti_links_co (_data_);
}


static void edsf_persona_real_change_anti_links_finish (FolksAntiLinkable* base, GAsyncResult* _res_, GError** error) {
	EdsfPersonaChangeAntiLinksData* _data_;
	if (g_simple_async_result_propagate_error (G_SIMPLE_ASYNC_RESULT (_res_), error)) {
		return;
	}
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


/**
   * {@inheritDoc}
   *
   * @since 0.7.3
   */
static void edsf_persona_change_anti_links_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	EdsfPersonaChangeAntiLinksData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	edsf_persona_real_change_anti_links_co (_data_);
}


static gboolean edsf_persona_real_change_anti_links_co (EdsfPersonaChangeAntiLinksData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = folks_persona_get_store ((FolksPersona*) _data_->self);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_tmp2_ = _data_->anti_links;
	_data_->_state_ = 1;
	_edsf_persona_store_set_anti_links (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->self, _data_->_tmp2_, edsf_persona_change_anti_links_ready, _data_);
	return FALSE;
	_state_1:
	_edsf_persona_store_set_anti_links_finish (G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp1_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore), _data_->_res_, &_data_->_inner_error_);
	if (_data_->_inner_error_ != NULL) {
		if (_data_->_inner_error_->domain == FOLKS_PROPERTY_ERROR) {
			g_simple_async_result_set_from_error (_data_->_async_result, _data_->_inner_error_);
			g_error_free (_data_->_inner_error_);
			if (_data_->_state_ == 0) {
				g_simple_async_result_complete_in_idle (_data_->_async_result);
			} else {
				g_simple_async_result_complete (_data_->_async_result);
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		} else {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error_->message, g_quark_to_string (_data_->_inner_error_->domain), _data_->_inner_error_->code);
			g_clear_error (&_data_->_inner_error_);
			return FALSE;
		}
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


/**
   * Build a IID.
   *
   * @param store_id the {@link PersonaStore.id}
   * @param contact the Contact
   * @return a valid IID
   *
   * @since 0.6.0
   */
gchar* edsf_persona_build_iid_from_contact (const gchar* store_id, EContact* contact) {
	gchar* result = NULL;
	gchar* contact_id = NULL;
	EContact* _tmp0_;
	gpointer _tmp1_ = NULL;
	gchar* _tmp2_ = NULL;
	const gchar* _tmp3_;
	gchar* _tmp4_;
	const gchar* _tmp5_;
	const gchar* _tmp7_;
	const gchar* _tmp8_;
	gchar* _tmp9_ = NULL;
	g_return_val_if_fail (store_id != NULL, NULL);
	g_return_val_if_fail (contact != NULL, NULL);
	_tmp0_ = contact;
	_tmp1_ = _edsf_persona_get_property_from_contact (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, _tmp0_, "id");
	contact_id = (gchar*) _tmp1_;
	_tmp3_ = contact_id;
	_tmp4_ = g_strdup (_tmp3_);
	_tmp2_ = _tmp4_;
	_tmp5_ = _tmp2_;
	if (_tmp5_ == NULL) {
		gchar* _tmp6_;
		_tmp6_ = g_strdup ("");
		_g_free0 (_tmp2_);
		_tmp2_ = _tmp6_;
	}
	_tmp7_ = store_id;
	_tmp8_ = _tmp2_;
	_tmp9_ = edsf_persona_build_iid (_tmp7_, (const gchar*) _tmp8_);
	result = _tmp9_;
	_g_free0 (_tmp2_);
	_g_free0 (contact_id);
	return result;
}


/**
   * Build a IID.
   *
   * @param store_id the {@link PersonaStore.id}
   * @param contact_id the id belonging to the Contact
   * @return a valid IID
   *
   * @since 0.6.0
   */
gchar* edsf_persona_build_iid (const gchar* store_id, const gchar* contact_id) {
	gchar* result = NULL;
	const gchar* _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_ = NULL;
	g_return_val_if_fail (store_id != NULL, NULL);
	g_return_val_if_fail (contact_id != NULL, NULL);
	_tmp0_ = store_id;
	_tmp1_ = contact_id;
	_tmp2_ = g_strdup_printf ("%s:%s", _tmp0_, _tmp1_);
	result = _tmp2_;
	return result;
}


/**
   * Create a new persona.
   *
   * Create a new persona for the {@link PersonaStore} ``store``, representing
   * the EDS contact given by ``contact``.
   *
   * @param store the store which will contain the persona
   * @param contact the EDS contact being represented by the persona
   *
   * @since 0.6.0
   */
EdsfPersona* edsf_persona_construct (GType object_type, EdsfPersonaStore* store, EContact* contact) {
	EdsfPersona * self = NULL;
	gchar* _contact_id = NULL;
	EContact* _tmp0_;
	gpointer _tmp1_ = NULL;
	gchar* _tmp2_ = NULL;
	const gchar* _tmp3_;
	gchar* _tmp4_;
	const gchar* _tmp5_;
	gchar* contact_id = NULL;
	const gchar* _tmp7_;
	gchar* _tmp8_;
	gchar* uid = NULL;
	EdsfPersonaStore* _tmp9_;
	const gchar* _tmp10_;
	const gchar* _tmp11_;
	const gchar* _tmp12_;
	gchar* _tmp13_ = NULL;
	gchar* iid = NULL;
	EdsfPersonaStore* _tmp14_;
	const gchar* _tmp15_;
	const gchar* _tmp16_;
	const gchar* _tmp17_;
	gchar* _tmp18_ = NULL;
	gboolean is_user = FALSE;
	EContact* _tmp19_;
	gboolean _tmp20_ = FALSE;
	gchar* _full_name = NULL;
	EContact* _tmp21_;
	gpointer _tmp22_ = NULL;
	gchar* _tmp23_ = NULL;
	const gchar* _tmp24_;
	gchar* _tmp25_;
	const gchar* _tmp26_;
	gchar* full_name = NULL;
	const gchar* _tmp28_;
	gchar* _tmp29_;
	const gchar* _tmp30_;
	const gchar* _tmp31_;
	EdsfPersonaStore* _tmp32_;
	gboolean _tmp33_;
	const gchar* _tmp34_;
	EContact* _tmp35_;
	g_return_val_if_fail (store != NULL, NULL);
	g_return_val_if_fail (contact != NULL, NULL);
	_tmp0_ = contact;
	_tmp1_ = _edsf_persona_get_property_from_contact (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, _tmp0_, "id");
	_contact_id = (gchar*) _tmp1_;
	_tmp3_ = _contact_id;
	_tmp4_ = g_strdup (_tmp3_);
	_tmp2_ = _tmp4_;
	_tmp5_ = _tmp2_;
	if (_tmp5_ == NULL) {
		gchar* _tmp6_;
		_tmp6_ = g_strdup ("");
		_g_free0 (_tmp2_);
		_tmp2_ = _tmp6_;
	}
	_tmp7_ = _tmp2_;
	_tmp8_ = g_strdup ((const gchar*) _tmp7_);
	contact_id = _tmp8_;
	_tmp9_ = store;
	_tmp10_ = folks_persona_store_get_id ((FolksPersonaStore*) _tmp9_);
	_tmp11_ = _tmp10_;
	_tmp12_ = contact_id;
	_tmp13_ = folks_persona_build_uid (BACKEND_NAME, _tmp11_, _tmp12_);
	uid = _tmp13_;
	_tmp14_ = store;
	_tmp15_ = folks_persona_store_get_id ((FolksPersonaStore*) _tmp14_);
	_tmp16_ = _tmp15_;
	_tmp17_ = contact_id;
	_tmp18_ = edsf_persona_build_iid (_tmp16_, _tmp17_);
	iid = _tmp18_;
	_tmp19_ = contact;
	_tmp20_ = e_book_client_is_self (_tmp19_);
	is_user = _tmp20_;
	_tmp21_ = contact;
	_tmp22_ = _edsf_persona_get_property_from_contact (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, _tmp21_, "full_name");
	_full_name = (gchar*) _tmp22_;
	_tmp24_ = _full_name;
	_tmp25_ = g_strdup (_tmp24_);
	_tmp23_ = _tmp25_;
	_tmp26_ = _tmp23_;
	if (_tmp26_ == NULL) {
		gchar* _tmp27_;
		_tmp27_ = g_strdup ("");
		_g_free0 (_tmp23_);
		_tmp23_ = _tmp27_;
	}
	_tmp28_ = _tmp23_;
	_tmp29_ = g_strdup ((const gchar*) _tmp28_);
	full_name = _tmp29_;
	_tmp30_ = uid;
	_tmp31_ = iid;
	_tmp32_ = store;
	_tmp33_ = is_user;
	_tmp34_ = contact_id;
	_tmp35_ = contact;
	self = (EdsfPersona*) g_object_new (object_type, "display-id", full_name, "uid", _tmp30_, "iid", _tmp31_, "store", _tmp32_, "is-user", _tmp33_, "contact-id", _tmp34_, "contact", _tmp35_, NULL);
	_g_free0 (full_name);
	_g_free0 (_tmp23_);
	_g_free0 (_full_name);
	_g_free0 (iid);
	_g_free0 (uid);
	_g_free0 (contact_id);
	_g_free0 (_tmp2_);
	_g_free0 (_contact_id);
	return self;
}


EdsfPersona* edsf_persona_new (EdsfPersonaStore* store, EContact* contact) {
	return edsf_persona_construct (EDSF_TYPE_PERSONA, store, contact);
}


/**
   * {@inheritDoc}
   *
   * @since 0.6.0
   */
static void edsf_persona_real_linkable_property_to_links (FolksPersona* base, const gchar* prop_name, FolksPersonaLinkablePropertyCallback callback, void* callback_target) {
	EdsfPersona * self;
	const gchar* _tmp0_;
	self = (EdsfPersona*) base;
	g_return_if_fail (prop_name != NULL);
	_tmp0_ = prop_name;
	if (g_strcmp0 (_tmp0_, "im-addresses") == 0) {
		GeeMapIterator* iter = NULL;
		GeeHashMultiMap* _tmp1_;
		GeeMapIterator* _tmp2_ = NULL;
		_tmp1_ = self->priv->_im_addresses;
		_tmp2_ = gee_multi_map_map_iterator ((GeeMultiMap*) _tmp1_);
		iter = _tmp2_;
		while (TRUE) {
			GeeMapIterator* _tmp3_;
			gboolean _tmp4_ = FALSE;
			FolksPersonaLinkablePropertyCallback _tmp5_;
			void* _tmp5__target;
			GeeMapIterator* _tmp6_;
			gpointer _tmp7_ = NULL;
			gchar* _tmp8_;
			gchar* _tmp9_;
			gchar* _tmp10_;
			GeeMapIterator* _tmp11_;
			gpointer _tmp12_ = NULL;
			FolksImFieldDetails* _tmp13_;
			gconstpointer _tmp14_;
			const gchar* _tmp15_;
			gchar* _tmp16_;
			gchar* _tmp17_;
			_tmp3_ = iter;
			_tmp4_ = gee_map_iterator_next (_tmp3_);
			if (!_tmp4_) {
				break;
			}
			_tmp5_ = callback;
			_tmp5__target = callback_target;
			_tmp6_ = iter;
			_tmp7_ = gee_map_iterator_get_key (_tmp6_);
			_tmp8_ = (gchar*) _tmp7_;
			_tmp9_ = g_strconcat (_tmp8_, ":", NULL);
			_tmp10_ = _tmp9_;
			_tmp11_ = iter;
			_tmp12_ = gee_map_iterator_get_value (_tmp11_);
			_tmp13_ = (FolksImFieldDetails*) _tmp12_;
			_tmp14_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp13_);
			_tmp15_ = _tmp14_;
			_tmp16_ = g_strconcat (_tmp10_, (const gchar*) _tmp15_, NULL);
			_tmp17_ = _tmp16_;
			_tmp5_ (_tmp17_, _tmp5__target);
			_g_free0 (_tmp17_);
			_g_object_unref0 (_tmp13_);
			_g_free0 (_tmp10_);
			_g_free0 (_tmp8_);
		}
		_g_object_unref0 (iter);
	} else {
		const gchar* _tmp18_;
		_tmp18_ = prop_name;
		if (g_strcmp0 (_tmp18_, "local-ids") == 0) {
			{
				GeeIterator* _id_it = NULL;
				GeeSet* _tmp19_;
				GeeSet* _tmp20_;
				GeeIterator* _tmp21_ = NULL;
				_tmp19_ = folks_local_id_details_get_local_ids ((FolksLocalIdDetails*) self);
				_tmp20_ = _tmp19_;
				_tmp21_ = gee_iterable_iterator ((GeeIterable*) _tmp20_);
				_id_it = _tmp21_;
				while (TRUE) {
					GeeIterator* _tmp22_;
					gboolean _tmp23_ = FALSE;
					gchar* id = NULL;
					GeeIterator* _tmp24_;
					gpointer _tmp25_ = NULL;
					FolksPersonaLinkablePropertyCallback _tmp26_;
					void* _tmp26__target;
					const gchar* _tmp27_;
					_tmp22_ = _id_it;
					_tmp23_ = gee_iterator_next (_tmp22_);
					if (!_tmp23_) {
						break;
					}
					_tmp24_ = _id_it;
					_tmp25_ = gee_iterator_get (_tmp24_);
					id = (gchar*) _tmp25_;
					_tmp26_ = callback;
					_tmp26__target = callback_target;
					_tmp27_ = id;
					_tmp26_ (_tmp27_, _tmp26__target);
					_g_free0 (id);
				}
				_g_object_unref0 (_id_it);
			}
		} else {
			const gchar* _tmp28_;
			_tmp28_ = prop_name;
			if (g_strcmp0 (_tmp28_, "web-service-addresses") == 0) {
				GeeMapIterator* iter = NULL;
				GeeMultiMap* _tmp29_;
				GeeMultiMap* _tmp30_;
				GeeMapIterator* _tmp31_ = NULL;
				_tmp29_ = folks_web_service_details_get_web_service_addresses ((FolksWebServiceDetails*) self);
				_tmp30_ = _tmp29_;
				_tmp31_ = gee_multi_map_map_iterator (_tmp30_);
				iter = _tmp31_;
				while (TRUE) {
					GeeMapIterator* _tmp32_;
					gboolean _tmp33_ = FALSE;
					FolksPersonaLinkablePropertyCallback _tmp34_;
					void* _tmp34__target;
					GeeMapIterator* _tmp35_;
					gpointer _tmp36_ = NULL;
					gchar* _tmp37_;
					gchar* _tmp38_;
					gchar* _tmp39_;
					GeeMapIterator* _tmp40_;
					gpointer _tmp41_ = NULL;
					FolksWebServiceFieldDetails* _tmp42_;
					gconstpointer _tmp43_;
					const gchar* _tmp44_;
					gchar* _tmp45_;
					gchar* _tmp46_;
					_tmp32_ = iter;
					_tmp33_ = gee_map_iterator_next (_tmp32_);
					if (!_tmp33_) {
						break;
					}
					_tmp34_ = callback;
					_tmp34__target = callback_target;
					_tmp35_ = iter;
					_tmp36_ = gee_map_iterator_get_key (_tmp35_);
					_tmp37_ = (gchar*) _tmp36_;
					_tmp38_ = g_strconcat (_tmp37_, ":", NULL);
					_tmp39_ = _tmp38_;
					_tmp40_ = iter;
					_tmp41_ = gee_map_iterator_get_value (_tmp40_);
					_tmp42_ = (FolksWebServiceFieldDetails*) _tmp41_;
					_tmp43_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp42_);
					_tmp44_ = _tmp43_;
					_tmp45_ = g_strconcat (_tmp39_, (const gchar*) _tmp44_, NULL);
					_tmp46_ = _tmp45_;
					_tmp34_ (_tmp46_, _tmp34__target);
					_g_free0 (_tmp46_);
					_g_object_unref0 (_tmp42_);
					_g_free0 (_tmp39_);
					_g_free0 (_tmp37_);
				}
				_g_object_unref0 (iter);
			} else {
				const gchar* _tmp47_;
				_tmp47_ = prop_name;
				if (g_strcmp0 (_tmp47_, "email-addresses") == 0) {
					{
						FolksSmallSet* _email_list = NULL;
						FolksSmallSet* _tmp48_;
						FolksSmallSet* _tmp49_;
						gint _email_size = 0;
						FolksSmallSet* _tmp50_;
						gint _tmp51_;
						gint _tmp52_;
						gint _email_index = 0;
						_tmp48_ = self->priv->_email_addresses;
						_tmp49_ = _g_object_ref0 (_tmp48_);
						_email_list = _tmp49_;
						_tmp50_ = _email_list;
						_tmp51_ = gee_collection_get_size ((GeeCollection*) _tmp50_);
						_tmp52_ = _tmp51_;
						_email_size = _tmp52_;
						_email_index = -1;
						while (TRUE) {
							gint _tmp53_;
							gint _tmp54_;
							gint _tmp55_;
							FolksEmailFieldDetails* email = NULL;
							FolksSmallSet* _tmp56_;
							gint _tmp57_;
							gconstpointer _tmp58_ = NULL;
							FolksEmailFieldDetails* _tmp59_;
							FolksPersonaLinkablePropertyCallback _tmp60_;
							void* _tmp60__target;
							FolksEmailFieldDetails* _tmp61_;
							gconstpointer _tmp62_;
							const gchar* _tmp63_;
							_tmp53_ = _email_index;
							_email_index = _tmp53_ + 1;
							_tmp54_ = _email_index;
							_tmp55_ = _email_size;
							if (!(_tmp54_ < _tmp55_)) {
								break;
							}
							_tmp56_ = _email_list;
							_tmp57_ = _email_index;
							_tmp58_ = folks_small_set_get (_tmp56_, _tmp57_);
							_tmp59_ = _g_object_ref0 ((FolksEmailFieldDetails*) _tmp58_);
							email = _tmp59_;
							_tmp60_ = callback;
							_tmp60__target = callback_target;
							_tmp61_ = email;
							_tmp62_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp61_);
							_tmp63_ = _tmp62_;
							_tmp60_ ((const gchar*) _tmp63_, _tmp60__target);
							_g_object_unref0 (email);
						}
						_g_object_unref0 (_email_list);
					}
				} else {
					const gchar* _tmp64_;
					FolksPersonaLinkablePropertyCallback _tmp65_;
					void* _tmp65__target;
					_tmp64_ = prop_name;
					_tmp65_ = callback;
					_tmp65__target = callback_target;
					FOLKS_PERSONA_CLASS (edsf_persona_parent_class)->linkable_property_to_links (G_TYPE_CHECK_INSTANCE_CAST (self, FOLKS_TYPE_PERSONA, FolksPersona), _tmp64_, _tmp65_, _tmp65__target);
				}
			}
		}
	}
}


/**
   * Update attribs of the persona.
   */
void _edsf_persona_update (EdsfPersona* self, EContact* updated_contact) {
	EContact* _tmp0_;
	EContact* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (updated_contact != NULL);
	g_object_freeze_notify ((GObject*) self);
	_tmp0_ = updated_contact;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_contact);
	self->priv->_contact = _tmp1_;
	g_object_notify ((GObject*) self, "contact");
	_edsf_persona_update_names (self);
	_edsf_persona_update_avatar (self);
	_edsf_persona_update_urls (self, FALSE, TRUE);
	_edsf_persona_update_phones (self, FALSE, TRUE);
	_edsf_persona_update_addresses (self, FALSE, TRUE);
	_edsf_persona_update_emails (self, TRUE);
	_edsf_persona_update_im_addresses (self);
	_edsf_persona_update_groups (self, FALSE, TRUE);
	_edsf_persona_update_notes (self, FALSE, TRUE);
	_edsf_persona_update_local_ids (self);
	_edsf_persona_update_location (self);
	_edsf_persona_update_web_services_addresses (self);
	_edsf_persona_update_gender (self);
	_edsf_persona_update_birthday (self);
	_edsf_persona_update_roles (self, FALSE, TRUE);
	_edsf_persona_update_favourite (self);
	_edsf_persona_update_anti_links (self);
	g_object_thaw_notify ((GObject*) self);
}


static void _edsf_persona_update_params (EdsfPersona* self, FolksAbstractFieldDetails* details, EVCardAttribute* attr) {
	EVCardAttribute* _tmp0_;
	GList* _tmp1_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (details != NULL);
	g_return_if_fail (attr != NULL);
	_tmp0_ = attr;
	_tmp1_ = e_vcard_attribute_get_params (_tmp0_);
	{
		GList* param_collection = NULL;
		GList* param_it = NULL;
		param_collection = _tmp1_;
		for (param_it = param_collection; param_it != NULL; param_it = param_it->next) {
			EVCardAttributeParam* param = NULL;
			param = (EVCardAttributeParam*) param_it->data;
			{
				gchar* param_name = NULL;
				EVCardAttributeParam* _tmp2_;
				const gchar* _tmp3_ = NULL;
				gchar* _tmp4_ = NULL;
				EVCardAttributeParam* _tmp5_;
				GList* _tmp6_ = NULL;
				_tmp2_ = param;
				_tmp3_ = e_vcard_attribute_param_get_name (_tmp2_);
				_tmp4_ = g_utf8_strdown (_tmp3_, (gssize) (-1));
				param_name = _tmp4_;
				_tmp5_ = param;
				_tmp6_ = e_vcard_attribute_param_get_values (_tmp5_);
				{
					GList* param_value_collection = NULL;
					GList* param_value_it = NULL;
					param_value_collection = _tmp6_;
					for (param_value_it = param_value_collection; param_value_it != NULL; param_value_it = param_value_it->next) {
						const gchar* param_value = NULL;
						param_value = (const gchar*) param_value_it->data;
						{
							const gchar* _tmp7_;
							_tmp7_ = param_name;
							if (g_strcmp0 (_tmp7_, FOLKS_ABSTRACT_FIELD_DETAILS_PARAM_TYPE) == 0) {
								FolksAbstractFieldDetails* _tmp8_;
								const gchar* _tmp9_;
								const gchar* _tmp10_;
								gchar* _tmp11_ = NULL;
								gchar* _tmp12_;
								_tmp8_ = details;
								_tmp9_ = param_name;
								_tmp10_ = param_value;
								_tmp11_ = g_utf8_strdown (_tmp10_, (gssize) (-1));
								_tmp12_ = _tmp11_;
								folks_abstract_field_details_add_parameter (_tmp8_, _tmp9_, _tmp12_);
								_g_free0 (_tmp12_);
							} else {
								FolksAbstractFieldDetails* _tmp13_;
								const gchar* _tmp14_;
								const gchar* _tmp15_;
								_tmp13_ = details;
								_tmp14_ = param_name;
								_tmp15_ = param_value;
								folks_abstract_field_details_add_parameter (_tmp13_, _tmp14_, _tmp15_);
							}
						}
					}
				}
				_g_free0 (param_name);
			}
		}
	}
}


static EVCardAttribute* _vala_EVCardAttribute_copy (EVCardAttribute* self) {
	return g_boxed_copy (e_vcard_attribute_get_type (), self);
}


static gpointer __vala_EVCardAttribute_copy0 (gpointer self) {
	return self ? _vala_EVCardAttribute_copy (self) : NULL;
}


static void _vala_EVCardAttribute_free (EVCardAttribute* self) {
	g_boxed_free (e_vcard_attribute_get_type (), self);
}


static void _edsf_persona_update_gender (EdsfPersona* self) {
	FolksGender gender = 0;
	EVCardAttribute* gender_attr = NULL;
	EContact* _tmp0_;
	EContact* _tmp1_;
	EVCardAttribute* _tmp2_ = NULL;
	EVCardAttribute* _tmp3_;
	EVCardAttribute* _tmp4_;
	FolksGender _tmp13_;
	FolksGender _tmp14_;
	g_return_if_fail (self != NULL);
	gender = FOLKS_GENDER_UNSPECIFIED;
	_tmp0_ = edsf_persona_get_contact (self);
	_tmp1_ = _tmp0_;
	_tmp2_ = e_vcard_get_attribute ((EVCard*) _tmp1_, EDSF_PERSONA_gender_attribute_name);
	_tmp3_ = __vala_EVCardAttribute_copy0 (_tmp2_);
	gender_attr = _tmp3_;
	_tmp4_ = gender_attr;
	if (_tmp4_ != NULL) {
		gchar* val = NULL;
		EVCardAttribute* _tmp5_;
		gchar* _tmp6_ = NULL;
		const gchar* _tmp7_;
		_tmp5_ = gender_attr;
		_tmp6_ = e_vcard_attribute_get_value ((EVCardAttribute*) _tmp5_);
		val = _tmp6_;
		_tmp7_ = val;
		if (_tmp7_ != NULL) {
			const gchar* _tmp8_;
			gchar* _tmp9_ = NULL;
			gchar* _tmp10_;
			GQuark _tmp12_ = 0U;
			_tmp8_ = val;
			_tmp9_ = g_utf8_strup ((const gchar*) _tmp8_, (gssize) (-1));
			_tmp10_ = _tmp9_;
			_tmp12_ = (NULL == _tmp10_) ? 0 : g_quark_from_string (_tmp10_);
			g_free (_tmp10_);
			if (_tmp12_ == g_quark_from_string (EDSF_PERSONA_gender_male)) {
				switch (0) {
					default:
					{
						gender = FOLKS_GENDER_MALE;
						break;
					}
				}
			} else if (_tmp12_ == g_quark_from_string (EDSF_PERSONA_gender_female)) {
				switch (0) {
					default:
					{
						gender = FOLKS_GENDER_FEMALE;
						break;
					}
				}
			} else {
				switch (0) {
					default:
					{
						break;
					}
				}
			}
		}
		_g_free0 (val);
	}
	_tmp13_ = self->priv->_gender;
	_tmp14_ = gender;
	if (_tmp13_ != _tmp14_) {
		FolksGender _tmp15_;
		_tmp15_ = gender;
		self->priv->_gender = _tmp15_;
		g_object_notify ((GObject*) self, "gender");
	}
	__vala_EVCardAttribute_free0 (gender_attr);
}


static EContactDate* _vala_EContactDate_copy (EContactDate* self) {
	return g_boxed_copy (e_contact_date_get_type (), self);
}


static void _vala_EContactDate_free (EContactDate* self) {
	g_boxed_free (e_contact_date_get_type (), self);
}


static gpointer __vala_EContactDate_copy0 (gpointer self) {
	return self ? _vala_EContactDate_copy (self) : NULL;
}


static void _edsf_persona_update_birthday (EdsfPersona* self) {
	EContactDate* _bday = NULL;
	gpointer _tmp0_ = NULL;
	EContactDate* _tmp1_;
	g_return_if_fail (self != NULL);
	_tmp0_ = _edsf_persona_get_property (self, e_contact_date_get_type (), (GBoxedCopyFunc) _vala_EContactDate_copy, _vala_EContactDate_free, "birth_date");
	_bday = (EContactDate*) _tmp0_;
	_tmp1_ = _bday;
	if (_tmp1_ != NULL) {
		EContactDate* bday = NULL;
		EContactDate* _tmp2_;
		EContactDate* _tmp3_;
		GDateTime* d = NULL;
		GTimeZone* _tmp4_;
		EContactDate* _tmp5_;
		guint _tmp6_;
		EContactDate* _tmp7_;
		guint _tmp8_;
		EContactDate* _tmp9_;
		guint _tmp10_;
		GDateTime* _tmp11_;
		gboolean _tmp12_ = FALSE;
		GDateTime* _tmp13_;
		gboolean _tmp22_;
		_tmp2_ = _bday;
		_tmp3_ = __vala_EContactDate_copy0 ((EContactDate*) _tmp2_);
		bday = _tmp3_;
		_tmp4_ = edsf_persona__local_time_zone;
		_tmp5_ = bday;
		_tmp6_ = _tmp5_->year;
		_tmp7_ = bday;
		_tmp8_ = _tmp7_->month;
		_tmp9_ = bday;
		_tmp10_ = _tmp9_->day;
		_tmp11_ = g_date_time_new (_tmp4_, (gint) _tmp6_, (gint) _tmp8_, (gint) _tmp10_, 0, 0, 0.0);
		d = _tmp11_;
		_tmp13_ = self->priv->_birthday;
		if (_tmp13_ == NULL) {
			_tmp12_ = TRUE;
		} else {
			gboolean _tmp14_ = FALSE;
			GDateTime* _tmp15_;
			gboolean _tmp21_;
			_tmp15_ = self->priv->_birthday;
			if (_tmp15_ != NULL) {
				GDateTime* _tmp16_;
				GDateTime* _tmp17_;
				GDateTime* _tmp18_ = NULL;
				GDateTime* _tmp19_;
				gboolean _tmp20_ = FALSE;
				_tmp16_ = self->priv->_birthday;
				_tmp17_ = d;
				_tmp18_ = g_date_time_to_utc (_tmp17_);
				_tmp19_ = _tmp18_;
				_tmp20_ = g_date_time_equal ((GDateTime*) _tmp16_, _tmp19_);
				_tmp14_ = !_tmp20_;
				_g_date_time_unref0 (_tmp19_);
			} else {
				_tmp14_ = FALSE;
			}
			_tmp21_ = _tmp14_;
			_tmp12_ = _tmp21_;
		}
		_tmp22_ = _tmp12_;
		if (_tmp22_) {
			GDateTime* _tmp23_;
			GDateTime* _tmp24_ = NULL;
			_tmp23_ = d;
			_tmp24_ = g_date_time_to_utc (_tmp23_);
			_g_date_time_unref0 (self->priv->_birthday);
			self->priv->_birthday = _tmp24_;
			g_object_notify ((GObject*) self, "birthday");
		}
		_g_date_time_unref0 (d);
		__vala_EContactDate_free0 (bday);
	} else {
		GDateTime* _tmp25_;
		_tmp25_ = self->priv->_birthday;
		if (_tmp25_ != NULL) {
			_g_date_time_unref0 (self->priv->_birthday);
			self->priv->_birthday = NULL;
			g_object_notify ((GObject*) self, "birthday");
		}
	}
	__vala_EContactDate_free0 (_bday);
}


static void _edsf_persona_update_roles (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification) {
	gboolean _tmp0_ = FALSE;
	FolksSmallSet* _tmp1_;
	gboolean _tmp3_;
	FolksSmallSet* new_roles = NULL;
	FolksSmallSet* _tmp10_;
	FolksRoleFieldDetails* default_role_fd = NULL;
	FolksRoleFieldDetails* _tmp11_ = NULL;
	FolksRoleFieldDetails* _tmp12_;
	EVCard* vcard = NULL;
	EContact* _tmp15_;
	EContact* _tmp16_;
	EVCard* _tmp17_;
	EVCard* _tmp18_;
	GList* _tmp19_ = NULL;
	FolksSmallSet* _tmp55_;
	FolksSmallSet* _tmp56_;
	gboolean _tmp57_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_roles;
	if (_tmp1_ == NULL) {
		gboolean _tmp2_;
		_tmp2_ = create_if_not_exist;
		_tmp0_ = _tmp2_ == FALSE;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp3_ = _tmp0_;
	if (_tmp3_) {
		gboolean _tmp4_;
		_tmp4_ = emit_notification;
		if (_tmp4_) {
			g_object_notify ((GObject*) self, "roles");
		}
		return;
	} else {
		FolksSmallSet* _tmp5_;
		_tmp5_ = self->priv->_roles;
		if (_tmp5_ == NULL) {
			FolksSmallSet* _tmp6_;
			FolksSmallSet* _tmp7_;
			GeeSet* _tmp8_;
			GeeSet* _tmp9_;
			_tmp6_ = folks_small_set_new (FOLKS_TYPE_ROLE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
			_g_object_unref0 (self->priv->_roles);
			self->priv->_roles = _tmp6_;
			_tmp7_ = self->priv->_roles;
			_tmp8_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp7_);
			_tmp9_ = _tmp8_;
			_g_object_unref0 (self->priv->_roles_ro);
			self->priv->_roles_ro = _tmp9_;
		}
	}
	_tmp10_ = folks_small_set_new (FOLKS_TYPE_ROLE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_roles = _tmp10_;
	_tmp11_ = _edsf_persona_get_default_role (self);
	default_role_fd = _tmp11_;
	_tmp12_ = default_role_fd;
	if (_tmp12_ != NULL) {
		FolksSmallSet* _tmp13_;
		FolksRoleFieldDetails* _tmp14_;
		_tmp13_ = new_roles;
		_tmp14_ = default_role_fd;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp13_, G_TYPE_CHECK_INSTANCE_CAST (_tmp14_, FOLKS_TYPE_ROLE_FIELD_DETAILS, FolksRoleFieldDetails));
	}
	_tmp15_ = edsf_persona_get_contact (self);
	_tmp16_ = _tmp15_;
	_tmp17_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp16_, e_vcard_get_type (), EVCard));
	vcard = _tmp17_;
	_tmp18_ = vcard;
	_tmp19_ = e_vcard_get_attributes (_tmp18_);
	{
		GList* attr_collection = NULL;
		GList* attr_it = NULL;
		attr_collection = _tmp19_;
		for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
			EVCardAttribute* attr = NULL;
			attr = (EVCardAttribute*) attr_it->data;
			{
				EVCardAttribute* _tmp20_;
				const gchar* _tmp21_ = NULL;
				gchar* val = NULL;
				EVCardAttribute* _tmp22_;
				gchar* _tmp23_ = NULL;
				gboolean _tmp24_ = FALSE;
				const gchar* _tmp25_;
				gboolean _tmp27_;
				FolksRole* role = NULL;
				FolksRole* _tmp28_;
				FolksRole* _tmp29_;
				const gchar* _tmp30_;
				FolksRoleFieldDetails* role_fd = NULL;
				FolksRole* _tmp31_;
				FolksRoleFieldDetails* _tmp32_;
				EVCardAttribute* _tmp33_;
				GList* _tmp34_ = NULL;
				FolksSmallSet* _tmp53_;
				FolksRoleFieldDetails* _tmp54_;
				_tmp20_ = attr;
				_tmp21_ = e_vcard_attribute_get_name (_tmp20_);
				if (g_strcmp0 (_tmp21_, "X-ROLES") != 0) {
					continue;
				}
				_tmp22_ = attr;
				_tmp23_ = e_vcard_attribute_get_value (_tmp22_);
				val = _tmp23_;
				_tmp25_ = val;
				if (_tmp25_ == NULL) {
					_tmp24_ = TRUE;
				} else {
					const gchar* _tmp26_;
					_tmp26_ = val;
					_tmp24_ = g_strcmp0 ((const gchar*) _tmp26_, "") == 0;
				}
				_tmp27_ = _tmp24_;
				if (_tmp27_) {
					_g_free0 (val);
					continue;
				}
				_tmp28_ = folks_role_new ("", "", NULL);
				role = _tmp28_;
				_tmp29_ = role;
				_tmp30_ = val;
				folks_role_set_role (_tmp29_, (const gchar*) _tmp30_);
				_tmp31_ = role;
				_tmp32_ = folks_role_field_details_new (_tmp31_, NULL);
				role_fd = _tmp32_;
				_tmp33_ = attr;
				_tmp34_ = e_vcard_attribute_get_params (_tmp33_);
				{
					GList* param_collection = NULL;
					GList* param_it = NULL;
					param_collection = _tmp34_;
					for (param_it = param_collection; param_it != NULL; param_it = param_it->next) {
						EVCardAttributeParam* param = NULL;
						param = (EVCardAttributeParam*) param_it->data;
						{
							gchar* param_name = NULL;
							EVCardAttributeParam* _tmp35_;
							const gchar* _tmp36_ = NULL;
							gchar* _tmp37_ = NULL;
							const gchar* _tmp38_;
							_tmp35_ = param;
							_tmp36_ = e_vcard_attribute_param_get_name (_tmp35_);
							_tmp37_ = g_utf8_strdown (_tmp36_, (gssize) (-1));
							param_name = _tmp37_;
							_tmp38_ = param_name;
							if (g_strcmp0 (_tmp38_, "organisation_name") == 0) {
								EVCardAttributeParam* _tmp39_;
								GList* _tmp40_ = NULL;
								_tmp39_ = param;
								_tmp40_ = e_vcard_attribute_param_get_values (_tmp39_);
								{
									GList* param_value_collection = NULL;
									GList* param_value_it = NULL;
									param_value_collection = _tmp40_;
									for (param_value_it = param_value_collection; param_value_it != NULL; param_value_it = param_value_it->next) {
										const gchar* param_value = NULL;
										param_value = (const gchar*) param_value_it->data;
										{
											FolksRole* _tmp41_;
											const gchar* _tmp42_;
											_tmp41_ = role;
											_tmp42_ = param_value;
											folks_role_set_organisation_name (_tmp41_, _tmp42_);
											break;
										}
									}
								}
							} else {
								const gchar* _tmp43_;
								_tmp43_ = param_name;
								if (g_strcmp0 (_tmp43_, "title") == 0) {
									EVCardAttributeParam* _tmp44_;
									GList* _tmp45_ = NULL;
									_tmp44_ = param;
									_tmp45_ = e_vcard_attribute_param_get_values (_tmp44_);
									{
										GList* param_value_collection = NULL;
										GList* param_value_it = NULL;
										param_value_collection = _tmp45_;
										for (param_value_it = param_value_collection; param_value_it != NULL; param_value_it = param_value_it->next) {
											const gchar* param_value = NULL;
											param_value = (const gchar*) param_value_it->data;
											{
												FolksRole* _tmp46_;
												const gchar* _tmp47_;
												_tmp46_ = role;
												_tmp47_ = param_value;
												folks_role_set_title (_tmp46_, _tmp47_);
												break;
											}
										}
									}
								} else {
									EVCardAttributeParam* _tmp48_;
									GList* _tmp49_ = NULL;
									_tmp48_ = param;
									_tmp49_ = e_vcard_attribute_param_get_values (_tmp48_);
									{
										GList* param_value_collection = NULL;
										GList* param_value_it = NULL;
										param_value_collection = _tmp49_;
										for (param_value_it = param_value_collection; param_value_it != NULL; param_value_it = param_value_it->next) {
											const gchar* param_value = NULL;
											param_value = (const gchar*) param_value_it->data;
											{
												FolksRoleFieldDetails* _tmp50_;
												const gchar* _tmp51_;
												const gchar* _tmp52_;
												_tmp50_ = role_fd;
												_tmp51_ = param_name;
												_tmp52_ = param_value;
												folks_abstract_field_details_add_parameter ((FolksAbstractFieldDetails*) _tmp50_, _tmp51_, _tmp52_);
											}
										}
									}
								}
							}
							_g_free0 (param_name);
						}
					}
				}
				_tmp53_ = new_roles;
				_tmp54_ = role_fd;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp53_, _tmp54_);
				_g_object_unref0 (role_fd);
				_g_object_unref0 (role);
				_g_free0 (val);
			}
		}
	}
	_tmp55_ = new_roles;
	_tmp56_ = self->priv->_roles;
	_tmp57_ = folks_internal_equal_sets (FOLKS_TYPE_ROLE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, (GeeSet*) _tmp55_, (GeeSet*) _tmp56_);
	if (!_tmp57_) {
		FolksSmallSet* _tmp58_;
		FolksSmallSet* _tmp59_;
		FolksSmallSet* _tmp60_;
		GeeSet* _tmp61_;
		GeeSet* _tmp62_;
		gboolean _tmp63_;
		_tmp58_ = new_roles;
		_tmp59_ = _g_object_ref0 (_tmp58_);
		_g_object_unref0 (self->priv->_roles);
		self->priv->_roles = _tmp59_;
		_tmp60_ = new_roles;
		_tmp61_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp60_);
		_tmp62_ = _tmp61_;
		_g_object_unref0 (self->priv->_roles_ro);
		self->priv->_roles_ro = _tmp62_;
		_tmp63_ = emit_notification;
		if (_tmp63_) {
			g_object_notify ((GObject*) self, "roles");
		}
	}
	_g_object_unref0 (vcard);
	_g_object_unref0 (default_role_fd);
	_g_object_unref0 (new_roles);
}


static FolksRoleFieldDetails* _edsf_persona_get_default_role (EdsfPersona* self) {
	FolksRoleFieldDetails* result = NULL;
	FolksRoleFieldDetails* _default_role = NULL;
	gchar* org = NULL;
	gpointer _tmp0_ = NULL;
	gchar* org_unit = NULL;
	gpointer _tmp1_ = NULL;
	gchar* office = NULL;
	gpointer _tmp2_ = NULL;
	gchar* title = NULL;
	gpointer _tmp3_ = NULL;
	gchar* role = NULL;
	gpointer _tmp4_ = NULL;
	gchar* manager = NULL;
	gpointer _tmp5_ = NULL;
	gchar* assistant = NULL;
	gpointer _tmp6_ = NULL;
	gboolean _tmp7_ = FALSE;
	gboolean _tmp8_ = FALSE;
	gboolean _tmp9_ = FALSE;
	gboolean _tmp10_ = FALSE;
	gboolean _tmp11_ = FALSE;
	gboolean _tmp12_ = FALSE;
	const gchar* _tmp13_;
	gboolean _tmp15_;
	gboolean _tmp17_;
	gboolean _tmp19_;
	gboolean _tmp21_;
	gboolean _tmp23_;
	gboolean _tmp25_;
	g_return_val_if_fail (self != NULL, NULL);
	_default_role = NULL;
	_tmp0_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "org");
	org = (gchar*) _tmp0_;
	_tmp1_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "org_unit");
	org_unit = (gchar*) _tmp1_;
	_tmp2_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "office");
	office = (gchar*) _tmp2_;
	_tmp3_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "title");
	title = (gchar*) _tmp3_;
	_tmp4_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "role");
	role = (gchar*) _tmp4_;
	_tmp5_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "manager");
	manager = (gchar*) _tmp5_;
	_tmp6_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "assistant");
	assistant = (gchar*) _tmp6_;
	_tmp13_ = org;
	if (_tmp13_ != NULL) {
		_tmp12_ = TRUE;
	} else {
		const gchar* _tmp14_;
		_tmp14_ = org_unit;
		_tmp12_ = _tmp14_ != NULL;
	}
	_tmp15_ = _tmp12_;
	if (_tmp15_) {
		_tmp11_ = TRUE;
	} else {
		const gchar* _tmp16_;
		_tmp16_ = office;
		_tmp11_ = _tmp16_ != NULL;
	}
	_tmp17_ = _tmp11_;
	if (_tmp17_) {
		_tmp10_ = TRUE;
	} else {
		const gchar* _tmp18_;
		_tmp18_ = title;
		_tmp10_ = _tmp18_ != NULL;
	}
	_tmp19_ = _tmp10_;
	if (_tmp19_) {
		_tmp9_ = TRUE;
	} else {
		const gchar* _tmp20_;
		_tmp20_ = role;
		_tmp9_ = _tmp20_ != NULL;
	}
	_tmp21_ = _tmp9_;
	if (_tmp21_) {
		_tmp8_ = TRUE;
	} else {
		const gchar* _tmp22_;
		_tmp22_ = manager;
		_tmp8_ = _tmp22_ != NULL;
	}
	_tmp23_ = _tmp8_;
	if (_tmp23_) {
		_tmp7_ = TRUE;
	} else {
		const gchar* _tmp24_;
		_tmp24_ = assistant;
		_tmp7_ = _tmp24_ != NULL;
	}
	_tmp25_ = _tmp7_;
	if (_tmp25_) {
		FolksRole* new_role = NULL;
		const gchar* _tmp26_;
		const gchar* _tmp27_;
		FolksRole* _tmp28_;
		gboolean _tmp29_ = FALSE;
		const gchar* _tmp30_;
		gboolean _tmp32_;
		FolksRole* _tmp35_;
		gboolean _tmp36_ = FALSE;
		_tmp26_ = title;
		_tmp27_ = org;
		_tmp28_ = folks_role_new (_tmp26_, _tmp27_, NULL);
		new_role = _tmp28_;
		_tmp30_ = role;
		if (_tmp30_ != NULL) {
			const gchar* _tmp31_;
			_tmp31_ = role;
			_tmp29_ = g_strcmp0 ((const gchar*) _tmp31_, "") != 0;
		} else {
			_tmp29_ = FALSE;
		}
		_tmp32_ = _tmp29_;
		if (_tmp32_) {
			FolksRole* _tmp33_;
			const gchar* _tmp34_;
			_tmp33_ = new_role;
			_tmp34_ = role;
			folks_role_set_role (_tmp33_, (const gchar*) _tmp34_);
		}
		_tmp35_ = new_role;
		_tmp36_ = folks_role_is_empty (_tmp35_);
		if (!_tmp36_) {
			FolksRoleFieldDetails* default_role = NULL;
			FolksRole* _tmp37_;
			FolksRoleFieldDetails* _tmp38_;
			gboolean _tmp39_ = FALSE;
			const gchar* _tmp40_;
			gboolean _tmp42_;
			gboolean _tmp45_ = FALSE;
			const gchar* _tmp46_;
			gboolean _tmp48_;
			gboolean _tmp51_ = FALSE;
			const gchar* _tmp52_;
			gboolean _tmp54_;
			gboolean _tmp57_ = FALSE;
			const gchar* _tmp58_;
			gboolean _tmp60_;
			FolksRoleFieldDetails* _tmp63_;
			FolksRoleFieldDetails* _tmp64_;
			_tmp37_ = new_role;
			_tmp38_ = folks_role_field_details_new (_tmp37_, NULL);
			default_role = _tmp38_;
			_tmp40_ = org_unit;
			if (_tmp40_ != NULL) {
				const gchar* _tmp41_;
				_tmp41_ = org_unit;
				_tmp39_ = g_strcmp0 (_tmp41_, "") != 0;
			} else {
				_tmp39_ = FALSE;
			}
			_tmp42_ = _tmp39_;
			if (_tmp42_) {
				FolksRoleFieldDetails* _tmp43_;
				const gchar* _tmp44_;
				_tmp43_ = default_role;
				_tmp44_ = org_unit;
				folks_abstract_field_details_set_parameter ((FolksAbstractFieldDetails*) _tmp43_, "org_unit", (const gchar*) _tmp44_);
			}
			_tmp46_ = office;
			if (_tmp46_ != NULL) {
				const gchar* _tmp47_;
				_tmp47_ = office;
				_tmp45_ = g_strcmp0 (_tmp47_, "") != 0;
			} else {
				_tmp45_ = FALSE;
			}
			_tmp48_ = _tmp45_;
			if (_tmp48_) {
				FolksRoleFieldDetails* _tmp49_;
				const gchar* _tmp50_;
				_tmp49_ = default_role;
				_tmp50_ = office;
				folks_abstract_field_details_set_parameter ((FolksAbstractFieldDetails*) _tmp49_, "office", (const gchar*) _tmp50_);
			}
			_tmp52_ = manager;
			if (_tmp52_ != NULL) {
				const gchar* _tmp53_;
				_tmp53_ = manager;
				_tmp51_ = g_strcmp0 (_tmp53_, "") != 0;
			} else {
				_tmp51_ = FALSE;
			}
			_tmp54_ = _tmp51_;
			if (_tmp54_) {
				FolksRoleFieldDetails* _tmp55_;
				const gchar* _tmp56_;
				_tmp55_ = default_role;
				_tmp56_ = manager;
				folks_abstract_field_details_set_parameter ((FolksAbstractFieldDetails*) _tmp55_, "manager", (const gchar*) _tmp56_);
			}
			_tmp58_ = assistant;
			if (_tmp58_ != NULL) {
				const gchar* _tmp59_;
				_tmp59_ = manager;
				_tmp57_ = g_strcmp0 (_tmp59_, "") != 0;
			} else {
				_tmp57_ = FALSE;
			}
			_tmp60_ = _tmp57_;
			if (_tmp60_) {
				FolksRoleFieldDetails* _tmp61_;
				const gchar* _tmp62_;
				_tmp61_ = default_role;
				_tmp62_ = assistant;
				folks_abstract_field_details_set_parameter ((FolksAbstractFieldDetails*) _tmp61_, "assistant", (const gchar*) _tmp62_);
			}
			_tmp63_ = default_role;
			_tmp64_ = _g_object_ref0 (_tmp63_);
			_g_object_unref0 (_default_role);
			_default_role = _tmp64_;
			_g_object_unref0 (default_role);
		}
		_g_object_unref0 (new_role);
	}
	result = _default_role;
	_g_free0 (assistant);
	_g_free0 (manager);
	_g_free0 (role);
	_g_free0 (title);
	_g_free0 (office);
	_g_free0 (org_unit);
	_g_free0 (org);
	return result;
}


static EVCardAttributeParam* _vala_EVCardAttributeParam_copy (EVCardAttributeParam* self) {
	return g_boxed_copy (e_vcard_attribute_param_get_type (), self);
}


static gpointer __vala_EVCardAttributeParam_copy0 (gpointer self) {
	return self ? _vala_EVCardAttributeParam_copy (self) : NULL;
}


static void _vala_EVCardAttributeParam_free (EVCardAttributeParam* self) {
	g_boxed_free (e_vcard_attribute_param_get_type (), self);
}


static void _edsf_persona_update_web_services_addresses (EdsfPersona* self) {
	GeeHashMultiMap* new_services = NULL;
	GeeHashMultiMap* _tmp0_;
	EVCardAttribute* services = NULL;
	EContact* _tmp1_;
	EContact* _tmp2_;
	EVCardAttribute* _tmp3_ = NULL;
	EVCardAttribute* _tmp4_;
	EVCardAttribute* _tmp5_;
	GeeHashMultiMap* _tmp21_;
	GeeHashMultiMap* _tmp22_;
	gboolean _tmp23_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, FOLKS_TYPE_WEB_SERVICE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_services = _tmp0_;
	_tmp1_ = edsf_persona_get_contact (self);
	_tmp2_ = _tmp1_;
	_tmp3_ = e_vcard_get_attribute ((EVCard*) _tmp2_, "X-FOLKS-WEB-SERVICES-IDS");
	_tmp4_ = __vala_EVCardAttribute_copy0 (_tmp3_);
	services = _tmp4_;
	_tmp5_ = services;
	if (_tmp5_ != NULL) {
		EVCardAttribute* _tmp6_;
		GList* _tmp7_ = NULL;
		_tmp6_ = services;
		_tmp7_ = e_vcard_attribute_get_params ((EVCardAttribute*) _tmp6_);
		{
			GList* service_collection = NULL;
			GList* service_it = NULL;
			service_collection = _tmp7_;
			for (service_it = service_collection; service_it != NULL; service_it = service_it->next) {
				EVCardAttributeParam* _tmp8_;
				EVCardAttributeParam* service = NULL;
				_tmp8_ = __vala_EVCardAttributeParam_copy0 ((EVCardAttributeParam*) service_it->data);
				service = _tmp8_;
				{
					gchar* service_name = NULL;
					EVCardAttributeParam* _tmp9_;
					const gchar* _tmp10_ = NULL;
					gchar* _tmp11_ = NULL;
					EVCardAttributeParam* _tmp12_;
					GList* _tmp13_ = NULL;
					_tmp9_ = service;
					_tmp10_ = e_vcard_attribute_param_get_name (_tmp9_);
					_tmp11_ = g_utf8_strdown (_tmp10_, (gssize) (-1));
					service_name = _tmp11_;
					_tmp12_ = service;
					_tmp13_ = e_vcard_attribute_param_get_values (_tmp12_);
					{
						GList* service_id_collection = NULL;
						GList* service_id_it = NULL;
						service_id_collection = _tmp13_;
						for (service_id_it = service_id_collection; service_id_it != NULL; service_id_it = service_id_it->next) {
							gchar* _tmp14_;
							gchar* service_id = NULL;
							_tmp14_ = g_strdup ((const gchar*) service_id_it->data);
							service_id = _tmp14_;
							{
								const gchar* _tmp15_;
								GeeHashMultiMap* _tmp16_;
								const gchar* _tmp17_;
								const gchar* _tmp18_;
								FolksWebServiceFieldDetails* _tmp19_;
								FolksWebServiceFieldDetails* _tmp20_;
								_tmp15_ = service_id;
								if (g_strcmp0 (_tmp15_, "") == 0) {
									_g_free0 (service_id);
									continue;
								}
								_tmp16_ = new_services;
								_tmp17_ = service_name;
								_tmp18_ = service_id;
								_tmp19_ = folks_web_service_field_details_new (_tmp18_, NULL);
								_tmp20_ = _tmp19_;
								gee_multi_map_set ((GeeMultiMap*) _tmp16_, _tmp17_, _tmp20_);
								_g_object_unref0 (_tmp20_);
								_g_free0 (service_id);
							}
						}
					}
					_g_free0 (service_name);
					__vala_EVCardAttributeParam_free0 (service);
				}
			}
		}
	}
	_tmp21_ = new_services;
	_tmp22_ = self->priv->_web_service_addresses;
	_tmp23_ = folks_utils_multi_map_str_afd_equal ((GeeMultiMap*) _tmp21_, (GeeMultiMap*) _tmp22_);
	if (!_tmp23_) {
		GeeHashMultiMap* _tmp24_;
		GeeHashMultiMap* _tmp25_;
		_tmp24_ = new_services;
		_tmp25_ = _g_object_ref0 (_tmp24_);
		_g_object_unref0 (self->priv->_web_service_addresses);
		self->priv->_web_service_addresses = _tmp25_;
		g_object_notify ((GObject*) self, "web-service-addresses");
	}
	__vala_EVCardAttribute_free0 (services);
	_g_object_unref0 (new_services);
}


static void __vala_EVCardAttribute_free0_ (gpointer var) {
	(var == NULL) ? NULL : (var = (_vala_EVCardAttribute_free (var), NULL));
}


static void _g_list_free___vala_EVCardAttribute_free0_ (GList* self) {
	g_list_foreach (self, (GFunc) __vala_EVCardAttribute_free0_, NULL);
	g_list_free (self);
}


static void _edsf_persona_update_emails (EdsfPersona* self, gboolean emit_notification) {
	FolksSmallSet* new_email_addresses = NULL;
	FolksSmallSet* _tmp0_;
	GList* attrs = NULL;
	EContact* _tmp1_;
	EContact* _tmp2_;
	GList* _tmp3_ = NULL;
	GList* _tmp4_;
	FolksSmallSet* _tmp18_;
	FolksSmallSet* _tmp19_;
	gboolean _tmp20_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = folks_small_set_new (FOLKS_TYPE_EMAIL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_email_addresses = _tmp0_;
	_tmp1_ = edsf_persona_get_contact (self);
	_tmp2_ = _tmp1_;
	_tmp3_ = e_contact_get_attributes (_tmp2_, E_CONTACT_EMAIL);
	attrs = _tmp3_;
	_tmp4_ = attrs;
	{
		GList* attr_collection = NULL;
		GList* attr_it = NULL;
		attr_collection = _tmp4_;
		for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
			EVCardAttribute* _tmp5_;
			EVCardAttribute* attr = NULL;
			_tmp5_ = __vala_EVCardAttribute_copy0 ((EVCardAttribute*) attr_it->data);
			attr = _tmp5_;
			{
				gchar* val = NULL;
				EVCardAttribute* _tmp6_;
				gchar* _tmp7_ = NULL;
				gboolean _tmp8_ = FALSE;
				const gchar* _tmp9_;
				gboolean _tmp11_;
				FolksEmailFieldDetails* email_fd = NULL;
				const gchar* _tmp12_;
				FolksEmailFieldDetails* _tmp13_;
				FolksEmailFieldDetails* _tmp14_;
				EVCardAttribute* _tmp15_;
				FolksSmallSet* _tmp16_;
				FolksEmailFieldDetails* _tmp17_;
				_tmp6_ = attr;
				_tmp7_ = e_vcard_attribute_get_value (_tmp6_);
				val = _tmp7_;
				_tmp9_ = val;
				if (_tmp9_ == NULL) {
					_tmp8_ = TRUE;
				} else {
					const gchar* _tmp10_;
					_tmp10_ = val;
					_tmp8_ = g_strcmp0 ((const gchar*) _tmp10_, "") == 0;
				}
				_tmp11_ = _tmp8_;
				if (_tmp11_) {
					_g_free0 (val);
					__vala_EVCardAttribute_free0 (attr);
					continue;
				}
				_tmp12_ = val;
				_tmp13_ = folks_email_field_details_new ((const gchar*) _tmp12_, NULL);
				email_fd = _tmp13_;
				_tmp14_ = email_fd;
				_tmp15_ = attr;
				_edsf_persona_update_params (self, (FolksAbstractFieldDetails*) _tmp14_, _tmp15_);
				_tmp16_ = new_email_addresses;
				_tmp17_ = email_fd;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp16_, _tmp17_);
				_g_object_unref0 (email_fd);
				_g_free0 (val);
				__vala_EVCardAttribute_free0 (attr);
			}
		}
	}
	_tmp18_ = new_email_addresses;
	_tmp19_ = self->priv->_email_addresses;
	_tmp20_ = folks_internal_equal_sets (FOLKS_TYPE_EMAIL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, (GeeSet*) _tmp18_, (GeeSet*) _tmp19_);
	if (!_tmp20_) {
		FolksSmallSet* _tmp21_;
		FolksSmallSet* _tmp22_;
		FolksSmallSet* _tmp23_;
		GeeSet* _tmp24_;
		GeeSet* _tmp25_;
		gboolean _tmp26_;
		_tmp21_ = new_email_addresses;
		_tmp22_ = _g_object_ref0 (_tmp21_);
		_g_object_unref0 (self->priv->_email_addresses);
		self->priv->_email_addresses = _tmp22_;
		_tmp23_ = new_email_addresses;
		_tmp24_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp23_);
		_tmp25_ = _tmp24_;
		_g_object_unref0 (self->priv->_email_addresses_ro);
		self->priv->_email_addresses_ro = _tmp25_;
		_tmp26_ = emit_notification;
		if (_tmp26_) {
			g_object_notify ((GObject*) self, "email-addresses");
		}
	}
	__g_list_free___vala_EVCardAttribute_free0_0 (attrs);
	_g_object_unref0 (new_email_addresses);
}


static void _edsf_persona_update_notes (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification) {
	gboolean _tmp0_ = FALSE;
	FolksSmallSet* _tmp1_;
	gboolean _tmp3_;
	FolksSmallSet* new_notes = NULL;
	FolksSmallSet* _tmp10_;
	gchar* n = NULL;
	gpointer _tmp11_ = NULL;
	gboolean _tmp12_ = FALSE;
	const gchar* _tmp13_;
	gboolean _tmp15_;
	FolksSmallSet* _tmp20_;
	FolksSmallSet* _tmp21_;
	gboolean _tmp22_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_notes;
	if (_tmp1_ == NULL) {
		gboolean _tmp2_;
		_tmp2_ = create_if_not_exist;
		_tmp0_ = _tmp2_ == FALSE;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp3_ = _tmp0_;
	if (_tmp3_) {
		gboolean _tmp4_;
		_tmp4_ = emit_notification;
		if (_tmp4_) {
			g_object_notify ((GObject*) self, "notes");
		}
		return;
	} else {
		FolksSmallSet* _tmp5_;
		_tmp5_ = self->priv->_notes;
		if (_tmp5_ == NULL) {
			FolksSmallSet* _tmp6_;
			FolksSmallSet* _tmp7_;
			GeeSet* _tmp8_;
			GeeSet* _tmp9_;
			_tmp6_ = folks_small_set_new (FOLKS_TYPE_NOTE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
			_g_object_unref0 (self->priv->_notes);
			self->priv->_notes = _tmp6_;
			_tmp7_ = self->priv->_notes;
			_tmp8_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp7_);
			_tmp9_ = _tmp8_;
			_g_object_unref0 (self->priv->_notes_ro);
			self->priv->_notes_ro = _tmp9_;
		}
	}
	_tmp10_ = folks_small_set_new (FOLKS_TYPE_NOTE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_notes = _tmp10_;
	_tmp11_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "note");
	n = (gchar*) _tmp11_;
	_tmp13_ = n;
	if (_tmp13_ != NULL) {
		const gchar* _tmp14_;
		_tmp14_ = n;
		_tmp12_ = g_strcmp0 (_tmp14_, "") != 0;
	} else {
		_tmp12_ = FALSE;
	}
	_tmp15_ = _tmp12_;
	if (_tmp15_) {
		FolksNoteFieldDetails* note = NULL;
		const gchar* _tmp16_;
		FolksNoteFieldDetails* _tmp17_;
		FolksSmallSet* _tmp18_;
		FolksNoteFieldDetails* _tmp19_;
		_tmp16_ = n;
		_tmp17_ = folks_note_field_details_new ((const gchar*) _tmp16_, NULL, NULL);
		note = _tmp17_;
		_tmp18_ = new_notes;
		_tmp19_ = note;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp18_, _tmp19_);
		_g_object_unref0 (note);
	}
	_tmp20_ = new_notes;
	_tmp21_ = self->priv->_notes;
	_tmp22_ = folks_internal_equal_sets (FOLKS_TYPE_NOTE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, (GeeSet*) _tmp20_, (GeeSet*) _tmp21_);
	if (!_tmp22_) {
		FolksSmallSet* _tmp23_;
		FolksSmallSet* _tmp24_;
		FolksSmallSet* _tmp25_;
		GeeSet* _tmp26_;
		GeeSet* _tmp27_;
		gboolean _tmp28_;
		_tmp23_ = new_notes;
		_tmp24_ = _g_object_ref0 (_tmp23_);
		_g_object_unref0 (self->priv->_notes);
		self->priv->_notes = _tmp24_;
		_tmp25_ = self->priv->_notes;
		_tmp26_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp25_);
		_tmp27_ = _tmp26_;
		_g_object_unref0 (self->priv->_notes_ro);
		self->priv->_notes_ro = _tmp27_;
		_tmp28_ = emit_notification;
		if (_tmp28_) {
			g_object_notify ((GObject*) self, "notes");
		}
	}
	_g_free0 (n);
	_g_object_unref0 (new_notes);
}


static EContactName* _vala_EContactName_copy (EContactName* self) {
	return g_boxed_copy (e_contact_name_get_type (), self);
}


static void _vala_EContactName_free (EContactName* self) {
	g_boxed_free (e_contact_name_get_type (), self);
}


static gpointer __vala_EContactName_copy0 (gpointer self) {
	return self ? _vala_EContactName_copy (self) : NULL;
}


static void _edsf_persona_update_names (EdsfPersona* self) {
	gchar* _full_name = NULL;
	gpointer _tmp0_ = NULL;
	const gchar* _tmp1_;
	gchar* full_name = NULL;
	const gchar* _tmp3_;
	gchar* _tmp4_;
	const gchar* _tmp5_;
	const gchar* _tmp6_;
	gchar* _nickname = NULL;
	gpointer _tmp9_ = NULL;
	const gchar* _tmp10_;
	gchar* nickname = NULL;
	const gchar* _tmp12_;
	gchar* _tmp13_;
	const gchar* _tmp14_;
	const gchar* _tmp15_;
	FolksStructuredName* structured_name = NULL;
	EContactName* _cn = NULL;
	gpointer _tmp18_ = NULL;
	EContactName* _tmp19_;
	gboolean _tmp43_ = FALSE;
	FolksStructuredName* _tmp44_;
	gboolean _tmp47_;
	g_return_if_fail (self != NULL);
	_tmp0_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "full_name");
	_full_name = (gchar*) _tmp0_;
	_tmp1_ = _full_name;
	if (_tmp1_ == NULL) {
		gchar* _tmp2_;
		_tmp2_ = g_strdup ("");
		_g_free0 (_full_name);
		_full_name = _tmp2_;
	}
	_tmp3_ = _full_name;
	_tmp4_ = g_strdup ((const gchar*) _tmp3_);
	full_name = _tmp4_;
	_tmp5_ = self->priv->_full_name;
	_tmp6_ = full_name;
	if (g_strcmp0 (_tmp5_, _tmp6_) != 0) {
		const gchar* _tmp7_;
		gchar* _tmp8_;
		_tmp7_ = full_name;
		_tmp8_ = g_strdup (_tmp7_);
		_g_free0 (self->priv->_full_name);
		self->priv->_full_name = _tmp8_;
		g_object_notify ((GObject*) self, "full-name");
	}
	_tmp9_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, "nickname");
	_nickname = (gchar*) _tmp9_;
	_tmp10_ = _nickname;
	if (_tmp10_ == NULL) {
		gchar* _tmp11_;
		_tmp11_ = g_strdup ("");
		_g_free0 (_nickname);
		_nickname = _tmp11_;
	}
	_tmp12_ = _nickname;
	_tmp13_ = g_strdup ((const gchar*) _tmp12_);
	nickname = _tmp13_;
	_tmp14_ = self->priv->_nickname;
	_tmp15_ = nickname;
	if (g_strcmp0 (_tmp14_, _tmp15_) != 0) {
		const gchar* _tmp16_;
		gchar* _tmp17_;
		_tmp16_ = nickname;
		_tmp17_ = g_strdup (_tmp16_);
		_g_free0 (self->priv->_nickname);
		self->priv->_nickname = _tmp17_;
		g_object_notify ((GObject*) self, "nickname");
	}
	structured_name = NULL;
	_tmp18_ = _edsf_persona_get_property (self, e_contact_name_get_type (), (GBoxedCopyFunc) _vala_EContactName_copy, _vala_EContactName_free, "name");
	_cn = (EContactName*) _tmp18_;
	_tmp19_ = _cn;
	if (_tmp19_ != NULL) {
		EContactName* cn = NULL;
		EContactName* _tmp20_;
		EContactName* _tmp21_;
		gchar* family_name = NULL;
		EContactName* _tmp22_;
		const gchar* _tmp23_;
		gchar* _tmp24_;
		gchar* given_name = NULL;
		EContactName* _tmp25_;
		const gchar* _tmp26_;
		gchar* _tmp27_;
		gchar* additional_names = NULL;
		EContactName* _tmp28_;
		const gchar* _tmp29_;
		gchar* _tmp30_;
		gchar* prefixes = NULL;
		EContactName* _tmp31_;
		const gchar* _tmp32_;
		gchar* _tmp33_;
		gchar* suffixes = NULL;
		EContactName* _tmp34_;
		const gchar* _tmp35_;
		gchar* _tmp36_;
		const gchar* _tmp37_;
		const gchar* _tmp38_;
		const gchar* _tmp39_;
		const gchar* _tmp40_;
		const gchar* _tmp41_;
		FolksStructuredName* _tmp42_;
		_tmp20_ = _cn;
		_tmp21_ = __vala_EContactName_copy0 ((EContactName*) _tmp20_);
		cn = _tmp21_;
		_tmp22_ = cn;
		_tmp23_ = _tmp22_->family;
		_tmp24_ = g_strdup (_tmp23_);
		family_name = _tmp24_;
		_tmp25_ = cn;
		_tmp26_ = _tmp25_->given;
		_tmp27_ = g_strdup (_tmp26_);
		given_name = _tmp27_;
		_tmp28_ = cn;
		_tmp29_ = _tmp28_->additional;
		_tmp30_ = g_strdup (_tmp29_);
		additional_names = _tmp30_;
		_tmp31_ = cn;
		_tmp32_ = _tmp31_->prefixes;
		_tmp33_ = g_strdup (_tmp32_);
		prefixes = _tmp33_;
		_tmp34_ = cn;
		_tmp35_ = _tmp34_->suffixes;
		_tmp36_ = g_strdup (_tmp35_);
		suffixes = _tmp36_;
		_tmp37_ = family_name;
		_tmp38_ = given_name;
		_tmp39_ = additional_names;
		_tmp40_ = prefixes;
		_tmp41_ = suffixes;
		_tmp42_ = folks_structured_name_new (_tmp37_, _tmp38_, _tmp39_, _tmp40_, _tmp41_);
		_g_object_unref0 (structured_name);
		structured_name = _tmp42_;
		_g_free0 (suffixes);
		_g_free0 (prefixes);
		_g_free0 (additional_names);
		_g_free0 (given_name);
		_g_free0 (family_name);
		__vala_EContactName_free0 (cn);
	}
	_tmp44_ = structured_name;
	if (_tmp44_ != NULL) {
		FolksStructuredName* _tmp45_;
		gboolean _tmp46_ = FALSE;
		_tmp45_ = structured_name;
		_tmp46_ = folks_structured_name_is_empty (G_TYPE_CHECK_INSTANCE_CAST (_tmp45_, FOLKS_TYPE_STRUCTURED_NAME, FolksStructuredName));
		_tmp43_ = !_tmp46_;
	} else {
		_tmp43_ = FALSE;
	}
	_tmp47_ = _tmp43_;
	if (_tmp47_) {
		FolksStructuredName* _tmp48_;
		FolksStructuredName* _tmp49_;
		_tmp48_ = structured_name;
		_tmp49_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp48_, FOLKS_TYPE_STRUCTURED_NAME, FolksStructuredName));
		_g_object_unref0 (self->priv->_structured_name);
		self->priv->_structured_name = _tmp49_;
		g_object_notify ((GObject*) self, "structured-name");
	} else {
		FolksStructuredName* _tmp50_;
		_tmp50_ = self->priv->_structured_name;
		if (_tmp50_ != NULL) {
			_g_object_unref0 (self->priv->_structured_name);
			self->priv->_structured_name = NULL;
			g_object_notify ((GObject*) self, "structured-name");
		}
	}
	__vala_EContactName_free0 (_cn);
	_g_object_unref0 (structured_name);
	_g_free0 (nickname);
	_g_free0 (_nickname);
	_g_free0 (full_name);
	_g_free0 (_full_name);
}


static EContactPhoto* _vala_EContactPhoto_copy (EContactPhoto* self) {
	return g_boxed_copy (e_contact_photo_get_type (), self);
}


static gpointer __vala_EContactPhoto_copy0 (gpointer self) {
	return self ? _vala_EContactPhoto_copy (self) : NULL;
}


static void _vala_EContactPhoto_free (EContactPhoto* self) {
	g_boxed_free (e_contact_photo_get_type (), self);
}


static guint8* _vala_array_dup1 (guint8* self, int length) {
	return g_memdup (self, length * sizeof (guint8));
}


static GLoadableIcon* _edsf_persona_contact_photo_to_loadable_icon (EdsfPersona* self, EContactPhoto* _p) {
	GLoadableIcon* result = NULL;
	EContactPhoto* _tmp0_;
	EContactPhoto* p = NULL;
	EContactPhoto* _tmp1_;
	EContactPhoto* _tmp2_;
	EContactPhoto* _tmp3_;
	EContactPhotoType _tmp4_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = _p;
	if (_tmp0_ == NULL) {
		result = NULL;
		return result;
	}
	_tmp1_ = _p;
	_tmp2_ = __vala_EContactPhoto_copy0 ((EContactPhoto*) _tmp1_);
	p = _tmp2_;
	_tmp3_ = p;
	_tmp4_ = _tmp3_->type;
	switch (_tmp4_) {
		case E_CONTACT_PHOTO_TYPE_URI:
		{
			gchar* uri = NULL;
			EContactPhoto* _tmp5_;
			const gchar* _tmp6_ = NULL;
			gchar* _tmp7_;
			const gchar* _tmp8_;
			const gchar* _tmp9_;
			GFile* _tmp10_ = NULL;
			GFile* _tmp11_;
			GFileIcon* _tmp12_;
			GLoadableIcon* _tmp13_;
			_tmp5_ = p;
			_tmp6_ = e_contact_photo_get_uri (_tmp5_);
			_tmp7_ = g_strdup (_tmp6_);
			uri = _tmp7_;
			_tmp8_ = uri;
			if (_tmp8_ == NULL) {
				result = NULL;
				_g_free0 (uri);
				__vala_EContactPhoto_free0 (p);
				return result;
			}
			_tmp9_ = uri;
			_tmp10_ = g_file_new_for_uri ((const gchar*) _tmp9_);
			_tmp11_ = _tmp10_;
			_tmp12_ = (GFileIcon*) g_file_icon_new (_tmp11_);
			_tmp13_ = (GLoadableIcon*) _tmp12_;
			_g_object_unref0 (_tmp11_);
			result = _tmp13_;
			_g_free0 (uri);
			__vala_EContactPhoto_free0 (p);
			return result;
		}
		case E_CONTACT_PHOTO_TYPE_INLINED:
		{
			guint8* data = NULL;
			EContactPhoto* _tmp14_;
			gsize _tmp15_;
			guint8* _tmp16_ = NULL;
			guint8* _tmp17_;
			gint _tmp17__length1;
			gint data_length1;
			gint _data_size_;
			gchar* mime_type = NULL;
			EContactPhoto* _tmp18_;
			const gchar* _tmp19_ = NULL;
			gchar* _tmp20_;
			gboolean _tmp21_ = FALSE;
			guint8* _tmp22_;
			gint _tmp22__length1;
			gboolean _tmp24_;
			const gchar* _tmp25_;
			guint8* _tmp26_;
			gint _tmp26__length1;
			EdsfMemoryIcon* _tmp27_;
			_tmp14_ = p;
			_tmp16_ = e_contact_photo_get_inlined (_tmp14_, &_tmp15_);
			_tmp17_ = (_tmp16_ != NULL) ? _vala_array_dup1 (_tmp16_, _tmp15_) : ((gpointer) _tmp16_);
			_tmp17__length1 = _tmp15_;
			data = _tmp17_;
			data_length1 = _tmp17__length1;
			_data_size_ = data_length1;
			_tmp18_ = p;
			_tmp19_ = e_contact_photo_get_mime_type (_tmp18_);
			_tmp20_ = g_strdup (_tmp19_);
			mime_type = _tmp20_;
			_tmp22_ = data;
			_tmp22__length1 = data_length1;
			if (_tmp22_ == NULL) {
				_tmp21_ = TRUE;
			} else {
				const gchar* _tmp23_;
				_tmp23_ = mime_type;
				_tmp21_ = _tmp23_ == NULL;
			}
			_tmp24_ = _tmp21_;
			if (_tmp24_) {
				result = NULL;
				_g_free0 (mime_type);
				data = (g_free (data), NULL);
				__vala_EContactPhoto_free0 (p);
				return result;
			}
			_tmp25_ = mime_type;
			_tmp26_ = data;
			_tmp26__length1 = data_length1;
			_tmp27_ = edsf_memory_icon_new ((const gchar*) _tmp25_, (guint8*) _tmp26_, (_tmp26__length1 * sizeof (guint8)) / sizeof (guint8));
			result = (GLoadableIcon*) _tmp27_;
			_g_free0 (mime_type);
			data = (g_free (data), NULL);
			__vala_EContactPhoto_free0 (p);
			return result;
		}
		default:
		{
			result = NULL;
			__vala_EContactPhoto_free0 (p);
			return result;
		}
	}
	__vala_EContactPhoto_free0 (p);
}


static Block1Data* block1_data_ref (Block1Data* _data1_) {
	g_atomic_int_inc (&_data1_->_ref_count_);
	return _data1_;
}


static void block1_data_unref (void * _userdata_) {
	Block1Data* _data1_;
	_data1_ = (Block1Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data1_->_ref_count_)) {
		EdsfPersona * self;
		self = _data1_->self;
		_g_object_unref0 (_data1_->new_avatar);
		_g_object_unref0 (_data1_->cache);
		_g_object_unref0 (self);
		g_slice_free (Block1Data, _data1_);
	}
}


static void ___lambda7_ (Block1Data* _data1_, GObject* obj, GAsyncResult* res) {
	EdsfPersona * self;
	GError * _inner_error_ = NULL;
	self = _data1_->self;
	g_return_if_fail (res != NULL);
	{
		FolksAvatarCache* _tmp0_;
		GAsyncResult* _tmp1_;
		_tmp0_ = _data1_->cache;
		_tmp1_ = res;
		folks_avatar_cache_remove_avatar_finish (_tmp0_, _tmp1_, &_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch0_g_error;
		}
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e1 = NULL;
		e1 = _inner_error_;
		_inner_error_ = NULL;
		_g_error_free0 (e1);
	}
	__finally0:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
	_g_object_unref0 (self->priv->_avatar);
	self->priv->_avatar = NULL;
	g_object_notify ((GObject*) self, "avatar");
}


static void ____lambda7__gasync_ready_callback (GObject* source_object, GAsyncResult* res, gpointer self) {
	___lambda7_ (self, source_object, res);
	block1_data_unref (self);
}


static void ____lambda8_ (Block1Data* _data1_, GObject* obj, GAsyncResult* res) {
	EdsfPersona * self;
	GError * _inner_error_ = NULL;
	self = _data1_->self;
	g_return_if_fail (res != NULL);
	{
		FolksAvatarCache* _tmp0_;
		GAsyncResult* _tmp1_;
		gchar* _tmp2_ = NULL;
		gchar* _tmp3_;
		GLoadableIcon* _tmp4_;
		GLoadableIcon* _tmp5_;
		_tmp0_ = _data1_->cache;
		_tmp1_ = res;
		_tmp2_ = folks_avatar_cache_store_avatar_finish (_tmp0_, _tmp1_, &_inner_error_);
		_tmp3_ = _tmp2_;
		_g_free0 (_tmp3_);
		if (_inner_error_ != NULL) {
			goto __catch1_g_error;
		}
		_tmp4_ = _data1_->new_avatar;
		_tmp5_ = _g_object_ref0 (_tmp4_);
		_g_object_unref0 (self->priv->_avatar);
		self->priv->_avatar = _tmp5_;
		g_object_notify ((GObject*) self, "avatar");
	}
	goto __finally1;
	__catch1_g_error:
	{
		GError* e2 = NULL;
		const gchar* _tmp6_;
		const gchar* _tmp7_;
		GError* _tmp8_;
		const gchar* _tmp9_;
		e2 = _inner_error_;
		_inner_error_ = NULL;
		_tmp6_ = folks_persona_get_uid ((FolksPersona*) self);
		_tmp7_ = _tmp6_;
		_tmp8_ = e2;
		_tmp9_ = _tmp8_->message;
		g_warning ("edsf-persona.vala:1550: Couldn't cache avatar for Edsf.Persona '%s': %" \
"s", _tmp7_, _tmp9_);
		_g_object_unref0 (_data1_->new_avatar);
		_data1_->new_avatar = NULL;
		_g_error_free0 (e2);
	}
	__finally1:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
}


static void _____lambda8__gasync_ready_callback (GObject* source_object, GAsyncResult* res, gpointer self) {
	____lambda8_ (self, source_object, res);
	block1_data_unref (self);
}


static void _edsf_persona_update_avatar (EdsfPersona* self) {
	Block1Data* _data1_;
	EContactPhoto* p = NULL;
	gpointer _tmp0_ = NULL;
	FolksAvatarCache* _tmp1_ = NULL;
	EContactPhoto* _tmp2_;
	GLoadableIcon* _tmp3_ = NULL;
	gboolean _tmp4_ = FALSE;
	GLoadableIcon* _tmp5_;
	gboolean _tmp7_;
	g_return_if_fail (self != NULL);
	_data1_ = g_slice_new0 (Block1Data);
	_data1_->_ref_count_ = 1;
	_data1_->self = g_object_ref (self);
	_tmp0_ = _edsf_persona_get_property (self, e_contact_photo_get_type (), (GBoxedCopyFunc) _vala_EContactPhoto_copy, _vala_EContactPhoto_free, "photo");
	p = (EContactPhoto*) _tmp0_;
	_tmp1_ = folks_avatar_cache_dup ();
	_data1_->cache = _tmp1_;
	_tmp2_ = p;
	_tmp3_ = _edsf_persona_contact_photo_to_loadable_icon (self, _tmp2_);
	_data1_->new_avatar = _tmp3_;
	_tmp5_ = self->priv->_avatar;
	if (_tmp5_ != NULL) {
		GLoadableIcon* _tmp6_;
		_tmp6_ = _data1_->new_avatar;
		_tmp4_ = _tmp6_ == NULL;
	} else {
		_tmp4_ = FALSE;
	}
	_tmp7_ = _tmp4_;
	if (_tmp7_) {
		FolksAvatarCache* _tmp8_;
		const gchar* _tmp9_;
		const gchar* _tmp10_;
		_tmp8_ = _data1_->cache;
		_tmp9_ = folks_persona_get_uid ((FolksPersona*) self);
		_tmp10_ = _tmp9_;
		folks_avatar_cache_remove_avatar (_tmp8_, _tmp10_, ____lambda7__gasync_ready_callback, block1_data_ref (_data1_));
	} else {
		gboolean _tmp11_ = FALSE;
		gboolean _tmp12_ = FALSE;
		GLoadableIcon* _tmp13_;
		gboolean _tmp15_;
		gboolean _tmp25_;
		_tmp13_ = self->priv->_avatar;
		if (_tmp13_ == NULL) {
			GLoadableIcon* _tmp14_;
			_tmp14_ = _data1_->new_avatar;
			_tmp12_ = _tmp14_ != NULL;
		} else {
			_tmp12_ = FALSE;
		}
		_tmp15_ = _tmp12_;
		if (_tmp15_) {
			_tmp11_ = TRUE;
		} else {
			gboolean _tmp16_ = FALSE;
			gboolean _tmp17_ = FALSE;
			GLoadableIcon* _tmp18_;
			gboolean _tmp20_;
			gboolean _tmp24_;
			_tmp18_ = self->priv->_avatar;
			if (_tmp18_ != NULL) {
				GLoadableIcon* _tmp19_;
				_tmp19_ = _data1_->new_avatar;
				_tmp17_ = _tmp19_ != NULL;
			} else {
				_tmp17_ = FALSE;
			}
			_tmp20_ = _tmp17_;
			if (_tmp20_) {
				GLoadableIcon* _tmp21_;
				GLoadableIcon* _tmp22_;
				gboolean _tmp23_ = FALSE;
				_tmp21_ = self->priv->_avatar;
				_tmp22_ = _data1_->new_avatar;
				_tmp23_ = g_icon_equal ((GIcon*) G_TYPE_CHECK_INSTANCE_CAST (_tmp21_, g_loadable_icon_get_type (), GLoadableIcon), (GIcon*) _tmp22_);
				_tmp16_ = _tmp23_ == FALSE;
			} else {
				_tmp16_ = FALSE;
			}
			_tmp24_ = _tmp16_;
			_tmp11_ = _tmp24_;
		}
		_tmp25_ = _tmp11_;
		if (_tmp25_) {
			FolksAvatarCache* _tmp26_;
			const gchar* _tmp27_;
			const gchar* _tmp28_;
			GLoadableIcon* _tmp29_;
			_tmp26_ = _data1_->cache;
			_tmp27_ = folks_persona_get_uid ((FolksPersona*) self);
			_tmp28_ = _tmp27_;
			_tmp29_ = _data1_->new_avatar;
			folks_avatar_cache_store_avatar (_tmp26_, _tmp28_, G_TYPE_CHECK_INSTANCE_CAST (_tmp29_, g_loadable_icon_get_type (), GLoadableIcon), _____lambda8__gasync_ready_callback, block1_data_ref (_data1_));
		}
	}
	__vala_EContactPhoto_free0 (p);
	block1_data_unref (_data1_);
	_data1_ = NULL;
}


static void _edsf_persona_update_urls (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification) {
	gboolean _tmp0_ = FALSE;
	FolksSmallSet* _tmp1_;
	gboolean _tmp3_;
	FolksSmallSet* new_urls = NULL;
	FolksSmallSet* _tmp10_;
	EVCard* vcard = NULL;
	EContact* _tmp29_;
	EContact* _tmp30_;
	EVCard* _tmp31_;
	EVCard* _tmp32_;
	GList* _tmp33_ = NULL;
	FolksSmallSet* _tmp48_;
	FolksSmallSet* _tmp49_;
	gboolean _tmp50_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_urls;
	if (_tmp1_ == NULL) {
		gboolean _tmp2_;
		_tmp2_ = create_if_not_exist;
		_tmp0_ = _tmp2_ == FALSE;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp3_ = _tmp0_;
	if (_tmp3_) {
		gboolean _tmp4_;
		_tmp4_ = emit_notification;
		if (_tmp4_) {
			g_object_notify ((GObject*) self, "urls");
		}
		return;
	} else {
		FolksSmallSet* _tmp5_;
		_tmp5_ = self->priv->_urls;
		if (_tmp5_ == NULL) {
			FolksSmallSet* _tmp6_;
			FolksSmallSet* _tmp7_;
			GeeSet* _tmp8_;
			GeeSet* _tmp9_;
			_tmp6_ = folks_small_set_new (FOLKS_TYPE_URL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
			_g_object_unref0 (self->priv->_urls);
			self->priv->_urls = _tmp6_;
			_tmp7_ = self->priv->_urls;
			_tmp8_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp7_);
			_tmp9_ = _tmp8_;
			_g_object_unref0 (self->priv->_urls_ro);
			self->priv->_urls_ro = _tmp9_;
		}
	}
	_tmp10_ = folks_small_set_new (FOLKS_TYPE_URL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_urls = _tmp10_;
	{
		EdsfPersonaUrlTypeMapping* mapping_collection = NULL;
		gint mapping_collection_length1 = 0;
		gint _mapping_collection_size_ = 0;
		gint mapping_it = 0;
		mapping_collection = EDSF_PERSONA__url_properties;
		mapping_collection_length1 = G_N_ELEMENTS (EDSF_PERSONA__url_properties);
		for (mapping_it = 0; mapping_it < G_N_ELEMENTS (EDSF_PERSONA__url_properties); mapping_it = mapping_it + 1) {
			EdsfPersonaUrlTypeMapping mapping = {0};
			mapping = mapping_collection[mapping_it];
			{
				gchar* url_property = NULL;
				EdsfPersonaUrlTypeMapping _tmp11_;
				const gchar* _tmp12_;
				gchar* _tmp13_;
				gchar* folks_type = NULL;
				EdsfPersonaUrlTypeMapping _tmp14_;
				const gchar* _tmp15_;
				gchar* _tmp16_;
				gchar* u = NULL;
				const gchar* _tmp17_;
				gpointer _tmp18_ = NULL;
				gboolean _tmp19_ = FALSE;
				const gchar* _tmp20_;
				gboolean _tmp22_;
				_tmp11_ = mapping;
				_tmp12_ = _tmp11_.vcard_field_name;
				_tmp13_ = g_strdup (_tmp12_);
				url_property = _tmp13_;
				_tmp14_ = mapping;
				_tmp15_ = _tmp14_.folks_type;
				_tmp16_ = g_strdup (_tmp15_);
				folks_type = _tmp16_;
				_tmp17_ = url_property;
				_tmp18_ = _edsf_persona_get_property (self, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, _tmp17_);
				u = (gchar*) _tmp18_;
				_tmp20_ = u;
				if (_tmp20_ != NULL) {
					const gchar* _tmp21_;
					_tmp21_ = u;
					_tmp19_ = g_strcmp0 (_tmp21_, "") != 0;
				} else {
					_tmp19_ = FALSE;
				}
				_tmp22_ = _tmp19_;
				if (_tmp22_) {
					FolksUrlFieldDetails* fd_u = NULL;
					const gchar* _tmp23_;
					FolksUrlFieldDetails* _tmp24_;
					FolksUrlFieldDetails* _tmp25_;
					const gchar* _tmp26_;
					FolksSmallSet* _tmp27_;
					FolksUrlFieldDetails* _tmp28_;
					_tmp23_ = u;
					_tmp24_ = folks_url_field_details_new ((const gchar*) _tmp23_, NULL);
					fd_u = _tmp24_;
					_tmp25_ = fd_u;
					_tmp26_ = folks_type;
					folks_abstract_field_details_set_parameter ((FolksAbstractFieldDetails*) _tmp25_, FOLKS_ABSTRACT_FIELD_DETAILS_PARAM_TYPE, _tmp26_);
					_tmp27_ = new_urls;
					_tmp28_ = fd_u;
					gee_abstract_collection_add ((GeeAbstractCollection*) _tmp27_, _tmp28_);
					_g_object_unref0 (fd_u);
				}
				_g_free0 (u);
				_g_free0 (folks_type);
				_g_free0 (url_property);
			}
		}
	}
	_tmp29_ = edsf_persona_get_contact (self);
	_tmp30_ = _tmp29_;
	_tmp31_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp30_, e_vcard_get_type (), EVCard));
	vcard = _tmp31_;
	_tmp32_ = vcard;
	_tmp33_ = e_vcard_get_attributes (_tmp32_);
	{
		GList* attr_collection = NULL;
		GList* attr_it = NULL;
		attr_collection = _tmp33_;
		for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
			EVCardAttribute* attr = NULL;
			attr = (EVCardAttribute*) attr_it->data;
			{
				EVCardAttribute* _tmp34_;
				const gchar* _tmp35_ = NULL;
				_tmp34_ = attr;
				_tmp35_ = e_vcard_attribute_get_name (_tmp34_);
				if (g_strcmp0 (_tmp35_, "X-URIS") == 0) {
					gchar* val = NULL;
					EVCardAttribute* _tmp36_;
					gchar* _tmp37_ = NULL;
					gboolean _tmp38_ = FALSE;
					const gchar* _tmp39_;
					gboolean _tmp41_;
					FolksUrlFieldDetails* url_fd = NULL;
					const gchar* _tmp42_;
					FolksUrlFieldDetails* _tmp43_;
					FolksUrlFieldDetails* _tmp44_;
					EVCardAttribute* _tmp45_;
					FolksSmallSet* _tmp46_;
					FolksUrlFieldDetails* _tmp47_;
					_tmp36_ = attr;
					_tmp37_ = e_vcard_attribute_get_value (_tmp36_);
					val = _tmp37_;
					_tmp39_ = val;
					if (_tmp39_ == NULL) {
						_tmp38_ = TRUE;
					} else {
						const gchar* _tmp40_;
						_tmp40_ = val;
						_tmp38_ = g_strcmp0 ((const gchar*) _tmp40_, "") == 0;
					}
					_tmp41_ = _tmp38_;
					if (_tmp41_) {
						_g_free0 (val);
						continue;
					}
					_tmp42_ = val;
					_tmp43_ = folks_url_field_details_new ((const gchar*) _tmp42_, NULL);
					url_fd = _tmp43_;
					_tmp44_ = url_fd;
					_tmp45_ = attr;
					_edsf_persona_update_params (self, (FolksAbstractFieldDetails*) _tmp44_, _tmp45_);
					_tmp46_ = new_urls;
					_tmp47_ = url_fd;
					gee_abstract_collection_add ((GeeAbstractCollection*) _tmp46_, _tmp47_);
					_g_object_unref0 (url_fd);
					_g_free0 (val);
				}
			}
		}
	}
	_tmp48_ = new_urls;
	_tmp49_ = self->priv->_urls;
	_tmp50_ = folks_utils_set_afd_equal ((GeeSet*) _tmp48_, (GeeSet*) _tmp49_);
	if (!_tmp50_) {
		FolksSmallSet* _tmp51_;
		FolksSmallSet* _tmp52_;
		FolksSmallSet* _tmp53_;
		GeeSet* _tmp54_;
		GeeSet* _tmp55_;
		gboolean _tmp56_;
		_tmp51_ = new_urls;
		_tmp52_ = _g_object_ref0 (_tmp51_);
		_g_object_unref0 (self->priv->_urls);
		self->priv->_urls = _tmp52_;
		_tmp53_ = new_urls;
		_tmp54_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp53_);
		_tmp55_ = _tmp54_;
		_g_object_unref0 (self->priv->_urls_ro);
		self->priv->_urls_ro = _tmp55_;
		_tmp56_ = emit_notification;
		if (_tmp56_) {
			g_object_notify ((GObject*) self, "urls");
		}
	}
	_g_object_unref0 (vcard);
	_g_object_unref0 (new_urls);
}


static void _edsf_persona_update_im_addresses (EdsfPersona* self) {
	GHashTable* im_eds_map = NULL;
	GHashTable* _tmp0_ = NULL;
	GeeHashMultiMap* new_im_addresses = NULL;
	GeeHashMultiMap* _tmp1_;
	GHashTable* _tmp2_;
	GList* _tmp3_ = NULL;
	GeeHashMultiMap* _tmp85_;
	GeeHashMultiMap* _tmp86_;
	gboolean _tmp87_ = FALSE;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = _edsf_persona_get_im_eds_map ();
	im_eds_map = _tmp0_;
	_tmp1_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, FOLKS_TYPE_IM_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_im_addresses = _tmp1_;
	_tmp2_ = im_eds_map;
	_tmp3_ = g_hash_table_get_keys (_tmp2_);
	{
		GList* im_proto_collection = NULL;
		GList* im_proto_it = NULL;
		im_proto_collection = _tmp3_;
		for (im_proto_it = im_proto_collection; im_proto_it != NULL; im_proto_it = im_proto_it->next) {
			const gchar* im_proto = NULL;
			im_proto = (const gchar*) im_proto_it->data;
			{
				GList* addresses = NULL;
				EContact* _tmp4_;
				EContact* _tmp5_;
				GHashTable* _tmp6_;
				const gchar* _tmp7_;
				gconstpointer _tmp8_ = NULL;
				GList* _tmp9_ = NULL;
				GList* _tmp10_;
				_tmp4_ = edsf_persona_get_contact (self);
				_tmp5_ = _tmp4_;
				_tmp6_ = im_eds_map;
				_tmp7_ = im_proto;
				_tmp8_ = g_hash_table_lookup (_tmp6_, _tmp7_);
				_tmp9_ = e_contact_get_attributes (_tmp5_, (EContactField) ((gintptr) _tmp8_));
				addresses = _tmp9_;
				_tmp10_ = addresses;
				{
					GList* attr_collection = NULL;
					GList* attr_it = NULL;
					attr_collection = _tmp10_;
					for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
						EVCardAttribute* _tmp11_;
						EVCardAttribute* attr = NULL;
						_tmp11_ = __vala_EVCardAttribute_copy0 ((EVCardAttribute*) attr_it->data);
						attr = _tmp11_;
						{
							{
								gchar* addr = NULL;
								EVCardAttribute* _tmp12_;
								gchar* _tmp13_ = NULL;
								gboolean _tmp14_ = FALSE;
								const gchar* _tmp15_;
								gboolean _tmp17_;
								gchar* _tmp18_ = NULL;
								const gchar* _tmp19_;
								const gchar* _tmp20_;
								gchar* _tmp21_ = NULL;
								gchar* normalised_addr = NULL;
								gchar* _tmp22_;
								gchar* _tmp23_;
								gchar* _tmp24_;
								const gchar* _tmp25_;
								FolksImFieldDetails* im_fd = NULL;
								const gchar* _tmp26_;
								FolksImFieldDetails* _tmp27_;
								GeeHashMultiMap* _tmp28_;
								const gchar* _tmp29_;
								FolksImFieldDetails* _tmp30_;
								_tmp12_ = attr;
								_tmp13_ = e_vcard_attribute_get_value (_tmp12_);
								addr = _tmp13_;
								_tmp15_ = addr;
								if (_tmp15_ == NULL) {
									_tmp14_ = TRUE;
								} else {
									const gchar* _tmp16_;
									_tmp16_ = addr;
									_tmp14_ = g_strcmp0 ((const gchar*) _tmp16_, "") == 0;
								}
								_tmp17_ = _tmp14_;
								if (_tmp17_) {
									_g_free0 (addr);
									__vala_EVCardAttribute_free0 (attr);
									continue;
								}
								_tmp19_ = addr;
								_tmp20_ = im_proto;
								_tmp21_ = folks_im_details_normalise_im_address ((const gchar*) _tmp19_, _tmp20_, &_inner_error_);
								_tmp18_ = _tmp21_;
								if (_inner_error_ != NULL) {
									_g_free0 (addr);
									if (_inner_error_->domain == FOLKS_IM_DETAILS_ERROR) {
										goto __catch2_folks_im_details_error;
									}
									_g_free0 (addr);
									__vala_EVCardAttribute_free0 (attr);
									__g_list_free___vala_EVCardAttribute_free0_0 (addresses);
									_g_list_free0 (im_proto_collection);
									_g_object_unref0 (new_im_addresses);
									_g_hash_table_unref0 (im_eds_map);
									g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
									g_clear_error (&_inner_error_);
									return;
								}
								_tmp22_ = _tmp18_;
								_tmp23_ = _tmp22_;
								_tmp22_ = NULL;
								_tmp24_ = _tmp23_;
								_g_free0 (_tmp22_);
								normalised_addr = _tmp24_;
								_tmp25_ = normalised_addr;
								if (g_strcmp0 (_tmp25_, "") == 0) {
									_g_free0 (normalised_addr);
									_g_free0 (addr);
									__vala_EVCardAttribute_free0 (attr);
									continue;
								}
								_tmp26_ = normalised_addr;
								_tmp27_ = folks_im_field_details_new (_tmp26_, NULL);
								im_fd = _tmp27_;
								_tmp28_ = new_im_addresses;
								_tmp29_ = im_proto;
								_tmp30_ = im_fd;
								gee_multi_map_set ((GeeMultiMap*) _tmp28_, _tmp29_, _tmp30_);
								_g_object_unref0 (im_fd);
								_g_free0 (normalised_addr);
								_g_free0 (addr);
							}
							goto __finally2;
							__catch2_folks_im_details_error:
							{
								GError* e = NULL;
								GError* _tmp31_;
								const gchar* _tmp32_;
								e = _inner_error_;
								_inner_error_ = NULL;
								_tmp31_ = e;
								_tmp32_ = _tmp31_->message;
								g_warning ("edsf-persona.vala:1660: Problem when trying to normalise address: %s\n", _tmp32_);
								_g_error_free0 (e);
							}
							__finally2:
							if (_inner_error_ != NULL) {
								__vala_EVCardAttribute_free0 (attr);
								__g_list_free___vala_EVCardAttribute_free0_0 (addresses);
								_g_list_free0 (im_proto_collection);
								_g_object_unref0 (new_im_addresses);
								_g_hash_table_unref0 (im_eds_map);
								g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
								g_clear_error (&_inner_error_);
								return;
							}
							__vala_EVCardAttribute_free0 (attr);
						}
					}
				}
				__g_list_free___vala_EVCardAttribute_free0_0 (addresses);
			}
		}
		_g_list_free0 (im_proto_collection);
	}
	{
		FolksSmallSet* _email_list = NULL;
		FolksSmallSet* _tmp33_;
		FolksSmallSet* _tmp34_;
		gint _email_size = 0;
		FolksSmallSet* _tmp35_;
		gint _tmp36_;
		gint _tmp37_;
		gint _email_index = 0;
		_tmp33_ = self->priv->_email_addresses;
		_tmp34_ = _g_object_ref0 (_tmp33_);
		_email_list = _tmp34_;
		_tmp35_ = _email_list;
		_tmp36_ = gee_collection_get_size ((GeeCollection*) _tmp35_);
		_tmp37_ = _tmp36_;
		_email_size = _tmp37_;
		_email_index = -1;
		while (TRUE) {
			gint _tmp38_;
			gint _tmp39_;
			gint _tmp40_;
			FolksEmailFieldDetails* email = NULL;
			FolksSmallSet* _tmp41_;
			gint _tmp42_;
			gconstpointer _tmp43_ = NULL;
			FolksEmailFieldDetails* _tmp44_;
			gchar* _proto = NULL;
			FolksEmailFieldDetails* _tmp45_;
			gconstpointer _tmp46_;
			const gchar* _tmp47_;
			gchar* _tmp48_ = NULL;
			const gchar* _tmp49_;
			_tmp38_ = _email_index;
			_email_index = _tmp38_ + 1;
			_tmp39_ = _email_index;
			_tmp40_ = _email_size;
			if (!(_tmp39_ < _tmp40_)) {
				break;
			}
			_tmp41_ = _email_list;
			_tmp42_ = _email_index;
			_tmp43_ = folks_small_set_get (_tmp41_, _tmp42_);
			_tmp44_ = _g_object_ref0 ((FolksEmailFieldDetails*) _tmp43_);
			email = _tmp44_;
			_tmp45_ = email;
			_tmp46_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp45_);
			_tmp47_ = _tmp46_;
			_tmp48_ = _edsf_persona_im_proto_from_addr (self, (const gchar*) _tmp47_);
			_proto = _tmp48_;
			_tmp49_ = _proto;
			if (_tmp49_ != NULL) {
				gchar* proto = NULL;
				const gchar* _tmp50_;
				gchar* _tmp51_;
				gboolean exists = FALSE;
				GeeCollection* current_im_addrs = NULL;
				GeeHashMultiMap* _tmp52_;
				const gchar* _tmp53_;
				GeeCollection* _tmp54_ = NULL;
				GeeCollection* _tmp55_;
				gboolean _tmp68_;
				_tmp50_ = _proto;
				_tmp51_ = g_strdup ((const gchar*) _tmp50_);
				proto = _tmp51_;
				exists = FALSE;
				_tmp52_ = new_im_addresses;
				_tmp53_ = proto;
				_tmp54_ = gee_multi_map_get ((GeeMultiMap*) _tmp52_, _tmp53_);
				current_im_addrs = _tmp54_;
				_tmp55_ = current_im_addrs;
				if (_tmp55_ != NULL) {
					{
						GeeIterator* _cur_im_it = NULL;
						GeeCollection* _tmp56_;
						GeeIterator* _tmp57_ = NULL;
						_tmp56_ = current_im_addrs;
						_tmp57_ = gee_iterable_iterator ((GeeIterable*) G_TYPE_CHECK_INSTANCE_CAST (_tmp56_, GEE_TYPE_COLLECTION, GeeCollection));
						_cur_im_it = _tmp57_;
						while (TRUE) {
							GeeIterator* _tmp58_;
							gboolean _tmp59_ = FALSE;
							FolksImFieldDetails* cur_im = NULL;
							GeeIterator* _tmp60_;
							gpointer _tmp61_ = NULL;
							FolksImFieldDetails* _tmp62_;
							gconstpointer _tmp63_;
							const gchar* _tmp64_;
							FolksEmailFieldDetails* _tmp65_;
							gconstpointer _tmp66_;
							const gchar* _tmp67_;
							_tmp58_ = _cur_im_it;
							_tmp59_ = gee_iterator_next (_tmp58_);
							if (!_tmp59_) {
								break;
							}
							_tmp60_ = _cur_im_it;
							_tmp61_ = gee_iterator_get (_tmp60_);
							cur_im = (FolksImFieldDetails*) _tmp61_;
							_tmp62_ = cur_im;
							_tmp63_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp62_);
							_tmp64_ = _tmp63_;
							_tmp65_ = email;
							_tmp66_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp65_);
							_tmp67_ = _tmp66_;
							if (g_strcmp0 ((const gchar*) _tmp64_, (const gchar*) _tmp67_) == 0) {
								exists = TRUE;
								_g_object_unref0 (cur_im);
								break;
							}
							_g_object_unref0 (cur_im);
						}
						_g_object_unref0 (_cur_im_it);
					}
				}
				_tmp68_ = exists;
				if (_tmp68_) {
					_g_object_unref0 (current_im_addrs);
					_g_free0 (proto);
					_g_free0 (_proto);
					_g_object_unref0 (email);
					continue;
				}
				{
					gchar* _tmp69_ = NULL;
					FolksEmailFieldDetails* _tmp70_;
					gconstpointer _tmp71_;
					const gchar* _tmp72_;
					const gchar* _tmp73_;
					gchar* _tmp74_ = NULL;
					gchar* normalised_addr = NULL;
					gchar* _tmp75_;
					gchar* _tmp76_;
					gchar* _tmp77_;
					FolksImFieldDetails* im_fd = NULL;
					const gchar* _tmp78_;
					FolksImFieldDetails* _tmp79_;
					GeeHashMultiMap* _tmp80_;
					const gchar* _tmp81_;
					FolksImFieldDetails* _tmp82_;
					_tmp70_ = email;
					_tmp71_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp70_);
					_tmp72_ = _tmp71_;
					_tmp73_ = proto;
					_tmp74_ = folks_im_details_normalise_im_address ((const gchar*) _tmp72_, _tmp73_, &_inner_error_);
					_tmp69_ = _tmp74_;
					if (_inner_error_ != NULL) {
						if (_inner_error_->domain == FOLKS_IM_DETAILS_ERROR) {
							goto __catch3_folks_im_details_error;
						}
						_g_object_unref0 (current_im_addrs);
						_g_free0 (proto);
						_g_free0 (_proto);
						_g_object_unref0 (email);
						_g_object_unref0 (_email_list);
						_g_object_unref0 (new_im_addresses);
						_g_hash_table_unref0 (im_eds_map);
						g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
						g_clear_error (&_inner_error_);
						return;
					}
					_tmp75_ = _tmp69_;
					_tmp76_ = _tmp75_;
					_tmp75_ = NULL;
					_tmp77_ = _tmp76_;
					_g_free0 (_tmp75_);
					normalised_addr = _tmp77_;
					_tmp78_ = normalised_addr;
					_tmp79_ = folks_im_field_details_new (_tmp78_, NULL);
					im_fd = _tmp79_;
					_tmp80_ = new_im_addresses;
					_tmp81_ = proto;
					_tmp82_ = im_fd;
					gee_multi_map_set ((GeeMultiMap*) _tmp80_, _tmp81_, _tmp82_);
					_g_object_unref0 (im_fd);
					_g_free0 (normalised_addr);
				}
				goto __finally3;
				__catch3_folks_im_details_error:
				{
					GError* e = NULL;
					GError* _tmp83_;
					const gchar* _tmp84_;
					e = _inner_error_;
					_inner_error_ = NULL;
					_tmp83_ = e;
					_tmp84_ = _tmp83_->message;
					g_warning ("edsf-persona.vala:1711: Problem when trying to normalise address: %s\n", _tmp84_);
					_g_error_free0 (e);
				}
				__finally3:
				if (_inner_error_ != NULL) {
					_g_object_unref0 (current_im_addrs);
					_g_free0 (proto);
					_g_free0 (_proto);
					_g_object_unref0 (email);
					_g_object_unref0 (_email_list);
					_g_object_unref0 (new_im_addresses);
					_g_hash_table_unref0 (im_eds_map);
					g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
					g_clear_error (&_inner_error_);
					return;
				}
				_g_object_unref0 (current_im_addrs);
				_g_free0 (proto);
			}
			_g_free0 (_proto);
			_g_object_unref0 (email);
		}
		_g_object_unref0 (_email_list);
	}
	_tmp85_ = new_im_addresses;
	_tmp86_ = self->priv->_im_addresses;
	_tmp87_ = folks_utils_multi_map_str_afd_equal ((GeeMultiMap*) _tmp85_, (GeeMultiMap*) _tmp86_);
	if (!_tmp87_) {
		GeeHashMultiMap* _tmp88_;
		GeeHashMultiMap* _tmp89_;
		_tmp88_ = new_im_addresses;
		_tmp89_ = _g_object_ref0 (_tmp88_);
		_g_object_unref0 (self->priv->_im_addresses);
		self->priv->_im_addresses = _tmp89_;
		g_object_notify ((GObject*) self, "im-addresses");
	}
	_g_object_unref0 (new_im_addresses);
	_g_hash_table_unref0 (im_eds_map);
}


static void _g_free0_ (gpointer var) {
	var = (g_free (var), NULL);
}


static void _g_list_free__g_free0_ (GList* self) {
	g_list_foreach (self, (GFunc) _g_free0_, NULL);
	g_list_free (self);
}


static void _edsf_persona_update_groups (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification) {
	gboolean _tmp0_ = FALSE;
	FolksSmallSet* _tmp1_;
	gboolean _tmp3_;
	GList* category_names = NULL;
	EContact* _tmp5_;
	gpointer _tmp6_ = NULL;
	FolksSmallSet* new_categories = NULL;
	FolksSmallSet* _tmp7_;
	gboolean any_added_categories = FALSE;
	GList* _tmp8_;
	gboolean any_removed_categories = FALSE;
	FolksSmallSet* _tmp24_;
	FolksSmallSet* _tmp46_;
	FolksSmallSet* _tmp47_;
	FolksSmallSet* _tmp48_;
	GeeSet* _tmp49_;
	GeeSet* _tmp50_;
	EdsfPersonaStore* store = NULL;
	FolksPersonaStore* _tmp51_;
	FolksPersonaStore* _tmp52_;
	EdsfPersonaStore* _tmp53_;
	gboolean in_google_personal_group = FALSE;
	gboolean should_notify_sysgroups = FALSE;
	EdsfPersonaStore* _tmp54_;
	gboolean _tmp55_ = FALSE;
	gboolean old_is_favourite = FALSE;
	gboolean _tmp106_;
	EdsfPersonaStore* _tmp107_;
	gboolean _tmp108_ = FALSE;
	gboolean _tmp112_ = FALSE;
	gboolean _tmp113_ = FALSE;
	gboolean _tmp114_;
	gboolean _tmp116_;
	gboolean _tmp118_;
	gboolean _tmp119_ = FALSE;
	gboolean _tmp120_;
	gboolean _tmp122_;
	gboolean _tmp123_ = FALSE;
	gboolean _tmp124_;
	gboolean _tmp125_;
	gboolean _tmp127_;
	gboolean _tmp128_;
	gboolean _tmp129_;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_groups;
	if (_tmp1_ == NULL) {
		gboolean _tmp2_;
		_tmp2_ = create_if_not_exist;
		_tmp0_ = _tmp2_ == FALSE;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp3_ = _tmp0_;
	if (_tmp3_) {
		gboolean _tmp4_;
		_tmp4_ = emit_notification;
		if (_tmp4_) {
			g_object_notify ((GObject*) self, "groups");
		}
		return;
	}
	_tmp5_ = self->priv->_contact;
	_tmp6_ = e_contact_get (_tmp5_, E_CONTACT_CATEGORY_LIST);
	category_names = (GList*) _tmp6_;
	_tmp7_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	new_categories = _tmp7_;
	any_added_categories = FALSE;
	_tmp8_ = category_names;
	{
		GList* category_name_collection = NULL;
		GList* category_name_it = NULL;
		category_name_collection = _tmp8_;
		for (category_name_it = category_name_collection; category_name_it != NULL; category_name_it = category_name_it->next) {
			gchar* _tmp9_;
			gchar* category_name = NULL;
			_tmp9_ = g_strdup ((const gchar*) category_name_it->data);
			category_name = _tmp9_;
			{
				gboolean _tmp10_ = FALSE;
				FolksPersonaStore* _tmp11_;
				FolksPersonaStore* _tmp12_;
				gboolean _tmp13_ = FALSE;
				gboolean _tmp15_;
				FolksSmallSet* _tmp16_;
				const gchar* _tmp17_;
				gboolean _tmp18_ = FALSE;
				FolksSmallSet* _tmp19_;
				gboolean _tmp23_;
				_tmp11_ = folks_persona_get_store ((FolksPersona*) self);
				_tmp12_ = _tmp11_;
				_tmp13_ = _edsf_persona_store_is_google_contacts_address_book (G_TYPE_CHECK_INSTANCE_CAST (_tmp12_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore));
				if (_tmp13_) {
					const gchar* _tmp14_;
					_tmp14_ = category_name;
					_tmp10_ = g_strcmp0 (_tmp14_, EDSF_PERSONA_STORE_android_favourite_group_name) == 0;
				} else {
					_tmp10_ = FALSE;
				}
				_tmp15_ = _tmp10_;
				if (_tmp15_) {
					_g_free0 (category_name);
					continue;
				}
				_tmp16_ = new_categories;
				_tmp17_ = category_name;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp16_, _tmp17_);
				_tmp19_ = self->priv->_groups;
				if (_tmp19_ == NULL) {
					_tmp18_ = TRUE;
				} else {
					FolksSmallSet* _tmp20_;
					const gchar* _tmp21_;
					gboolean _tmp22_ = FALSE;
					_tmp20_ = self->priv->_groups;
					_tmp21_ = category_name;
					_tmp22_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp20_, _tmp21_);
					_tmp18_ = !_tmp22_;
				}
				_tmp23_ = _tmp18_;
				if (_tmp23_) {
					any_added_categories = TRUE;
				}
				_g_free0 (category_name);
			}
		}
	}
	any_removed_categories = FALSE;
	_tmp24_ = self->priv->_groups;
	if (_tmp24_ != NULL) {
		{
			FolksSmallSet* _category_name_list = NULL;
			FolksSmallSet* _tmp25_;
			FolksSmallSet* _tmp26_;
			gint _category_name_size = 0;
			FolksSmallSet* _tmp27_;
			gint _tmp28_;
			gint _tmp29_;
			gint _category_name_index = 0;
			_tmp25_ = self->priv->_groups;
			_tmp26_ = _g_object_ref0 (_tmp25_);
			_category_name_list = _tmp26_;
			_tmp27_ = _category_name_list;
			_tmp28_ = gee_collection_get_size ((GeeCollection*) _tmp27_);
			_tmp29_ = _tmp28_;
			_category_name_size = _tmp29_;
			_category_name_index = -1;
			while (TRUE) {
				gint _tmp30_;
				gint _tmp31_;
				gint _tmp32_;
				gchar* category_name = NULL;
				FolksSmallSet* _tmp33_;
				gint _tmp34_;
				gconstpointer _tmp35_ = NULL;
				gchar* _tmp36_;
				gboolean _tmp37_ = FALSE;
				FolksPersonaStore* _tmp38_;
				FolksPersonaStore* _tmp39_;
				gboolean _tmp40_ = FALSE;
				gboolean _tmp42_;
				FolksSmallSet* _tmp43_;
				const gchar* _tmp44_;
				gboolean _tmp45_ = FALSE;
				_tmp30_ = _category_name_index;
				_category_name_index = _tmp30_ + 1;
				_tmp31_ = _category_name_index;
				_tmp32_ = _category_name_size;
				if (!(_tmp31_ < _tmp32_)) {
					break;
				}
				_tmp33_ = _category_name_list;
				_tmp34_ = _category_name_index;
				_tmp35_ = folks_small_set_get (_tmp33_, _tmp34_);
				_tmp36_ = g_strdup ((const gchar*) _tmp35_);
				category_name = _tmp36_;
				_tmp38_ = folks_persona_get_store ((FolksPersona*) self);
				_tmp39_ = _tmp38_;
				_tmp40_ = _edsf_persona_store_is_google_contacts_address_book (G_TYPE_CHECK_INSTANCE_CAST (_tmp39_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore));
				if (_tmp40_) {
					const gchar* _tmp41_;
					_tmp41_ = category_name;
					_tmp37_ = g_strcmp0 (_tmp41_, EDSF_PERSONA_STORE_android_favourite_group_name) == 0;
				} else {
					_tmp37_ = FALSE;
				}
				_tmp42_ = _tmp37_;
				if (_tmp42_) {
					_g_free0 (category_name);
					continue;
				}
				_tmp43_ = new_categories;
				_tmp44_ = category_name;
				_tmp45_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp43_, _tmp44_);
				if (!_tmp45_) {
					any_removed_categories = TRUE;
				}
				_g_free0 (category_name);
			}
			_g_object_unref0 (_category_name_list);
		}
	}
	_tmp46_ = new_categories;
	_tmp47_ = _g_object_ref0 (_tmp46_);
	_g_object_unref0 (self->priv->_groups);
	self->priv->_groups = _tmp47_;
	_tmp48_ = self->priv->_groups;
	_tmp49_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp48_);
	_tmp50_ = _tmp49_;
	_g_object_unref0 (self->priv->_groups_ro);
	self->priv->_groups_ro = _tmp50_;
	_tmp51_ = folks_persona_get_store ((FolksPersona*) self);
	_tmp52_ = _tmp51_;
	_tmp53_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp52_, EDSF_TYPE_PERSONA_STORE, EdsfPersonaStore));
	store = _tmp53_;
	in_google_personal_group = FALSE;
	should_notify_sysgroups = FALSE;
	_tmp54_ = store;
	_tmp55_ = _edsf_persona_store_is_google_contacts_address_book (_tmp54_);
	if (_tmp55_) {
		EVCard* vcard = NULL;
		EContact* _tmp56_;
		EContact* _tmp57_;
		EVCard* _tmp58_;
		EVCardAttribute* attr = NULL;
		EVCard* _tmp59_;
		EVCardAttribute* _tmp60_ = NULL;
		EVCardAttribute* _tmp61_;
		_tmp56_ = edsf_persona_get_contact (self);
		_tmp57_ = _tmp56_;
		_tmp58_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp57_, e_vcard_get_type (), EVCard));
		vcard = _tmp58_;
		_tmp59_ = vcard;
		_tmp60_ = e_vcard_get_attribute (_tmp59_, "X-GOOGLE-SYSTEM-GROUP-IDS");
		attr = _tmp60_;
		_tmp61_ = attr;
		if (_tmp61_ != NULL) {
			GList* system_group_ids = NULL;
			EVCardAttribute* _tmp62_;
			GList* _tmp63_ = NULL;
			FolksSmallSet* new_sysgroups = NULL;
			FolksSmallSet* _tmp64_;
			gboolean any_added_sysgroups = FALSE;
			GList* _tmp65_;
			gboolean any_removed_sysgroups = FALSE;
			FolksSmallSet* _tmp75_;
			FolksSmallSet* _tmp91_;
			gboolean _tmp92_ = FALSE;
			FolksSmallSet* _tmp93_;
			FolksSmallSet* _tmp94_;
			FolksSmallSet* _tmp95_;
			GeeSet* _tmp96_;
			GeeSet* _tmp97_;
			gboolean _tmp98_ = FALSE;
			gboolean _tmp99_;
			gboolean _tmp101_;
			_tmp62_ = attr;
			_tmp63_ = e_vcard_attribute_get_values (_tmp62_);
			system_group_ids = _tmp63_;
			_tmp64_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
			new_sysgroups = _tmp64_;
			any_added_sysgroups = FALSE;
			_tmp65_ = system_group_ids;
			{
				GList* system_group_id_collection = NULL;
				GList* system_group_id_it = NULL;
				system_group_id_collection = _tmp65_;
				for (system_group_id_it = system_group_id_collection; system_group_id_it != NULL; system_group_id_it = system_group_id_it->next) {
					gchar* _tmp66_;
					gchar* system_group_id = NULL;
					_tmp66_ = g_strdup ((const gchar*) system_group_id_it->data);
					system_group_id = _tmp66_;
					{
						FolksSmallSet* _tmp67_;
						const gchar* _tmp68_;
						gboolean _tmp69_ = FALSE;
						FolksSmallSet* _tmp70_;
						gboolean _tmp74_;
						_tmp67_ = new_sysgroups;
						_tmp68_ = system_group_id;
						gee_abstract_collection_add ((GeeAbstractCollection*) _tmp67_, _tmp68_);
						_tmp70_ = self->priv->_system_groups;
						if (_tmp70_ == NULL) {
							_tmp69_ = TRUE;
						} else {
							FolksSmallSet* _tmp71_;
							const gchar* _tmp72_;
							gboolean _tmp73_ = FALSE;
							_tmp71_ = self->priv->_system_groups;
							_tmp72_ = system_group_id;
							_tmp73_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp71_, _tmp72_);
							_tmp69_ = !_tmp73_;
						}
						_tmp74_ = _tmp69_;
						if (_tmp74_) {
							any_added_sysgroups = TRUE;
						}
						_g_free0 (system_group_id);
					}
				}
			}
			any_removed_sysgroups = FALSE;
			_tmp75_ = self->priv->_system_groups;
			if (_tmp75_ != NULL) {
				{
					FolksSmallSet* _system_group_id_list = NULL;
					FolksSmallSet* _tmp76_;
					FolksSmallSet* _tmp77_;
					gint _system_group_id_size = 0;
					FolksSmallSet* _tmp78_;
					gint _tmp79_;
					gint _tmp80_;
					gint _system_group_id_index = 0;
					_tmp76_ = self->priv->_system_groups;
					_tmp77_ = _g_object_ref0 (_tmp76_);
					_system_group_id_list = _tmp77_;
					_tmp78_ = _system_group_id_list;
					_tmp79_ = gee_collection_get_size ((GeeCollection*) _tmp78_);
					_tmp80_ = _tmp79_;
					_system_group_id_size = _tmp80_;
					_system_group_id_index = -1;
					while (TRUE) {
						gint _tmp81_;
						gint _tmp82_;
						gint _tmp83_;
						gchar* system_group_id = NULL;
						FolksSmallSet* _tmp84_;
						gint _tmp85_;
						gconstpointer _tmp86_ = NULL;
						gchar* _tmp87_;
						FolksSmallSet* _tmp88_;
						const gchar* _tmp89_;
						gboolean _tmp90_ = FALSE;
						_tmp81_ = _system_group_id_index;
						_system_group_id_index = _tmp81_ + 1;
						_tmp82_ = _system_group_id_index;
						_tmp83_ = _system_group_id_size;
						if (!(_tmp82_ < _tmp83_)) {
							break;
						}
						_tmp84_ = _system_group_id_list;
						_tmp85_ = _system_group_id_index;
						_tmp86_ = folks_small_set_get (_tmp84_, _tmp85_);
						_tmp87_ = g_strdup ((const gchar*) _tmp86_);
						system_group_id = _tmp87_;
						_tmp88_ = new_sysgroups;
						_tmp89_ = system_group_id;
						_tmp90_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp88_, _tmp89_);
						if (!_tmp90_) {
							any_removed_sysgroups = TRUE;
						}
						_g_free0 (system_group_id);
					}
					_g_object_unref0 (_system_group_id_list);
				}
			}
			_tmp91_ = new_sysgroups;
			_tmp92_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp91_, EDSF_PERSONA_GOOGLE_PERSONAL_GROUP_NAME);
			if (_tmp92_) {
				in_google_personal_group = TRUE;
			}
			_tmp93_ = new_sysgroups;
			_tmp94_ = _g_object_ref0 (_tmp93_);
			_g_object_unref0 (self->priv->_system_groups);
			self->priv->_system_groups = _tmp94_;
			_tmp95_ = new_sysgroups;
			_tmp96_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp95_);
			_tmp97_ = _tmp96_;
			_g_object_unref0 (self->priv->_system_groups_ro);
			self->priv->_system_groups_ro = _tmp97_;
			_tmp99_ = any_added_sysgroups;
			if (_tmp99_) {
				_tmp98_ = TRUE;
			} else {
				gboolean _tmp100_;
				_tmp100_ = any_removed_sysgroups;
				_tmp98_ = _tmp100_;
			}
			_tmp101_ = _tmp98_;
			if (_tmp101_) {
				should_notify_sysgroups = TRUE;
			}
			_g_object_unref0 (new_sysgroups);
		} else {
			FolksSmallSet* _tmp102_;
			FolksSmallSet* _tmp103_;
			GeeSet* _tmp104_;
			GeeSet* _tmp105_;
			_tmp102_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
			_g_object_unref0 (self->priv->_system_groups);
			self->priv->_system_groups = _tmp102_;
			_tmp103_ = self->priv->_system_groups;
			_tmp104_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp103_);
			_tmp105_ = _tmp104_;
			_g_object_unref0 (self->priv->_system_groups_ro);
			self->priv->_system_groups_ro = _tmp105_;
		}
		_g_object_unref0 (vcard);
	}
	_tmp106_ = self->priv->_is_favourite;
	old_is_favourite = _tmp106_;
	_tmp107_ = store;
	_tmp108_ = _edsf_persona_store_is_google_contacts_address_book (_tmp107_);
	if (_tmp108_) {
		GList* _tmp109_;
		self->priv->_is_favourite = FALSE;
		_tmp109_ = category_names;
		{
			GList* category_name_collection = NULL;
			GList* category_name_it = NULL;
			category_name_collection = _tmp109_;
			for (category_name_it = category_name_collection; category_name_it != NULL; category_name_it = category_name_it->next) {
				gchar* _tmp110_;
				gchar* category_name = NULL;
				_tmp110_ = g_strdup ((const gchar*) category_name_it->data);
				category_name = _tmp110_;
				{
					const gchar* _tmp111_;
					_tmp111_ = category_name;
					if (g_strcmp0 (_tmp111_, EDSF_PERSONA_STORE_android_favourite_group_name) == 0) {
						self->priv->_is_favourite = TRUE;
					}
					_g_free0 (category_name);
				}
			}
		}
	}
	g_object_freeze_notify ((GObject*) self);
	_tmp114_ = any_added_categories;
	if (_tmp114_) {
		_tmp113_ = TRUE;
	} else {
		gboolean _tmp115_;
		_tmp115_ = any_removed_categories;
		_tmp113_ = _tmp115_;
	}
	_tmp116_ = _tmp113_;
	if (_tmp116_) {
		gboolean _tmp117_;
		_tmp117_ = emit_notification;
		_tmp112_ = _tmp117_;
	} else {
		_tmp112_ = FALSE;
	}
	_tmp118_ = _tmp112_;
	if (_tmp118_) {
		g_object_notify ((GObject*) self, "groups");
	}
	_tmp120_ = should_notify_sysgroups;
	if (_tmp120_) {
		gboolean _tmp121_;
		_tmp121_ = emit_notification;
		_tmp119_ = _tmp121_;
	} else {
		_tmp119_ = FALSE;
	}
	_tmp122_ = _tmp119_;
	if (_tmp122_) {
		g_object_notify ((GObject*) self, "system-groups");
	}
	_tmp124_ = self->priv->_is_favourite;
	_tmp125_ = old_is_favourite;
	if (_tmp124_ != _tmp125_) {
		gboolean _tmp126_;
		_tmp126_ = emit_notification;
		_tmp123_ = _tmp126_;
	} else {
		_tmp123_ = FALSE;
	}
	_tmp127_ = _tmp123_;
	if (_tmp127_) {
		g_object_notify ((GObject*) self, "is-favourite");
	}
	_tmp128_ = in_google_personal_group;
	_tmp129_ = self->priv->_in_google_personal_group;
	if (_tmp128_ != _tmp129_) {
		gboolean _tmp130_;
		gboolean _tmp131_;
		_tmp130_ = in_google_personal_group;
		self->priv->_in_google_personal_group = _tmp130_;
		_tmp131_ = emit_notification;
		if (_tmp131_) {
			g_object_notify ((GObject*) self, "in-google-personal-group");
		}
	}
	g_object_thaw_notify ((GObject*) self);
	_g_object_unref0 (store);
	_g_object_unref0 (new_categories);
	__g_list_free__g_free0_0 (category_names);
}


/**
   * build a table of im protocols / im protocol aliases
   */
static gpointer _g_hash_table_ref0 (gpointer self) {
	return self ? g_hash_table_ref (self) : NULL;
}


GHashTable* _edsf_persona_get_im_eds_map (void) {
	GHashTable* result = NULL;
	GHashTable* retval = NULL;
	GError * _inner_error_ = NULL;
	{
		GHashTable* _tmp0_;
		_tmp0_ = edsf_persona__im_eds_map;
		g_static_rec_mutex_lock (&__lock_edsf_persona__im_eds_map);
		{
			GHashTable* _tmp1_;
			GHashTable* _tmp23_;
			GHashTable* _tmp24_;
			_tmp1_ = edsf_persona__im_eds_map;
			if (_tmp1_ == NULL) {
				GHashTable* table = NULL;
				GHashFunc _tmp2_;
				GEqualFunc _tmp3_;
				GHashTable* _tmp4_;
				GHashTable* _tmp5_;
				gchar* _tmp6_;
				GHashTable* _tmp7_;
				gchar* _tmp8_;
				GHashTable* _tmp9_;
				gchar* _tmp10_;
				GHashTable* _tmp11_;
				gchar* _tmp12_;
				GHashTable* _tmp13_;
				gchar* _tmp14_;
				GHashTable* _tmp15_;
				gchar* _tmp16_;
				GHashTable* _tmp17_;
				gchar* _tmp18_;
				GHashTable* _tmp19_;
				gchar* _tmp20_;
				GHashTable* _tmp21_;
				GHashTable* _tmp22_;
				_tmp2_ = g_str_hash;
				_tmp3_ = g_str_equal;
				_tmp4_ = g_hash_table_new_full (_tmp2_, _tmp3_, _g_free0_, NULL);
				table = _tmp4_;
				_tmp5_ = table;
				_tmp6_ = g_strdup ("aim");
				g_hash_table_insert (_tmp5_, _tmp6_, (gpointer) ((gintptr) E_CONTACT_IM_AIM));
				_tmp7_ = table;
				_tmp8_ = g_strdup ("yahoo");
				g_hash_table_insert (_tmp7_, _tmp8_, (gpointer) ((gintptr) E_CONTACT_IM_YAHOO));
				_tmp9_ = table;
				_tmp10_ = g_strdup ("groupwise");
				g_hash_table_insert (_tmp9_, _tmp10_, (gpointer) ((gintptr) E_CONTACT_IM_GROUPWISE));
				_tmp11_ = table;
				_tmp12_ = g_strdup ("jabber");
				g_hash_table_insert (_tmp11_, _tmp12_, (gpointer) ((gintptr) E_CONTACT_IM_JABBER));
				_tmp13_ = table;
				_tmp14_ = g_strdup ("msn");
				g_hash_table_insert (_tmp13_, _tmp14_, (gpointer) ((gintptr) E_CONTACT_IM_MSN));
				_tmp15_ = table;
				_tmp16_ = g_strdup ("icq");
				g_hash_table_insert (_tmp15_, _tmp16_, (gpointer) ((gintptr) E_CONTACT_IM_ICQ));
				_tmp17_ = table;
				_tmp18_ = g_strdup ("gadugadu");
				g_hash_table_insert (_tmp17_, _tmp18_, (gpointer) ((gintptr) E_CONTACT_IM_GADUGADU));
				_tmp19_ = table;
				_tmp20_ = g_strdup ("skype");
				g_hash_table_insert (_tmp19_, _tmp20_, (gpointer) ((gintptr) E_CONTACT_IM_SKYPE));
				_tmp21_ = table;
				_tmp22_ = _g_hash_table_ref0 (_tmp21_);
				_g_hash_table_unref0 (edsf_persona__im_eds_map);
				edsf_persona__im_eds_map = _tmp22_;
				_g_hash_table_unref0 (table);
			}
			_tmp23_ = edsf_persona__im_eds_map;
			_tmp24_ = _g_hash_table_ref0 ((GHashTable*) _tmp23_);
			_g_hash_table_unref0 (retval);
			retval = _tmp24_;
		}
		__finally4:
		{
			GHashTable* _tmp25_;
			_tmp25_ = edsf_persona__im_eds_map;
			g_static_rec_mutex_unlock (&__lock_edsf_persona__im_eds_map);
		}
		if (_inner_error_ != NULL) {
			_g_hash_table_unref0 (retval);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
	}
	result = retval;
	return result;
}


static void _edsf_persona_update_phones (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification) {
	gboolean _tmp0_ = FALSE;
	FolksSmallSet* _tmp1_;
	gboolean _tmp3_;
	FolksSmallSet* new_phone_numbers = NULL;
	FolksSmallSet* _tmp9_;
	GList* attrs = NULL;
	EContact* _tmp10_;
	EContact* _tmp11_;
	GList* _tmp12_ = NULL;
	GList* _tmp13_;
	FolksSmallSet* _tmp27_;
	FolksSmallSet* _tmp28_;
	gboolean _tmp29_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_phone_numbers;
	if (_tmp1_ == NULL) {
		gboolean _tmp2_;
		_tmp2_ = create_if_not_exist;
		_tmp0_ = _tmp2_ == FALSE;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp3_ = _tmp0_;
	if (_tmp3_) {
		g_object_notify ((GObject*) self, "phone-numbers");
		return;
	} else {
		FolksSmallSet* _tmp4_;
		_tmp4_ = self->priv->_phone_numbers;
		if (_tmp4_ == NULL) {
			FolksSmallSet* _tmp5_;
			FolksSmallSet* _tmp6_;
			GeeSet* _tmp7_;
			GeeSet* _tmp8_;
			_tmp5_ = folks_small_set_new (FOLKS_TYPE_PHONE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
			_g_object_unref0 (self->priv->_phone_numbers);
			self->priv->_phone_numbers = _tmp5_;
			_tmp6_ = self->priv->_phone_numbers;
			_tmp7_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp6_);
			_tmp8_ = _tmp7_;
			_g_object_unref0 (self->priv->_phone_numbers_ro);
			self->priv->_phone_numbers_ro = _tmp8_;
		}
	}
	_tmp9_ = folks_small_set_new (FOLKS_TYPE_PHONE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_phone_numbers = _tmp9_;
	_tmp10_ = edsf_persona_get_contact (self);
	_tmp11_ = _tmp10_;
	_tmp12_ = e_contact_get_attributes (_tmp11_, E_CONTACT_TEL);
	attrs = _tmp12_;
	_tmp13_ = attrs;
	{
		GList* attr_collection = NULL;
		GList* attr_it = NULL;
		attr_collection = _tmp13_;
		for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
			EVCardAttribute* _tmp14_;
			EVCardAttribute* attr = NULL;
			_tmp14_ = __vala_EVCardAttribute_copy0 ((EVCardAttribute*) attr_it->data);
			attr = _tmp14_;
			{
				gchar* val = NULL;
				EVCardAttribute* _tmp15_;
				gchar* _tmp16_ = NULL;
				gboolean _tmp17_ = FALSE;
				const gchar* _tmp18_;
				gboolean _tmp20_;
				FolksPhoneFieldDetails* phone_fd = NULL;
				const gchar* _tmp21_;
				FolksPhoneFieldDetails* _tmp22_;
				FolksPhoneFieldDetails* _tmp23_;
				EVCardAttribute* _tmp24_;
				FolksSmallSet* _tmp25_;
				FolksPhoneFieldDetails* _tmp26_;
				_tmp15_ = attr;
				_tmp16_ = e_vcard_attribute_get_value (_tmp15_);
				val = _tmp16_;
				_tmp18_ = val;
				if (_tmp18_ == NULL) {
					_tmp17_ = TRUE;
				} else {
					const gchar* _tmp19_;
					_tmp19_ = val;
					_tmp17_ = g_strcmp0 ((const gchar*) _tmp19_, "") == 0;
				}
				_tmp20_ = _tmp17_;
				if (_tmp20_) {
					_g_free0 (val);
					__vala_EVCardAttribute_free0 (attr);
					continue;
				}
				_tmp21_ = val;
				_tmp22_ = folks_phone_field_details_new ((const gchar*) _tmp21_, NULL);
				phone_fd = _tmp22_;
				_tmp23_ = phone_fd;
				_tmp24_ = attr;
				_edsf_persona_update_params (self, (FolksAbstractFieldDetails*) _tmp23_, _tmp24_);
				_tmp25_ = new_phone_numbers;
				_tmp26_ = phone_fd;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp25_, _tmp26_);
				_g_object_unref0 (phone_fd);
				_g_free0 (val);
				__vala_EVCardAttribute_free0 (attr);
			}
		}
	}
	_tmp27_ = new_phone_numbers;
	_tmp28_ = self->priv->_phone_numbers;
	_tmp29_ = folks_internal_equal_sets (FOLKS_TYPE_PHONE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, (GeeSet*) _tmp27_, (GeeSet*) _tmp28_);
	if (!_tmp29_) {
		FolksSmallSet* _tmp30_;
		FolksSmallSet* _tmp31_;
		FolksSmallSet* _tmp32_;
		GeeSet* _tmp33_;
		GeeSet* _tmp34_;
		gboolean _tmp35_;
		_tmp30_ = new_phone_numbers;
		_tmp31_ = _g_object_ref0 (_tmp30_);
		_g_object_unref0 (self->priv->_phone_numbers);
		self->priv->_phone_numbers = _tmp31_;
		_tmp32_ = new_phone_numbers;
		_tmp33_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp32_);
		_tmp34_ = _tmp33_;
		_g_object_unref0 (self->priv->_phone_numbers_ro);
		self->priv->_phone_numbers_ro = _tmp34_;
		_tmp35_ = emit_notification;
		if (_tmp35_) {
			g_object_notify ((GObject*) self, "phone-numbers");
		}
	}
	__g_list_free___vala_EVCardAttribute_free0_0 (attrs);
	_g_object_unref0 (new_phone_numbers);
}


static FolksPostalAddress* _edsf_persona_postal_address_from_attribute (EdsfPersona* self, EVCardAttribute* attr) {
	FolksPostalAddress* result = NULL;
	GList* values = NULL;
	EVCardAttribute* _tmp0_;
	GList* _tmp1_ = NULL;
	GList* l = NULL;
	GList* _tmp2_;
	gchar* address_format = NULL;
	gchar* _tmp3_;
	gchar* po_box = NULL;
	gchar* _tmp4_;
	gchar* extension = NULL;
	gchar* _tmp5_;
	gchar* street = NULL;
	gchar* _tmp6_;
	gchar* locality = NULL;
	gchar* _tmp7_;
	gchar* region = NULL;
	gchar* _tmp8_;
	gchar* postal_code = NULL;
	gchar* _tmp9_;
	gchar* country = NULL;
	gchar* _tmp10_;
	GList* _tmp11_;
	GList* _tmp17_;
	GList* _tmp23_;
	GList* _tmp29_;
	GList* _tmp35_;
	GList* _tmp41_;
	GList* _tmp47_;
	const gchar* _tmp53_;
	const gchar* _tmp54_;
	const gchar* _tmp55_;
	const gchar* _tmp56_;
	const gchar* _tmp57_;
	const gchar* _tmp58_;
	const gchar* _tmp59_;
	const gchar* _tmp60_;
	FolksPostalAddress* _tmp61_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (attr != NULL, NULL);
	_tmp0_ = attr;
	_tmp1_ = e_vcard_attribute_get_values (_tmp0_);
	values = _tmp1_;
	_tmp2_ = values;
	l = _tmp2_;
	_tmp3_ = g_strdup ("");
	address_format = _tmp3_;
	_tmp4_ = g_strdup ("");
	po_box = _tmp4_;
	_tmp5_ = g_strdup ("");
	extension = _tmp5_;
	_tmp6_ = g_strdup ("");
	street = _tmp6_;
	_tmp7_ = g_strdup ("");
	locality = _tmp7_;
	_tmp8_ = g_strdup ("");
	region = _tmp8_;
	_tmp9_ = g_strdup ("");
	postal_code = _tmp9_;
	_tmp10_ = g_strdup ("");
	country = _tmp10_;
	_tmp11_ = l;
	if (_tmp11_ != NULL) {
		GList* _tmp12_;
		gconstpointer _tmp13_;
		gchar* _tmp14_;
		GList* _tmp15_;
		GList* _tmp16_;
		_tmp12_ = l;
		_tmp13_ = ((GList*) _tmp12_)->data;
		_tmp14_ = g_strdup ((const gchar*) _tmp13_);
		_g_free0 (po_box);
		po_box = _tmp14_;
		_tmp15_ = l;
		_tmp16_ = ((GList*) _tmp15_)->next;
		l = _tmp16_;
	}
	_tmp17_ = l;
	if (_tmp17_ != NULL) {
		GList* _tmp18_;
		gconstpointer _tmp19_;
		gchar* _tmp20_;
		GList* _tmp21_;
		GList* _tmp22_;
		_tmp18_ = l;
		_tmp19_ = ((GList*) _tmp18_)->data;
		_tmp20_ = g_strdup ((const gchar*) _tmp19_);
		_g_free0 (extension);
		extension = _tmp20_;
		_tmp21_ = l;
		_tmp22_ = ((GList*) _tmp21_)->next;
		l = _tmp22_;
	}
	_tmp23_ = l;
	if (_tmp23_ != NULL) {
		GList* _tmp24_;
		gconstpointer _tmp25_;
		gchar* _tmp26_;
		GList* _tmp27_;
		GList* _tmp28_;
		_tmp24_ = l;
		_tmp25_ = ((GList*) _tmp24_)->data;
		_tmp26_ = g_strdup ((const gchar*) _tmp25_);
		_g_free0 (street);
		street = _tmp26_;
		_tmp27_ = l;
		_tmp28_ = ((GList*) _tmp27_)->next;
		l = _tmp28_;
	}
	_tmp29_ = l;
	if (_tmp29_ != NULL) {
		GList* _tmp30_;
		gconstpointer _tmp31_;
		gchar* _tmp32_;
		GList* _tmp33_;
		GList* _tmp34_;
		_tmp30_ = l;
		_tmp31_ = ((GList*) _tmp30_)->data;
		_tmp32_ = g_strdup ((const gchar*) _tmp31_);
		_g_free0 (locality);
		locality = _tmp32_;
		_tmp33_ = l;
		_tmp34_ = ((GList*) _tmp33_)->next;
		l = _tmp34_;
	}
	_tmp35_ = l;
	if (_tmp35_ != NULL) {
		GList* _tmp36_;
		gconstpointer _tmp37_;
		gchar* _tmp38_;
		GList* _tmp39_;
		GList* _tmp40_;
		_tmp36_ = l;
		_tmp37_ = ((GList*) _tmp36_)->data;
		_tmp38_ = g_strdup ((const gchar*) _tmp37_);
		_g_free0 (region);
		region = _tmp38_;
		_tmp39_ = l;
		_tmp40_ = ((GList*) _tmp39_)->next;
		l = _tmp40_;
	}
	_tmp41_ = l;
	if (_tmp41_ != NULL) {
		GList* _tmp42_;
		gconstpointer _tmp43_;
		gchar* _tmp44_;
		GList* _tmp45_;
		GList* _tmp46_;
		_tmp42_ = l;
		_tmp43_ = ((GList*) _tmp42_)->data;
		_tmp44_ = g_strdup ((const gchar*) _tmp43_);
		_g_free0 (postal_code);
		postal_code = _tmp44_;
		_tmp45_ = l;
		_tmp46_ = ((GList*) _tmp45_)->next;
		l = _tmp46_;
	}
	_tmp47_ = l;
	if (_tmp47_ != NULL) {
		GList* _tmp48_;
		gconstpointer _tmp49_;
		gchar* _tmp50_;
		GList* _tmp51_;
		GList* _tmp52_;
		_tmp48_ = l;
		_tmp49_ = ((GList*) _tmp48_)->data;
		_tmp50_ = g_strdup ((const gchar*) _tmp49_);
		_g_free0 (country);
		country = _tmp50_;
		_tmp51_ = l;
		_tmp52_ = ((GList*) _tmp51_)->next;
		l = _tmp52_;
	}
	_tmp53_ = po_box;
	_tmp54_ = extension;
	_tmp55_ = street;
	_tmp56_ = locality;
	_tmp57_ = region;
	_tmp58_ = postal_code;
	_tmp59_ = country;
	_tmp60_ = address_format;
	_tmp61_ = folks_postal_address_new (_tmp53_, _tmp54_, _tmp55_, _tmp56_, _tmp57_, _tmp58_, _tmp59_, _tmp60_, NULL);
	result = _tmp61_;
	_g_free0 (country);
	_g_free0 (postal_code);
	_g_free0 (region);
	_g_free0 (locality);
	_g_free0 (street);
	_g_free0 (extension);
	_g_free0 (po_box);
	_g_free0 (address_format);
	return result;
}


static void _edsf_persona_update_addresses (EdsfPersona* self, gboolean create_if_not_exist, gboolean emit_notification) {
	gboolean _tmp0_ = FALSE;
	FolksSmallSet* _tmp1_;
	gboolean _tmp3_;
	FolksSmallSet* new_postal_addresses = NULL;
	FolksSmallSet* _tmp10_;
	GList* attrs = NULL;
	EContact* _tmp11_;
	EContact* _tmp12_;
	GList* _tmp13_ = NULL;
	GList* _tmp14_;
	FolksSmallSet* _tmp25_;
	FolksSmallSet* _tmp26_;
	gboolean _tmp27_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_postal_addresses;
	if (_tmp1_ == NULL) {
		gboolean _tmp2_;
		_tmp2_ = create_if_not_exist;
		_tmp0_ = _tmp2_ == FALSE;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp3_ = _tmp0_;
	if (_tmp3_) {
		gboolean _tmp4_;
		_tmp4_ = emit_notification;
		if (_tmp4_) {
			g_object_notify ((GObject*) self, "postal-addresses");
		}
		return;
	} else {
		FolksSmallSet* _tmp5_;
		_tmp5_ = self->priv->_postal_addresses;
		if (_tmp5_ == NULL) {
			FolksSmallSet* _tmp6_;
			FolksSmallSet* _tmp7_;
			GeeSet* _tmp8_;
			GeeSet* _tmp9_;
			_tmp6_ = folks_small_set_new (FOLKS_TYPE_POSTAL_ADDRESS_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
			_g_object_unref0 (self->priv->_postal_addresses);
			self->priv->_postal_addresses = _tmp6_;
			_tmp7_ = self->priv->_postal_addresses;
			_tmp8_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp7_);
			_tmp9_ = _tmp8_;
			_g_object_unref0 (self->priv->_postal_addresses_ro);
			self->priv->_postal_addresses_ro = _tmp9_;
		}
	}
	_tmp10_ = folks_small_set_new (FOLKS_TYPE_POSTAL_ADDRESS_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	new_postal_addresses = _tmp10_;
	_tmp11_ = edsf_persona_get_contact (self);
	_tmp12_ = _tmp11_;
	_tmp13_ = e_contact_get_attributes (_tmp12_, E_CONTACT_ADDRESS);
	attrs = _tmp13_;
	_tmp14_ = attrs;
	{
		GList* attr_collection = NULL;
		GList* attr_it = NULL;
		attr_collection = _tmp14_;
		for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
			EVCardAttribute* attr = NULL;
			attr = (EVCardAttribute*) attr_it->data;
			{
				FolksPostalAddress* address = NULL;
				EVCardAttribute* _tmp15_;
				FolksPostalAddress* _tmp16_ = NULL;
				FolksPostalAddress* _tmp17_;
				gboolean _tmp18_ = FALSE;
				FolksPostalAddressFieldDetails* pa_fd = NULL;
				FolksPostalAddress* _tmp19_;
				FolksPostalAddressFieldDetails* _tmp20_;
				FolksPostalAddressFieldDetails* _tmp21_;
				EVCardAttribute* _tmp22_;
				FolksSmallSet* _tmp23_;
				FolksPostalAddressFieldDetails* _tmp24_;
				_tmp15_ = attr;
				_tmp16_ = _edsf_persona_postal_address_from_attribute (self, _tmp15_);
				address = _tmp16_;
				_tmp17_ = address;
				_tmp18_ = folks_postal_address_is_empty (_tmp17_);
				if (_tmp18_) {
					_g_object_unref0 (address);
					continue;
				}
				_tmp19_ = address;
				_tmp20_ = folks_postal_address_field_details_new (_tmp19_, NULL);
				pa_fd = _tmp20_;
				_tmp21_ = pa_fd;
				_tmp22_ = attr;
				_edsf_persona_update_params (self, (FolksAbstractFieldDetails*) _tmp21_, _tmp22_);
				_tmp23_ = new_postal_addresses;
				_tmp24_ = pa_fd;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp23_, _tmp24_);
				_g_object_unref0 (pa_fd);
				_g_object_unref0 (address);
			}
		}
	}
	_tmp25_ = new_postal_addresses;
	_tmp26_ = self->priv->_postal_addresses;
	_tmp27_ = folks_internal_equal_sets (FOLKS_TYPE_POSTAL_ADDRESS_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, (GeeSet*) _tmp25_, (GeeSet*) _tmp26_);
	if (!_tmp27_) {
		FolksSmallSet* _tmp28_;
		FolksSmallSet* _tmp29_;
		FolksSmallSet* _tmp30_;
		GeeSet* _tmp31_;
		GeeSet* _tmp32_;
		gboolean _tmp33_;
		_tmp28_ = new_postal_addresses;
		_tmp29_ = _g_object_ref0 (_tmp28_);
		_g_object_unref0 (self->priv->_postal_addresses);
		self->priv->_postal_addresses = _tmp29_;
		_tmp30_ = new_postal_addresses;
		_tmp31_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp30_);
		_tmp32_ = _tmp31_;
		_g_object_unref0 (self->priv->_postal_addresses_ro);
		self->priv->_postal_addresses_ro = _tmp32_;
		_tmp33_ = emit_notification;
		if (_tmp33_) {
			g_object_notify ((GObject*) self, "postal-addresses");
		}
	}
	__g_list_free___vala_EVCardAttribute_free0_0 (attrs);
	_g_object_unref0 (new_postal_addresses);
}


static void _edsf_persona_update_local_ids (EdsfPersona* self) {
	FolksSmallSet* new_local_ids = NULL;
	FolksSmallSet* _tmp0_;
	EVCardAttribute* ids = NULL;
	EContact* _tmp1_;
	EContact* _tmp2_;
	EVCardAttribute* _tmp3_ = NULL;
	EVCardAttribute* _tmp4_;
	EVCardAttribute* _tmp5_;
	FolksSmallSet* _tmp13_;
	const gchar* _tmp14_;
	const gchar* _tmp15_;
	FolksSmallSet* _tmp16_;
	GeeSet* _tmp17_;
	GeeSet* _tmp18_;
	gboolean _tmp19_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	new_local_ids = _tmp0_;
	_tmp1_ = edsf_persona_get_contact (self);
	_tmp2_ = _tmp1_;
	_tmp3_ = e_vcard_get_attribute ((EVCard*) _tmp2_, "X-FOLKS-CONTACTS-IDS");
	_tmp4_ = __vala_EVCardAttribute_copy0 (_tmp3_);
	ids = _tmp4_;
	_tmp5_ = ids;
	if (_tmp5_ != NULL) {
		GList* ids_v = NULL;
		EVCardAttribute* _tmp6_;
		GList* _tmp7_ = NULL;
		GList* _tmp8_;
		_tmp6_ = ids;
		_tmp7_ = e_vcard_attribute_get_values ((EVCardAttribute*) _tmp6_);
		ids_v = _tmp7_;
		_tmp8_ = ids_v;
		{
			GList* local_id_collection = NULL;
			GList* local_id_it = NULL;
			local_id_collection = _tmp8_;
			for (local_id_it = local_id_collection; local_id_it != NULL; local_id_it = local_id_it->next) {
				gchar* _tmp9_;
				gchar* local_id = NULL;
				_tmp9_ = g_strdup ((const gchar*) local_id_it->data);
				local_id = _tmp9_;
				{
					const gchar* _tmp10_;
					_tmp10_ = local_id;
					if (g_strcmp0 (_tmp10_, "") != 0) {
						FolksSmallSet* _tmp11_;
						const gchar* _tmp12_;
						_tmp11_ = new_local_ids;
						_tmp12_ = local_id;
						gee_abstract_collection_add ((GeeAbstractCollection*) _tmp11_, _tmp12_);
					}
					_g_free0 (local_id);
				}
			}
		}
	}
	_tmp13_ = new_local_ids;
	_tmp14_ = folks_persona_get_iid ((FolksPersona*) self);
	_tmp15_ = _tmp14_;
	gee_abstract_collection_add ((GeeAbstractCollection*) _tmp13_, _tmp15_);
	_tmp16_ = new_local_ids;
	_tmp17_ = folks_local_id_details_get_local_ids ((FolksLocalIdDetails*) self);
	_tmp18_ = _tmp17_;
	_tmp19_ = folks_internal_equal_sets (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, (GeeSet*) _tmp16_, _tmp18_);
	if (!_tmp19_) {
		FolksSmallSet* _tmp20_;
		FolksSmallSet* _tmp21_;
		FolksSmallSet* _tmp22_;
		GeeSet* _tmp23_;
		GeeSet* _tmp24_;
		_tmp20_ = new_local_ids;
		_tmp21_ = _g_object_ref0 (_tmp20_);
		_g_object_unref0 (self->priv->_local_ids);
		self->priv->_local_ids = _tmp21_;
		_tmp22_ = self->priv->_local_ids;
		_tmp23_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp22_);
		_tmp24_ = _tmp23_;
		_g_object_unref0 (self->priv->_local_ids_ro);
		self->priv->_local_ids_ro = _tmp24_;
		g_object_notify ((GObject*) self, "local-ids");
	}
	__vala_EVCardAttribute_free0 (ids);
	_g_object_unref0 (new_local_ids);
}


static EContactGeo* _vala_EContactGeo_copy (EContactGeo* self) {
	return g_boxed_copy (e_contact_geo_get_type (), self);
}


static void _vala_EContactGeo_free (EContactGeo* self) {
	g_boxed_free (e_contact_geo_get_type (), self);
}


static void _edsf_persona_update_location (EdsfPersona* self) {
	EContactGeo* _geo = NULL;
	gpointer _tmp0_ = NULL;
	EContactGeo* _tmp1_;
	g_return_if_fail (self != NULL);
	_tmp0_ = _edsf_persona_get_property (self, e_contact_geo_get_type (), (GBoxedCopyFunc) _vala_EContactGeo_copy, _vala_EContactGeo_free, "geo");
	_geo = (EContactGeo*) _tmp0_;
	_tmp1_ = _geo;
	if (_tmp1_ != NULL) {
		gboolean _tmp2_ = FALSE;
		FolksLocation* _tmp3_;
		gboolean _tmp10_;
		_tmp3_ = self->priv->_location;
		if (_tmp3_ == NULL) {
			_tmp2_ = TRUE;
		} else {
			FolksLocation* _tmp4_;
			EContactGeo* _tmp5_;
			gdouble _tmp6_;
			EContactGeo* _tmp7_;
			gdouble _tmp8_;
			gboolean _tmp9_ = FALSE;
			_tmp4_ = self->priv->_location;
			_tmp5_ = _geo;
			_tmp6_ = _tmp5_->latitude;
			_tmp7_ = _geo;
			_tmp8_ = _tmp7_->longitude;
			_tmp9_ = folks_location_equal_coordinates (_tmp4_, _tmp6_, _tmp8_);
			_tmp2_ = !_tmp9_;
		}
		_tmp10_ = _tmp2_;
		if (_tmp10_) {
			FolksLocation* _tmp11_;
			_tmp11_ = self->priv->_location;
			if (_tmp11_ != NULL) {
				FolksLocation* _tmp12_;
				EContactGeo* _tmp13_;
				gdouble _tmp14_;
				FolksLocation* _tmp15_;
				EContactGeo* _tmp16_;
				gdouble _tmp17_;
				_tmp12_ = self->priv->_location;
				_tmp13_ = _geo;
				_tmp14_ = _tmp13_->latitude;
				_tmp12_->latitude = _tmp14_;
				_tmp15_ = self->priv->_location;
				_tmp16_ = _geo;
				_tmp17_ = _tmp16_->longitude;
				_tmp15_->longitude = _tmp17_;
			} else {
				EContactGeo* _tmp18_;
				gdouble _tmp19_;
				EContactGeo* _tmp20_;
				gdouble _tmp21_;
				FolksLocation* _tmp22_;
				_tmp18_ = _geo;
				_tmp19_ = _tmp18_->latitude;
				_tmp20_ = _geo;
				_tmp21_ = _tmp20_->longitude;
				_tmp22_ = folks_location_new (_tmp19_, _tmp21_);
				_g_object_unref0 (self->priv->_location);
				self->priv->_location = _tmp22_;
			}
			g_object_notify ((GObject*) self, "location");
		}
	} else {
		FolksLocation* _tmp23_;
		_tmp23_ = self->priv->_location;
		if (_tmp23_ != NULL) {
			_g_object_unref0 (self->priv->_location);
			self->priv->_location = NULL;
			g_object_notify ((GObject*) self, "location");
		}
	}
	__vala_EContactGeo_free0 (_geo);
}


static void _edsf_persona_update_favourite (EdsfPersona* self) {
	gboolean is_fav = FALSE;
	EVCardAttribute* fav = NULL;
	EContact* _tmp0_;
	EContact* _tmp1_;
	EVCardAttribute* _tmp2_ = NULL;
	EVCardAttribute* _tmp3_;
	EVCardAttribute* _tmp4_;
	gboolean _tmp13_;
	gboolean _tmp14_;
	g_return_if_fail (self != NULL);
	is_fav = FALSE;
	_tmp0_ = edsf_persona_get_contact (self);
	_tmp1_ = _tmp0_;
	_tmp2_ = e_vcard_get_attribute ((EVCard*) _tmp1_, "X-FOLKS-FAVOURITE");
	_tmp3_ = __vala_EVCardAttribute_copy0 (_tmp2_);
	fav = _tmp3_;
	_tmp4_ = fav;
	if (_tmp4_ != NULL) {
		gchar* val = NULL;
		EVCardAttribute* _tmp5_;
		gchar* _tmp6_ = NULL;
		gboolean _tmp7_ = FALSE;
		const gchar* _tmp8_;
		gboolean _tmp12_;
		_tmp5_ = fav;
		_tmp6_ = e_vcard_attribute_get_value ((EVCardAttribute*) _tmp5_);
		val = _tmp6_;
		_tmp8_ = val;
		if (_tmp8_ != NULL) {
			const gchar* _tmp9_;
			gchar* _tmp10_ = NULL;
			gchar* _tmp11_;
			_tmp9_ = val;
			_tmp10_ = g_utf8_strdown ((const gchar*) _tmp9_, (gssize) (-1));
			_tmp11_ = _tmp10_;
			_tmp7_ = g_strcmp0 (_tmp11_, "true") == 0;
			_g_free0 (_tmp11_);
		} else {
			_tmp7_ = FALSE;
		}
		_tmp12_ = _tmp7_;
		if (_tmp12_) {
			is_fav = TRUE;
		}
		_g_free0 (val);
	}
	_tmp13_ = is_fav;
	_tmp14_ = self->priv->_is_favourite;
	if (_tmp13_ != _tmp14_) {
		gboolean _tmp15_;
		_tmp15_ = is_fav;
		self->priv->_is_favourite = _tmp15_;
		g_object_notify ((GObject*) self, "is-favourite");
	}
	__vala_EVCardAttribute_free0 (fav);
}


static void _edsf_persona_update_anti_links (EdsfPersona* self) {
	FolksSmallSet* new_anti_links = NULL;
	FolksSmallSet* _tmp0_;
	EVCard* vcard = NULL;
	EContact* _tmp1_;
	EContact* _tmp2_;
	EVCard* _tmp3_;
	EVCard* _tmp4_;
	GList* _tmp5_ = NULL;
	FolksSmallSet* _tmp16_;
	FolksSmallSet* _tmp17_;
	gboolean _tmp18_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	new_anti_links = _tmp0_;
	_tmp1_ = edsf_persona_get_contact (self);
	_tmp2_ = _tmp1_;
	_tmp3_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp2_, e_vcard_get_type (), EVCard));
	vcard = _tmp3_;
	_tmp4_ = vcard;
	_tmp5_ = e_vcard_get_attributes (_tmp4_);
	{
		GList* attr_collection = NULL;
		GList* attr_it = NULL;
		attr_collection = _tmp5_;
		for (attr_it = attr_collection; attr_it != NULL; attr_it = attr_it->next) {
			EVCardAttribute* attr = NULL;
			attr = (EVCardAttribute*) attr_it->data;
			{
				EVCardAttribute* _tmp6_;
				const gchar* _tmp7_ = NULL;
				gchar* val = NULL;
				EVCardAttribute* _tmp8_;
				gchar* _tmp9_ = NULL;
				gboolean _tmp10_ = FALSE;
				const gchar* _tmp11_;
				gboolean _tmp13_;
				FolksSmallSet* _tmp14_;
				const gchar* _tmp15_;
				_tmp6_ = attr;
				_tmp7_ = e_vcard_attribute_get_name (_tmp6_);
				if (g_strcmp0 (_tmp7_, EDSF_PERSONA_STORE_anti_links_attribute_name) != 0) {
					continue;
				}
				_tmp8_ = attr;
				_tmp9_ = e_vcard_attribute_get_value (_tmp8_);
				val = _tmp9_;
				_tmp11_ = val;
				if (_tmp11_ == NULL) {
					_tmp10_ = TRUE;
				} else {
					const gchar* _tmp12_;
					_tmp12_ = val;
					_tmp10_ = g_strcmp0 ((const gchar*) _tmp12_, "") == 0;
				}
				_tmp13_ = _tmp10_;
				if (_tmp13_) {
					_g_free0 (val);
					continue;
				}
				_tmp14_ = new_anti_links;
				_tmp15_ = val;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp14_, (const gchar*) _tmp15_);
				_g_free0 (val);
			}
		}
	}
	_tmp16_ = new_anti_links;
	_tmp17_ = self->priv->_anti_links;
	_tmp18_ = folks_internal_equal_sets (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, (GeeSet*) _tmp16_, (GeeSet*) _tmp17_);
	if (!_tmp18_) {
		FolksSmallSet* _tmp19_;
		FolksSmallSet* _tmp20_;
		FolksSmallSet* _tmp21_;
		GeeSet* _tmp22_;
		GeeSet* _tmp23_;
		_tmp19_ = new_anti_links;
		_tmp20_ = _g_object_ref0 (_tmp19_);
		_g_object_unref0 (self->priv->_anti_links);
		self->priv->_anti_links = _tmp20_;
		_tmp21_ = new_anti_links;
		_tmp22_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp21_);
		_tmp23_ = _tmp22_;
		_g_object_unref0 (self->priv->_anti_links_ro);
		self->priv->_anti_links_ro = _tmp23_;
		g_object_notify ((GObject*) self, "anti-links");
	}
	_g_object_unref0 (vcard);
	_g_object_unref0 (new_anti_links);
}


gpointer _edsf_persona_get_property_from_contact (GType t_type, GBoxedCopyFunc t_dup_func, GDestroyNotify t_destroy_func, EContact* contact, const gchar* prop_name) {
	gpointer result = NULL;
	gpointer prop_value = NULL;
	EContact* _tmp0_;
	const gchar* _tmp1_;
	EContactField _tmp2_ = 0;
	gpointer _tmp3_ = NULL;
	g_return_val_if_fail (contact != NULL, NULL);
	g_return_val_if_fail (prop_name != NULL, NULL);
	prop_value = NULL;
	_tmp0_ = contact;
	_tmp1_ = prop_name;
	_tmp2_ = e_contact_field_id (_tmp1_);
	_tmp3_ = e_contact_get (_tmp0_, _tmp2_);
	_t_destroy_func0 (prop_value);
	prop_value = _tmp3_;
	result = prop_value;
	return result;
}


static gpointer _edsf_persona_get_property (EdsfPersona* self, GType t_type, GBoxedCopyFunc t_dup_func, GDestroyNotify t_destroy_func, const gchar* prop_name) {
	gpointer result = NULL;
	EContact* _tmp0_;
	EContact* _tmp1_;
	const gchar* _tmp2_;
	gpointer _tmp3_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (prop_name != NULL, NULL);
	_tmp0_ = edsf_persona_get_contact (self);
	_tmp1_ = _tmp0_;
	_tmp2_ = prop_name;
	_tmp3_ = _edsf_persona_get_property_from_contact (t_type, (GBoxedCopyFunc) t_dup_func, t_destroy_func, _tmp1_, _tmp2_);
	result = _tmp3_;
	return result;
}


static gint string_index_of (const gchar* self, const gchar* needle, gint start_index) {
	gint result = 0;
	gchar* _result_ = NULL;
	gint _tmp0_;
	const gchar* _tmp1_;
	gchar* _tmp2_ = NULL;
	gchar* _tmp3_;
	g_return_val_if_fail (self != NULL, 0);
	g_return_val_if_fail (needle != NULL, 0);
	_tmp0_ = start_index;
	_tmp1_ = needle;
	_tmp2_ = strstr (((gchar*) self) + _tmp0_, (gchar*) _tmp1_);
	_result_ = _tmp2_;
	_tmp3_ = _result_;
	if (_tmp3_ != NULL) {
		gchar* _tmp4_;
		_tmp4_ = _result_;
		result = (gint) (_tmp4_ - ((gchar*) self));
		return result;
	} else {
		result = -1;
		return result;
	}
}


static gchar* _edsf_persona_im_proto_from_addr (EdsfPersona* self, const gchar* addr) {
	gchar* result = NULL;
	const gchar* _tmp0_;
	gint _tmp1_ = 0;
	gchar** tokens = NULL;
	const gchar* _tmp2_;
	gchar** _tmp3_;
	gchar** _tmp4_ = NULL;
	gint tokens_length1;
	gint _tokens_size_;
	gchar** _tmp5_;
	gint _tmp5__length1;
	gchar* domain = NULL;
	gchar** _tmp6_;
	gint _tmp6__length1;
	const gchar* _tmp7_;
	gchar* _tmp8_;
	const gchar* _tmp9_;
	gint _tmp10_ = 0;
	const gchar* _tmp11_;
	gchar** _tmp12_;
	gchar** _tmp13_ = NULL;
	gchar** _tmp14_;
	gint _tmp14__length1;
	gchar** _tmp15_;
	gint _tmp15__length1;
	const gchar* _tmp16_;
	gchar* _tmp17_;
	gboolean _tmp18_ = FALSE;
	gboolean _tmp19_ = FALSE;
	const gchar* _tmp20_;
	gboolean _tmp22_;
	gboolean _tmp24_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (addr != NULL, NULL);
	_tmp0_ = addr;
	_tmp1_ = string_index_of (_tmp0_, "@", 0);
	if (_tmp1_ == (-1)) {
		result = NULL;
		return result;
	}
	_tmp2_ = addr;
	_tmp4_ = _tmp3_ = g_strsplit (_tmp2_, "@", 2);
	tokens = _tmp4_;
	tokens_length1 = _vala_array_length (_tmp3_);
	_tokens_size_ = tokens_length1;
	_tmp5_ = tokens;
	_tmp5__length1 = tokens_length1;
	if (_tmp5__length1 != 2) {
		result = NULL;
		tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
		return result;
	}
	_tmp6_ = tokens;
	_tmp6__length1 = tokens_length1;
	_tmp7_ = _tmp6_[1];
	_tmp8_ = g_strdup (_tmp7_);
	domain = _tmp8_;
	_tmp9_ = domain;
	_tmp10_ = string_index_of (_tmp9_, ".", 0);
	if (_tmp10_ == (-1)) {
		result = NULL;
		_g_free0 (domain);
		tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
		return result;
	}
	_tmp11_ = domain;
	_tmp13_ = _tmp12_ = g_strsplit (_tmp11_, ".", 2);
	tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
	tokens = _tmp13_;
	tokens_length1 = _vala_array_length (_tmp12_);
	_tokens_size_ = tokens_length1;
	_tmp14_ = tokens;
	_tmp14__length1 = tokens_length1;
	if (_tmp14__length1 != 2) {
		result = NULL;
		_g_free0 (domain);
		tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
		return result;
	}
	_tmp15_ = tokens;
	_tmp15__length1 = tokens_length1;
	_tmp16_ = _tmp15_[0];
	_tmp17_ = g_strdup (_tmp16_);
	_g_free0 (domain);
	domain = _tmp17_;
	_tmp20_ = domain;
	if (g_strcmp0 (_tmp20_, "msn") == 0) {
		_tmp19_ = TRUE;
	} else {
		const gchar* _tmp21_;
		_tmp21_ = domain;
		_tmp19_ = g_strcmp0 (_tmp21_, "hotmail") == 0;
	}
	_tmp22_ = _tmp19_;
	if (_tmp22_) {
		_tmp18_ = TRUE;
	} else {
		const gchar* _tmp23_;
		_tmp23_ = domain;
		_tmp18_ = g_strcmp0 (_tmp23_, "live") == 0;
	}
	_tmp24_ = _tmp18_;
	if (_tmp24_) {
		gchar* _tmp25_;
		_tmp25_ = g_strdup ("msn");
		result = _tmp25_;
		_g_free0 (domain);
		tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
		return result;
	} else {
		gboolean _tmp26_ = FALSE;
		const gchar* _tmp27_;
		gboolean _tmp29_;
		_tmp27_ = domain;
		if (g_strcmp0 (_tmp27_, "gmail") == 0) {
			_tmp26_ = TRUE;
		} else {
			const gchar* _tmp28_;
			_tmp28_ = domain;
			_tmp26_ = g_strcmp0 (_tmp28_, "googlemail") == 0;
		}
		_tmp29_ = _tmp26_;
		if (_tmp29_) {
			gchar* _tmp30_;
			_tmp30_ = g_strdup ("jabber");
			result = _tmp30_;
			_g_free0 (domain);
			tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
			return result;
		} else {
			const gchar* _tmp31_;
			_tmp31_ = domain;
			if (g_strcmp0 (_tmp31_, "yahoo") == 0) {
				gchar* _tmp32_;
				_tmp32_ = g_strdup ("yahoo");
				result = _tmp32_;
				_g_free0 (domain);
				tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
				return result;
			}
		}
	}
	result = NULL;
	_g_free0 (domain);
	tokens = (_vala_array_free (tokens, tokens_length1, (GDestroyNotify) g_free), NULL);
	return result;
}


EContact* edsf_persona_get_contact (EdsfPersona* self) {
	EContact* result;
	EContact* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_contact;
	result = _tmp0_;
	return result;
}


static void edsf_persona_set_contact (EdsfPersona* self, EContact* value) {
	EContact* _tmp0_;
	EContact* _tmp1_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_contact);
	self->priv->_contact = _tmp1_;
	g_object_notify ((GObject *) self, "contact");
}


static GeeMultiMap* edsf_persona_real_get_web_service_addresses (FolksWebServiceDetails* base) {
	GeeMultiMap* result;
	EdsfPersona* self;
	GeeHashMultiMap* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_web_service_addresses;
	result = (GeeMultiMap*) _tmp0_;
	return result;
}


static void edsf_persona_real_set_web_service_addresses (FolksWebServiceDetails* base, GeeMultiMap* value) {
	EdsfPersona* self;
	GeeMultiMap* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_web_service_details_change_web_service_addresses ((FolksWebServiceDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_local_ids (FolksLocalIdDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	FolksSmallSet* _tmp0_;
	const gchar* _tmp1_;
	const gchar* _tmp2_;
	gboolean _tmp3_ = FALSE;
	GeeSet* _tmp7_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_local_ids;
	_tmp1_ = folks_persona_get_iid ((FolksPersona*) self);
	_tmp2_ = _tmp1_;
	_tmp3_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp0_, _tmp2_);
	if (_tmp3_ == FALSE) {
		FolksSmallSet* _tmp4_;
		const gchar* _tmp5_;
		const gchar* _tmp6_;
		_tmp4_ = self->priv->_local_ids;
		_tmp5_ = folks_persona_get_iid ((FolksPersona*) self);
		_tmp6_ = _tmp5_;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp4_, _tmp6_);
	}
	_tmp7_ = self->priv->_local_ids_ro;
	result = _tmp7_;
	return result;
}


static void edsf_persona_real_set_local_ids (FolksLocalIdDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_local_id_details_change_local_ids ((FolksLocalIdDetails*) self, _tmp0_, NULL, NULL);
}


static FolksLocation* edsf_persona_real_get_location (FolksLocationDetails* base) {
	FolksLocation* result;
	EdsfPersona* self;
	FolksLocation* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_location;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_location (FolksLocationDetails* base, FolksLocation* value) {
	EdsfPersona* self;
	FolksLocation* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_location_details_change_location ((FolksLocationDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_postal_addresses (FolksPostalAddressDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_addresses (self, TRUE, FALSE);
	_tmp0_ = self->priv->_postal_addresses_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_postal_addresses (FolksPostalAddressDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_postal_address_details_change_postal_addresses ((FolksPostalAddressDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_phone_numbers (FolksPhoneDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_phones (self, TRUE, FALSE);
	_tmp0_ = self->priv->_phone_numbers_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_phone_numbers (FolksPhoneDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_phone_details_change_phone_numbers ((FolksPhoneDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_email_addresses (FolksEmailDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_email_addresses_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_email_addresses (FolksEmailDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_email_details_change_email_addresses ((FolksEmailDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_notes (FolksNoteDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_notes (self, TRUE, FALSE);
	_tmp0_ = self->priv->_notes_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_notes (FolksNoteDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_note_details_change_notes ((FolksNoteDetails*) self, _tmp0_, NULL, NULL);
}


static gchar** edsf_persona_real_get_linkable_properties (FolksPersona* base, int* result_length1) {
	gchar** result;
	EdsfPersona* self;
	gchar** _tmp0_;
	gint _tmp0__length1;
	self = (EdsfPersona*) base;
	_tmp0_ = EDSF_PERSONA__linkable_properties;
	_tmp0__length1 = G_N_ELEMENTS (EDSF_PERSONA__linkable_properties);
	if (result_length1) {
		*result_length1 = _tmp0__length1;
	}
	result = _tmp0_;
	return result;
}


static gchar** edsf_persona_real_get_writeable_properties (FolksPersona* base, int* result_length1) {
	gchar** result;
	EdsfPersona* self;
	FolksPersonaStore* _tmp0_;
	FolksPersonaStore* _tmp1_;
	gchar** _tmp2_;
	gint _tmp2__length1;
	gchar** _tmp3_;
	gint _tmp3__length1;
	gchar** _tmp4_;
	gint _tmp4__length1;
	self = (EdsfPersona*) base;
	_tmp0_ = folks_persona_get_store ((FolksPersona*) self);
	_tmp1_ = _tmp0_;
	_tmp2_ = folks_persona_store_get_always_writeable_properties (_tmp1_, &_tmp2__length1);
	_tmp3_ = _tmp2_;
	_tmp3__length1 = _tmp2__length1;
	_tmp4_ = _tmp3_;
	_tmp4__length1 = _tmp3__length1;
	if (result_length1) {
		*result_length1 = _tmp4__length1;
	}
	result = _tmp4_;
	return result;
}


static GLoadableIcon* edsf_persona_real_get_avatar (FolksAvatarDetails* base) {
	GLoadableIcon* result;
	EdsfPersona* self;
	GLoadableIcon* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_avatar;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_avatar (FolksAvatarDetails* base, GLoadableIcon* value) {
	EdsfPersona* self;
	GLoadableIcon* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_avatar_details_change_avatar ((FolksAvatarDetails*) self, _tmp0_, NULL, NULL);
}


static FolksStructuredName* edsf_persona_real_get_structured_name (FolksNameDetails* base) {
	FolksStructuredName* result;
	EdsfPersona* self;
	FolksStructuredName* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_structured_name;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_structured_name (FolksNameDetails* base, FolksStructuredName* value) {
	EdsfPersona* self;
	FolksStructuredName* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_name_details_change_structured_name ((FolksNameDetails*) self, _tmp0_, NULL, NULL);
}


const gchar* edsf_persona_get_contact_id (EdsfPersona* self) {
	const gchar* result;
	const gchar* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_contact_id;
	result = _tmp0_;
	return result;
}


static void edsf_persona_set_contact_id (EdsfPersona* self, const gchar* value) {
	const gchar* _tmp0_;
	gchar* _tmp1_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = g_strdup (_tmp0_);
	_g_free0 (self->priv->_contact_id);
	self->priv->_contact_id = _tmp1_;
	g_object_notify ((GObject *) self, "contact-id");
}


static const gchar* edsf_persona_real_get_full_name (FolksNameDetails* base) {
	const gchar* result;
	EdsfPersona* self;
	const gchar* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_full_name;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_full_name (FolksNameDetails* base, const gchar* value) {
	EdsfPersona* self;
	const gchar* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_name_details_change_full_name ((FolksNameDetails*) self, _tmp0_, NULL, NULL);
}


static const gchar* edsf_persona_real_get_nickname (FolksNameDetails* base) {
	const gchar* result;
	EdsfPersona* self;
	const gchar* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_nickname;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_nickname (FolksNameDetails* base, const gchar* value) {
	EdsfPersona* self;
	const gchar* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_name_details_change_nickname ((FolksNameDetails*) self, _tmp0_, NULL, NULL);
}


static FolksGender edsf_persona_real_get_gender (FolksGenderDetails* base) {
	FolksGender result;
	EdsfPersona* self;
	FolksGender _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_gender;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_gender (FolksGenderDetails* base, FolksGender value) {
	EdsfPersona* self;
	FolksGender _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_gender_details_change_gender ((FolksGenderDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_urls (FolksUrlDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_urls (self, TRUE, FALSE);
	_tmp0_ = self->priv->_urls_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_urls (FolksUrlDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_url_details_change_urls ((FolksUrlDetails*) self, _tmp0_, NULL, NULL);
}


static GeeMultiMap* edsf_persona_real_get_im_addresses (FolksImDetails* base) {
	GeeMultiMap* result;
	EdsfPersona* self;
	GeeHashMultiMap* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_im_addresses;
	result = (GeeMultiMap*) _tmp0_;
	return result;
}


static void edsf_persona_real_set_im_addresses (FolksImDetails* base, GeeMultiMap* value) {
	EdsfPersona* self;
	GeeMultiMap* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_im_details_change_im_addresses ((FolksImDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_groups (FolksGroupDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_groups (self, TRUE, FALSE);
	_tmp0_ = self->priv->_groups_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_groups (FolksGroupDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_group_details_change_groups ((FolksGroupDetails*) self, _tmp0_, NULL, NULL);
}


static const gchar* edsf_persona_real_get_calendar_event_id (FolksBirthdayDetails* base) {
	const gchar* result;
	EdsfPersona* self;
	self = (EdsfPersona*) base;
	result = NULL;
	return result;
}


static void edsf_persona_real_set_calendar_event_id (FolksBirthdayDetails* base, const gchar* value) {
	EdsfPersona* self;
	const gchar* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_birthday_details_change_calendar_event_id ((FolksBirthdayDetails*) self, _tmp0_, NULL, NULL);
}


static GDateTime* edsf_persona_real_get_birthday (FolksBirthdayDetails* base) {
	GDateTime* result;
	EdsfPersona* self;
	GDateTime* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_birthday;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_birthday (FolksBirthdayDetails* base, GDateTime* value) {
	EdsfPersona* self;
	GDateTime* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_birthday_details_change_birthday ((FolksBirthdayDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_roles (FolksRoleDetails* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_roles (self, TRUE, FALSE);
	_tmp0_ = self->priv->_roles_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_roles (FolksRoleDetails* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_role_details_change_roles ((FolksRoleDetails*) self, _tmp0_, NULL, NULL);
}


static gboolean edsf_persona_real_get_is_favourite (FolksFavouriteDetails* base) {
	gboolean result;
	EdsfPersona* self;
	gboolean _tmp0_;
	self = (EdsfPersona*) base;
	_edsf_persona_update_groups (self, TRUE, FALSE);
	_tmp0_ = self->priv->_is_favourite;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_is_favourite (FolksFavouriteDetails* base, gboolean value) {
	EdsfPersona* self;
	gboolean _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_favourite_details_change_is_favourite ((FolksFavouriteDetails*) self, _tmp0_, NULL, NULL);
}


static GeeSet* edsf_persona_real_get_anti_links (FolksAntiLinkable* base) {
	GeeSet* result;
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = self->priv->_anti_links_ro;
	result = _tmp0_;
	return result;
}


static void edsf_persona_real_set_anti_links (FolksAntiLinkable* base, GeeSet* value) {
	EdsfPersona* self;
	GeeSet* _tmp0_;
	self = (EdsfPersona*) base;
	_tmp0_ = value;
	folks_anti_linkable_change_anti_links ((FolksAntiLinkable*) self, _tmp0_, NULL, NULL);
}


GeeSet* edsf_persona_get_system_groups (EdsfPersona* self) {
	GeeSet* result;
	GeeSet* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_edsf_persona_update_groups (self, TRUE, TRUE);
	_tmp0_ = self->priv->_system_groups_ro;
	result = _tmp0_;
	return result;
}


void edsf_persona_set_system_groups (EdsfPersona* self, GeeSet* value) {
	GeeSet* _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	edsf_persona_change_system_groups (self, _tmp0_, NULL, NULL);
}


gboolean edsf_persona_get_in_google_personal_group (EdsfPersona* self) {
	gboolean result;
	gboolean _tmp0_;
	g_return_val_if_fail (self != NULL, FALSE);
	_edsf_persona_update_groups (self, TRUE, TRUE);
	_tmp0_ = self->priv->_in_google_personal_group;
	result = _tmp0_;
	return result;
}


void edsf_persona_set_in_google_personal_group (EdsfPersona* self, gboolean value) {
	gboolean _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	edsf_persona_change_in_google_personal_group (self, _tmp0_, NULL, NULL);
}


static GObject * edsf_persona_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties) {
	GObject * obj;
	GObjectClass * parent_class;
	EdsfPersona * self;
	const gchar* _tmp0_;
	const gchar* _tmp1_;
	FolksSmallSet* _tmp2_;
	FolksSmallSet* _tmp3_;
	GeeSet* _tmp4_;
	GeeSet* _tmp5_;
	FolksSmallSet* _tmp6_;
	FolksSmallSet* _tmp7_;
	GeeSet* _tmp8_;
	GeeSet* _tmp9_;
	FolksSmallSet* _tmp10_;
	FolksSmallSet* _tmp11_;
	GeeSet* _tmp12_;
	GeeSet* _tmp13_;
	FolksSmallSet* _tmp14_;
	FolksSmallSet* _tmp15_;
	GeeSet* _tmp16_;
	GeeSet* _tmp17_;
	FolksSmallSet* _tmp18_;
	FolksSmallSet* _tmp19_;
	GeeSet* _tmp20_;
	GeeSet* _tmp21_;
	FolksSmallSet* _tmp22_;
	FolksSmallSet* _tmp23_;
	GeeSet* _tmp24_;
	GeeSet* _tmp25_;
	GeeHashMultiMap* _tmp26_;
	FolksSmallSet* _tmp27_;
	GeeSet* _tmp28_;
	GeeSet* _tmp29_;
	FolksSmallSet* _tmp30_;
	FolksSmallSet* _tmp31_;
	GeeSet* _tmp32_;
	GeeSet* _tmp33_;
	FolksSmallSet* _tmp34_;
	FolksSmallSet* _tmp35_;
	GeeSet* _tmp36_;
	GeeSet* _tmp37_;
	FolksSmallSet* _tmp38_;
	FolksSmallSet* _tmp39_;
	GeeSet* _tmp40_;
	GeeSet* _tmp41_;
	EContact* _tmp42_;
	parent_class = G_OBJECT_CLASS (edsf_persona_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, EDSF_TYPE_PERSONA, EdsfPersona);
	_tmp0_ = folks_persona_get_iid ((FolksPersona*) self);
	_tmp1_ = _tmp0_;
	g_debug ("edsf-persona.vala:951: Creating new Edsf.Persona with IID '%s'", _tmp1_);
	self->priv->_gender = FOLKS_GENDER_UNSPECIFIED;
	_tmp2_ = folks_small_set_new (FOLKS_TYPE_PHONE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_phone_numbers);
	self->priv->_phone_numbers = _tmp2_;
	_tmp3_ = self->priv->_phone_numbers;
	_tmp4_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp3_);
	_tmp5_ = _tmp4_;
	_g_object_unref0 (self->priv->_phone_numbers_ro);
	self->priv->_phone_numbers_ro = _tmp5_;
	_tmp6_ = folks_small_set_new (FOLKS_TYPE_EMAIL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_email_addresses);
	self->priv->_email_addresses = _tmp6_;
	_tmp7_ = self->priv->_email_addresses;
	_tmp8_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp7_);
	_tmp9_ = _tmp8_;
	_g_object_unref0 (self->priv->_email_addresses_ro);
	self->priv->_email_addresses_ro = _tmp9_;
	_tmp10_ = folks_small_set_new (FOLKS_TYPE_NOTE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_notes);
	self->priv->_notes = _tmp10_;
	_tmp11_ = self->priv->_notes;
	_tmp12_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp11_);
	_tmp13_ = _tmp12_;
	_g_object_unref0 (self->priv->_notes_ro);
	self->priv->_notes_ro = _tmp13_;
	_tmp14_ = folks_small_set_new (FOLKS_TYPE_URL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_urls);
	self->priv->_urls = _tmp14_;
	_tmp15_ = self->priv->_urls;
	_tmp16_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp15_);
	_tmp17_ = _tmp16_;
	_g_object_unref0 (self->priv->_urls_ro);
	self->priv->_urls_ro = _tmp17_;
	_tmp18_ = folks_small_set_new (FOLKS_TYPE_POSTAL_ADDRESS_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_postal_addresses);
	self->priv->_postal_addresses = _tmp18_;
	_tmp19_ = self->priv->_postal_addresses;
	_tmp20_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp19_);
	_tmp21_ = _tmp20_;
	_g_object_unref0 (self->priv->_postal_addresses_ro);
	self->priv->_postal_addresses_ro = _tmp21_;
	_tmp22_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	_g_object_unref0 (self->priv->_local_ids);
	self->priv->_local_ids = _tmp22_;
	_tmp23_ = self->priv->_local_ids;
	_tmp24_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp23_);
	_tmp25_ = _tmp24_;
	_g_object_unref0 (self->priv->_local_ids_ro);
	self->priv->_local_ids_ro = _tmp25_;
	_g_object_unref0 (self->priv->_location);
	self->priv->_location = NULL;
	_tmp26_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, FOLKS_TYPE_WEB_SERVICE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_web_service_addresses);
	self->priv->_web_service_addresses = _tmp26_;
	_tmp27_ = self->priv->_email_addresses;
	_tmp28_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp27_);
	_tmp29_ = _tmp28_;
	_g_object_unref0 (self->priv->_email_addresses_ro);
	self->priv->_email_addresses_ro = _tmp29_;
	_tmp30_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	_g_object_unref0 (self->priv->_groups);
	self->priv->_groups = _tmp30_;
	_tmp31_ = self->priv->_groups;
	_tmp32_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp31_);
	_tmp33_ = _tmp32_;
	_g_object_unref0 (self->priv->_groups_ro);
	self->priv->_groups_ro = _tmp33_;
	_tmp34_ = folks_small_set_new (FOLKS_TYPE_ROLE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	_g_object_unref0 (self->priv->_roles);
	self->priv->_roles = _tmp34_;
	_tmp35_ = self->priv->_roles;
	_tmp36_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp35_);
	_tmp37_ = _tmp36_;
	_g_object_unref0 (self->priv->_roles_ro);
	self->priv->_roles_ro = _tmp37_;
	_tmp38_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	_g_object_unref0 (self->priv->_anti_links);
	self->priv->_anti_links = _tmp38_;
	_tmp39_ = self->priv->_anti_links;
	_tmp40_ = gee_abstract_set_get_read_only_view ((GeeAbstractSet*) _tmp39_);
	_tmp41_ = _tmp40_;
	_g_object_unref0 (self->priv->_anti_links_ro);
	self->priv->_anti_links_ro = _tmp41_;
	_tmp42_ = self->priv->_contact;
	_edsf_persona_update (self, _tmp42_);
	return obj;
}


static void edsf_persona_url_type_mapping_copy (const EdsfPersonaUrlTypeMapping* self, EdsfPersonaUrlTypeMapping* dest) {
	const gchar* _tmp0_;
	gchar* _tmp1_;
	const gchar* _tmp2_;
	gchar* _tmp3_;
	_tmp0_ = (*self).vcard_field_name;
	_tmp1_ = g_strdup (_tmp0_);
	_g_free0 ((*dest).vcard_field_name);
	(*dest).vcard_field_name = _tmp1_;
	_tmp2_ = (*self).folks_type;
	_tmp3_ = g_strdup (_tmp2_);
	_g_free0 ((*dest).folks_type);
	(*dest).folks_type = _tmp3_;
}


static void edsf_persona_url_type_mapping_destroy (EdsfPersonaUrlTypeMapping* self) {
	_g_free0 ((*self).vcard_field_name);
	_g_free0 ((*self).folks_type);
}


static EdsfPersonaUrlTypeMapping* edsf_persona_url_type_mapping_dup (const EdsfPersonaUrlTypeMapping* self) {
	EdsfPersonaUrlTypeMapping* dup;
	dup = g_new0 (EdsfPersonaUrlTypeMapping, 1);
	edsf_persona_url_type_mapping_copy (self, dup);
	return dup;
}


static void edsf_persona_url_type_mapping_free (EdsfPersonaUrlTypeMapping* self) {
	edsf_persona_url_type_mapping_destroy (self);
	g_free (self);
}


static GType edsf_persona_url_type_mapping_get_type (void) {
	static volatile gsize edsf_persona_url_type_mapping_type_id__volatile = 0;
	if (g_once_init_enter (&edsf_persona_url_type_mapping_type_id__volatile)) {
		GType edsf_persona_url_type_mapping_type_id;
		edsf_persona_url_type_mapping_type_id = g_boxed_type_register_static ("EdsfPersonaUrlTypeMapping", (GBoxedCopyFunc) edsf_persona_url_type_mapping_dup, (GBoxedFreeFunc) edsf_persona_url_type_mapping_free);
		g_once_init_leave (&edsf_persona_url_type_mapping_type_id__volatile, edsf_persona_url_type_mapping_type_id);
	}
	return edsf_persona_url_type_mapping_type_id__volatile;
}


static void edsf_persona_class_init (EdsfPersonaClass * klass) {
	GTimeZone* _tmp0_;
	edsf_persona_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (EdsfPersonaPrivate));
	FOLKS_PERSONA_CLASS (klass)->linkable_property_to_links = edsf_persona_real_linkable_property_to_links;
	FOLKS_PERSONA_CLASS (klass)->get_linkable_properties = edsf_persona_real_get_linkable_properties;
	FOLKS_PERSONA_CLASS (klass)->get_writeable_properties = edsf_persona_real_get_writeable_properties;
	G_OBJECT_CLASS (klass)->get_property = _vala_edsf_persona_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_edsf_persona_set_property;
	G_OBJECT_CLASS (klass)->constructor = edsf_persona_constructor;
	G_OBJECT_CLASS (klass)->finalize = edsf_persona_finalize;
	/**
	   * The e-d-s contact represented by this Persona
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_CONTACT, g_param_spec_object ("contact", "contact", "contact", e_contact_get_type (), G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT_ONLY));
	/**
	   * {@inheritDoc}
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_WEB_SERVICE_ADDRESSES, g_param_spec_object ("web-service-addresses", "web-service-addresses", "web-service-addresses", GEE_TYPE_MULTI_MAP, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * IDs used to link {@link Edsf.Persona}s.
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_LOCAL_IDS, g_param_spec_object ("local-ids", "local-ids", "local-ids", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.9.2
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_LOCATION, g_param_spec_object ("location", "location", "location", FOLKS_TYPE_LOCATION, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * The postal addresses of the contact.
	   *
	   * A list of postal addresses associated to the contact.
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_POSTAL_ADDRESSES, g_param_spec_object ("postal-addresses", "postal-addresses", "postal-addresses", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_PHONE_NUMBERS, g_param_spec_object ("phone-numbers", "phone-numbers", "phone-numbers", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_EMAIL_ADDRESSES, g_param_spec_object ("email-addresses", "email-addresses", "email-addresses", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_NOTES, g_param_spec_object ("notes", "notes", "notes", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_LINKABLE_PROPERTIES, g_param_spec_boxed ("linkable-properties", "linkable-properties", "linkable-properties", G_TYPE_STRV, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_WRITEABLE_PROPERTIES, g_param_spec_boxed ("writeable-properties", "writeable-properties", "writeable-properties", G_TYPE_STRV, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
	/**
	   * An avatar for the Persona.
	   *
	   * See {@link Folks.AvatarDetails.avatar}.
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_AVATAR, g_param_spec_object ("avatar", "avatar", "avatar", g_loadable_icon_get_type (), G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_STRUCTURED_NAME, g_param_spec_object ("structured-name", "structured-name", "structured-name", FOLKS_TYPE_STRUCTURED_NAME, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * The e-d-s contact uid
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_CONTACT_ID, g_param_spec_string ("contact-id", "contact-id", "contact-id", NULL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT_ONLY));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_FULL_NAME, g_param_spec_string ("full-name", "full-name", "full-name", NULL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_NICKNAME, g_param_spec_string ("nickname", "nickname", "nickname", NULL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_GENDER, g_param_spec_enum ("gender", "gender", "gender", FOLKS_TYPE_GENDER, 0, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_URLS, g_param_spec_object ("urls", "urls", "urls", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_IM_ADDRESSES, g_param_spec_object ("im-addresses", "im-addresses", "im-addresses", GEE_TYPE_MULTI_MAP, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_GROUPS, g_param_spec_object ("groups", "groups", "groups", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * e-d-s has no equivalent field, so this is unsupported.
	   *
	   * @since 0.6.2
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_CALENDAR_EVENT_ID, g_param_spec_string ("calendar-event-id", "calendar-event-id", "calendar-event-id", NULL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.2
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_BIRTHDAY, g_param_spec_boxed ("birthday", "birthday", "birthday", G_TYPE_DATE_TIME, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.6.2
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_ROLES, g_param_spec_object ("roles", "roles", "roles", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * Whether this contact is a user-defined favourite.
	   *
	   * @since 0.6.5
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_IS_FAVOURITE, g_param_spec_boolean ("is-favourite", "is-favourite", "is-favourite", FALSE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * {@inheritDoc}
	   *
	   * @since 0.7.3
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_ANTI_LINKS, g_param_spec_object ("anti-links", "anti-links", "anti-links", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * The complete set of system group identifiers the contact belongs to.
	   * See {@link Persona.change_system_groups} for details.
	   *
	   * @since 0.9.0
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_SYSTEM_GROUPS, g_param_spec_object ("system-groups", "system-groups", "system-groups", GEE_TYPE_SET, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	/**
	   * Whether this contact is in the My Contacts section of the users address
	   * book, rather than the Other section.
	   *
	   * @since 0.7.3
	   */
	g_object_class_install_property (G_OBJECT_CLASS (klass), EDSF_PERSONA_IN_GOOGLE_PERSONAL_GROUP, g_param_spec_boolean ("in-google-personal-group", "in-google-personal-group", "in-google-personal-group", FALSE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_static_rec_mutex_init (&__lock_edsf_persona__im_eds_map);
	_tmp0_ = g_time_zone_new_local ();
	edsf_persona__local_time_zone = _tmp0_;
}


static void edsf_persona_folks_anti_linkable_interface_init (FolksAntiLinkableIface * iface) {
	edsf_persona_folks_anti_linkable_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_anti_links = (void (*)(FolksAntiLinkable*, GeeSet*, GError**)) edsf_persona_real_change_anti_links;
	iface->change_anti_links_finish = edsf_persona_real_change_anti_links_finish;
	iface->get_anti_links = edsf_persona_real_get_anti_links;
	iface->set_anti_links = edsf_persona_real_set_anti_links;
}


static void edsf_persona_folks_avatar_details_interface_init (FolksAvatarDetailsIface * iface) {
	edsf_persona_folks_avatar_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_avatar = (void (*)(FolksAvatarDetails*, GLoadableIcon*, GError**)) edsf_persona_real_change_avatar;
	iface->change_avatar_finish = edsf_persona_real_change_avatar_finish;
	iface->get_avatar = edsf_persona_real_get_avatar;
	iface->set_avatar = edsf_persona_real_set_avatar;
}


static void edsf_persona_folks_birthday_details_interface_init (FolksBirthdayDetailsIface * iface) {
	edsf_persona_folks_birthday_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_birthday = (void (*)(FolksBirthdayDetails*, GDateTime*, GError**)) edsf_persona_real_change_birthday;
	iface->change_birthday_finish = edsf_persona_real_change_birthday_finish;
	iface->get_calendar_event_id = edsf_persona_real_get_calendar_event_id;
	iface->set_calendar_event_id = edsf_persona_real_set_calendar_event_id;
	iface->get_birthday = edsf_persona_real_get_birthday;
	iface->set_birthday = edsf_persona_real_set_birthday;
}


static void edsf_persona_folks_email_details_interface_init (FolksEmailDetailsIface * iface) {
	edsf_persona_folks_email_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_email_addresses = (void (*)(FolksEmailDetails*, GeeSet*, GError**)) edsf_persona_real_change_email_addresses;
	iface->change_email_addresses_finish = edsf_persona_real_change_email_addresses_finish;
	iface->get_email_addresses = edsf_persona_real_get_email_addresses;
	iface->set_email_addresses = edsf_persona_real_set_email_addresses;
}


static void edsf_persona_folks_favourite_details_interface_init (FolksFavouriteDetailsIface * iface) {
	edsf_persona_folks_favourite_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_is_favourite = (void (*)(FolksFavouriteDetails*, gboolean, GError**)) edsf_persona_real_change_is_favourite;
	iface->change_is_favourite_finish = edsf_persona_real_change_is_favourite_finish;
	iface->get_is_favourite = edsf_persona_real_get_is_favourite;
	iface->set_is_favourite = edsf_persona_real_set_is_favourite;
}


static void edsf_persona_folks_gender_details_interface_init (FolksGenderDetailsIface * iface) {
	edsf_persona_folks_gender_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_gender = (void (*)(FolksGenderDetails*, FolksGender, GError**)) edsf_persona_real_change_gender;
	iface->change_gender_finish = edsf_persona_real_change_gender_finish;
	iface->get_gender = edsf_persona_real_get_gender;
	iface->set_gender = edsf_persona_real_set_gender;
}


static void edsf_persona_folks_group_details_interface_init (FolksGroupDetailsIface * iface) {
	edsf_persona_folks_group_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_group = (void (*)(FolksGroupDetails*, const gchar*, gboolean, GError**)) edsf_persona_real_change_group;
	iface->change_group_finish = edsf_persona_real_change_group_finish;
	iface->change_groups = (void (*)(FolksGroupDetails*, GeeSet*, GError**)) edsf_persona_real_change_groups;
	iface->change_groups_finish = edsf_persona_real_change_groups_finish;
	iface->get_groups = edsf_persona_real_get_groups;
	iface->set_groups = edsf_persona_real_set_groups;
}


static void edsf_persona_folks_im_details_interface_init (FolksImDetailsIface * iface) {
	edsf_persona_folks_im_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_im_addresses = (void (*)(FolksImDetails*, GeeMultiMap*, GError**)) edsf_persona_real_change_im_addresses;
	iface->change_im_addresses_finish = edsf_persona_real_change_im_addresses_finish;
	iface->get_im_addresses = edsf_persona_real_get_im_addresses;
	iface->set_im_addresses = edsf_persona_real_set_im_addresses;
}


static void edsf_persona_folks_local_id_details_interface_init (FolksLocalIdDetailsIface * iface) {
	edsf_persona_folks_local_id_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_local_ids = (void (*)(FolksLocalIdDetails*, GeeSet*, GError**)) edsf_persona_real_change_local_ids;
	iface->change_local_ids_finish = edsf_persona_real_change_local_ids_finish;
	iface->get_local_ids = edsf_persona_real_get_local_ids;
	iface->set_local_ids = edsf_persona_real_set_local_ids;
}


static void edsf_persona_folks_location_details_interface_init (FolksLocationDetailsIface * iface) {
	edsf_persona_folks_location_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_location = (void (*)(FolksLocationDetails*, FolksLocation*, GError**)) edsf_persona_real_change_location;
	iface->change_location_finish = edsf_persona_real_change_location_finish;
	iface->get_location = edsf_persona_real_get_location;
	iface->set_location = edsf_persona_real_set_location;
}


static void edsf_persona_folks_name_details_interface_init (FolksNameDetailsIface * iface) {
	edsf_persona_folks_name_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_structured_name = (void (*)(FolksNameDetails*, FolksStructuredName*, GError**)) edsf_persona_real_change_structured_name;
	iface->change_structured_name_finish = edsf_persona_real_change_structured_name_finish;
	iface->change_full_name = (void (*)(FolksNameDetails*, const gchar*, GError**)) edsf_persona_real_change_full_name;
	iface->change_full_name_finish = edsf_persona_real_change_full_name_finish;
	iface->change_nickname = (void (*)(FolksNameDetails*, const gchar*, GError**)) edsf_persona_real_change_nickname;
	iface->change_nickname_finish = edsf_persona_real_change_nickname_finish;
	iface->get_structured_name = edsf_persona_real_get_structured_name;
	iface->set_structured_name = edsf_persona_real_set_structured_name;
	iface->get_full_name = edsf_persona_real_get_full_name;
	iface->set_full_name = edsf_persona_real_set_full_name;
	iface->get_nickname = edsf_persona_real_get_nickname;
	iface->set_nickname = edsf_persona_real_set_nickname;
}


static void edsf_persona_folks_note_details_interface_init (FolksNoteDetailsIface * iface) {
	edsf_persona_folks_note_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_notes = (void (*)(FolksNoteDetails*, GeeSet*, GError**)) edsf_persona_real_change_notes;
	iface->change_notes_finish = edsf_persona_real_change_notes_finish;
	iface->get_notes = edsf_persona_real_get_notes;
	iface->set_notes = edsf_persona_real_set_notes;
}


static void edsf_persona_folks_phone_details_interface_init (FolksPhoneDetailsIface * iface) {
	edsf_persona_folks_phone_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_phone_numbers = (void (*)(FolksPhoneDetails*, GeeSet*, GError**)) edsf_persona_real_change_phone_numbers;
	iface->change_phone_numbers_finish = edsf_persona_real_change_phone_numbers_finish;
	iface->get_phone_numbers = edsf_persona_real_get_phone_numbers;
	iface->set_phone_numbers = edsf_persona_real_set_phone_numbers;
}


static void edsf_persona_folks_role_details_interface_init (FolksRoleDetailsIface * iface) {
	edsf_persona_folks_role_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_roles = (void (*)(FolksRoleDetails*, GeeSet*, GError**)) edsf_persona_real_change_roles;
	iface->change_roles_finish = edsf_persona_real_change_roles_finish;
	iface->get_roles = edsf_persona_real_get_roles;
	iface->set_roles = edsf_persona_real_set_roles;
}


static void edsf_persona_folks_url_details_interface_init (FolksUrlDetailsIface * iface) {
	edsf_persona_folks_url_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_urls = (void (*)(FolksUrlDetails*, GeeSet*, GError**)) edsf_persona_real_change_urls;
	iface->change_urls_finish = edsf_persona_real_change_urls_finish;
	iface->get_urls = edsf_persona_real_get_urls;
	iface->set_urls = edsf_persona_real_set_urls;
}


static void edsf_persona_folks_postal_address_details_interface_init (FolksPostalAddressDetailsIface * iface) {
	edsf_persona_folks_postal_address_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_postal_addresses = (void (*)(FolksPostalAddressDetails*, GeeSet*, GError**)) edsf_persona_real_change_postal_addresses;
	iface->change_postal_addresses_finish = edsf_persona_real_change_postal_addresses_finish;
	iface->get_postal_addresses = edsf_persona_real_get_postal_addresses;
	iface->set_postal_addresses = edsf_persona_real_set_postal_addresses;
}


static void edsf_persona_folks_web_service_details_interface_init (FolksWebServiceDetailsIface * iface) {
	edsf_persona_folks_web_service_details_parent_iface = g_type_interface_peek_parent (iface);
	iface->change_web_service_addresses = (void (*)(FolksWebServiceDetails*, GeeMultiMap*, GError**)) edsf_persona_real_change_web_service_addresses;
	iface->change_web_service_addresses_finish = edsf_persona_real_change_web_service_addresses_finish;
	iface->get_web_service_addresses = edsf_persona_real_get_web_service_addresses;
	iface->set_web_service_addresses = edsf_persona_real_set_web_service_addresses;
}


static void edsf_persona_instance_init (EdsfPersona * self) {
	FolksSmallSet* _tmp0_;
	FolksSmallSet* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	GeeHashMultiMap* _tmp4_;
	self->priv = EDSF_PERSONA_GET_PRIVATE (self);
	_tmp0_ = folks_small_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL, NULL, NULL, NULL);
	self->priv->_local_ids = _tmp0_;
	self->priv->_location = NULL;
	self->priv->_postal_addresses = NULL;
	self->priv->_postal_addresses_ro = NULL;
	self->priv->_phone_numbers = NULL;
	self->priv->_phone_numbers_ro = NULL;
	_tmp1_ = folks_small_set_new (FOLKS_TYPE_EMAIL_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	self->priv->_email_addresses = _tmp1_;
	self->priv->_notes = NULL;
	self->priv->_notes_ro = NULL;
	self->priv->_avatar = NULL;
	self->priv->_structured_name = NULL;
	_tmp2_ = g_strdup ("");
	self->priv->_full_name = _tmp2_;
	_tmp3_ = g_strdup ("");
	self->priv->_nickname = _tmp3_;
	self->priv->_urls = NULL;
	self->priv->_urls_ro = NULL;
	_tmp4_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, FOLKS_TYPE_IM_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
	self->priv->_im_addresses = _tmp4_;
	self->priv->_groups = NULL;
	self->priv->_groups_ro = NULL;
	self->priv->_birthday = NULL;
	self->priv->_roles = NULL;
	self->priv->_roles_ro = NULL;
	self->priv->_is_favourite = FALSE;
	self->priv->_system_groups = NULL;
	self->priv->_system_groups_ro = NULL;
}


static void edsf_persona_finalize (GObject* obj) {
	EdsfPersona * self;
	const gchar* _tmp0_;
	const gchar* _tmp1_;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, EDSF_TYPE_PERSONA, EdsfPersona);
	_tmp0_ = folks_persona_get_uid ((FolksPersona*) self);
	_tmp1_ = _tmp0_;
	g_debug ("edsf-persona.vala:1041: Destroying Edsf.Persona '%s': %p", _tmp1_, self);
	_g_object_unref0 (self->priv->_contact);
	_g_object_unref0 (self->priv->_web_service_addresses);
	_g_object_unref0 (self->priv->_local_ids);
	_g_object_unref0 (self->priv->_local_ids_ro);
	_g_object_unref0 (self->priv->_location);
	_g_object_unref0 (self->priv->_postal_addresses);
	_g_object_unref0 (self->priv->_postal_addresses_ro);
	_g_object_unref0 (self->priv->_phone_numbers);
	_g_object_unref0 (self->priv->_phone_numbers_ro);
	_g_object_unref0 (self->priv->_email_addresses);
	_g_object_unref0 (self->priv->_email_addresses_ro);
	_g_object_unref0 (self->priv->_notes);
	_g_object_unref0 (self->priv->_notes_ro);
	_g_object_unref0 (self->priv->_avatar);
	_g_object_unref0 (self->priv->_structured_name);
	_g_free0 (self->priv->_contact_id);
	_g_free0 (self->priv->_full_name);
	_g_free0 (self->priv->_nickname);
	_g_object_unref0 (self->priv->_urls);
	_g_object_unref0 (self->priv->_urls_ro);
	_g_object_unref0 (self->priv->_im_addresses);
	_g_object_unref0 (self->priv->_groups);
	_g_object_unref0 (self->priv->_groups_ro);
	_g_date_time_unref0 (self->priv->_birthday);
	_g_object_unref0 (self->priv->_roles);
	_g_object_unref0 (self->priv->_roles_ro);
	_g_object_unref0 (self->priv->_anti_links);
	_g_object_unref0 (self->priv->_anti_links_ro);
	_g_object_unref0 (self->priv->_system_groups);
	_g_object_unref0 (self->priv->_system_groups_ro);
	G_OBJECT_CLASS (edsf_persona_parent_class)->finalize (obj);
}


/**
 * A persona subclass which represents a single EDS contact.
 *
 * Each {@link Edsf.Persona} instance represents a single EDS {@link E.Contact}.
 * When the contact is modified (either by this folks client, or a different
 * client), the {@link Edsf.Persona} remains the same, but is assigned a new
 * {@link E.Contact}. It then updates its properties from this new contact.
 */
GType edsf_persona_get_type (void) {
	static volatile gsize edsf_persona_type_id__volatile = 0;
	if (g_once_init_enter (&edsf_persona_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (EdsfPersonaClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) edsf_persona_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (EdsfPersona), 0, (GInstanceInitFunc) edsf_persona_instance_init, NULL };
		static const GInterfaceInfo folks_anti_linkable_info = { (GInterfaceInitFunc) edsf_persona_folks_anti_linkable_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_avatar_details_info = { (GInterfaceInitFunc) edsf_persona_folks_avatar_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_birthday_details_info = { (GInterfaceInitFunc) edsf_persona_folks_birthday_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_email_details_info = { (GInterfaceInitFunc) edsf_persona_folks_email_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_favourite_details_info = { (GInterfaceInitFunc) edsf_persona_folks_favourite_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_gender_details_info = { (GInterfaceInitFunc) edsf_persona_folks_gender_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_group_details_info = { (GInterfaceInitFunc) edsf_persona_folks_group_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_im_details_info = { (GInterfaceInitFunc) edsf_persona_folks_im_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_local_id_details_info = { (GInterfaceInitFunc) edsf_persona_folks_local_id_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_location_details_info = { (GInterfaceInitFunc) edsf_persona_folks_location_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_name_details_info = { (GInterfaceInitFunc) edsf_persona_folks_name_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_note_details_info = { (GInterfaceInitFunc) edsf_persona_folks_note_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_phone_details_info = { (GInterfaceInitFunc) edsf_persona_folks_phone_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_role_details_info = { (GInterfaceInitFunc) edsf_persona_folks_role_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_url_details_info = { (GInterfaceInitFunc) edsf_persona_folks_url_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_postal_address_details_info = { (GInterfaceInitFunc) edsf_persona_folks_postal_address_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo folks_web_service_details_info = { (GInterfaceInitFunc) edsf_persona_folks_web_service_details_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		GType edsf_persona_type_id;
		edsf_persona_type_id = g_type_register_static (FOLKS_TYPE_PERSONA, "EdsfPersona", &g_define_type_info, 0);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_ANTI_LINKABLE, &folks_anti_linkable_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_AVATAR_DETAILS, &folks_avatar_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_BIRTHDAY_DETAILS, &folks_birthday_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_EMAIL_DETAILS, &folks_email_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_FAVOURITE_DETAILS, &folks_favourite_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_GENDER_DETAILS, &folks_gender_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_GROUP_DETAILS, &folks_group_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_IM_DETAILS, &folks_im_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_LOCAL_ID_DETAILS, &folks_local_id_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_LOCATION_DETAILS, &folks_location_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_NAME_DETAILS, &folks_name_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_NOTE_DETAILS, &folks_note_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_PHONE_DETAILS, &folks_phone_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_ROLE_DETAILS, &folks_role_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_URL_DETAILS, &folks_url_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_POSTAL_ADDRESS_DETAILS, &folks_postal_address_details_info);
		g_type_add_interface_static (edsf_persona_type_id, FOLKS_TYPE_WEB_SERVICE_DETAILS, &folks_web_service_details_info);
		g_once_init_leave (&edsf_persona_type_id__volatile, edsf_persona_type_id);
	}
	return edsf_persona_type_id__volatile;
}


static void _vala_edsf_persona_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	EdsfPersona * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, EDSF_TYPE_PERSONA, EdsfPersona);
	switch (property_id) {
		case EDSF_PERSONA_CONTACT:
		g_value_set_object (value, edsf_persona_get_contact (self));
		break;
		case EDSF_PERSONA_WEB_SERVICE_ADDRESSES:
		g_value_set_object (value, folks_web_service_details_get_web_service_addresses ((FolksWebServiceDetails*) self));
		break;
		case EDSF_PERSONA_LOCAL_IDS:
		g_value_set_object (value, folks_local_id_details_get_local_ids ((FolksLocalIdDetails*) self));
		break;
		case EDSF_PERSONA_LOCATION:
		g_value_set_object (value, folks_location_details_get_location ((FolksLocationDetails*) self));
		break;
		case EDSF_PERSONA_POSTAL_ADDRESSES:
		g_value_set_object (value, folks_postal_address_details_get_postal_addresses ((FolksPostalAddressDetails*) self));
		break;
		case EDSF_PERSONA_PHONE_NUMBERS:
		g_value_set_object (value, folks_phone_details_get_phone_numbers ((FolksPhoneDetails*) self));
		break;
		case EDSF_PERSONA_EMAIL_ADDRESSES:
		g_value_set_object (value, folks_email_details_get_email_addresses ((FolksEmailDetails*) self));
		break;
		case EDSF_PERSONA_NOTES:
		g_value_set_object (value, folks_note_details_get_notes ((FolksNoteDetails*) self));
		break;
		case EDSF_PERSONA_LINKABLE_PROPERTIES:
		{
			int length;
			g_value_set_boxed (value, folks_persona_get_linkable_properties ((FolksPersona*) self, &length));
		}
		break;
		case EDSF_PERSONA_WRITEABLE_PROPERTIES:
		{
			int length;
			g_value_set_boxed (value, folks_persona_get_writeable_properties ((FolksPersona*) self, &length));
		}
		break;
		case EDSF_PERSONA_AVATAR:
		g_value_set_object (value, folks_avatar_details_get_avatar ((FolksAvatarDetails*) self));
		break;
		case EDSF_PERSONA_STRUCTURED_NAME:
		g_value_set_object (value, folks_name_details_get_structured_name ((FolksNameDetails*) self));
		break;
		case EDSF_PERSONA_CONTACT_ID:
		g_value_set_string (value, edsf_persona_get_contact_id (self));
		break;
		case EDSF_PERSONA_FULL_NAME:
		g_value_set_string (value, folks_name_details_get_full_name ((FolksNameDetails*) self));
		break;
		case EDSF_PERSONA_NICKNAME:
		g_value_set_string (value, folks_name_details_get_nickname ((FolksNameDetails*) self));
		break;
		case EDSF_PERSONA_GENDER:
		g_value_set_enum (value, folks_gender_details_get_gender ((FolksGenderDetails*) self));
		break;
		case EDSF_PERSONA_URLS:
		g_value_set_object (value, folks_url_details_get_urls ((FolksUrlDetails*) self));
		break;
		case EDSF_PERSONA_IM_ADDRESSES:
		g_value_set_object (value, folks_im_details_get_im_addresses ((FolksImDetails*) self));
		break;
		case EDSF_PERSONA_GROUPS:
		g_value_set_object (value, folks_group_details_get_groups ((FolksGroupDetails*) self));
		break;
		case EDSF_PERSONA_CALENDAR_EVENT_ID:
		g_value_set_string (value, folks_birthday_details_get_calendar_event_id ((FolksBirthdayDetails*) self));
		break;
		case EDSF_PERSONA_BIRTHDAY:
		g_value_set_boxed (value, folks_birthday_details_get_birthday ((FolksBirthdayDetails*) self));
		break;
		case EDSF_PERSONA_ROLES:
		g_value_set_object (value, folks_role_details_get_roles ((FolksRoleDetails*) self));
		break;
		case EDSF_PERSONA_IS_FAVOURITE:
		g_value_set_boolean (value, folks_favourite_details_get_is_favourite ((FolksFavouriteDetails*) self));
		break;
		case EDSF_PERSONA_ANTI_LINKS:
		g_value_set_object (value, folks_anti_linkable_get_anti_links ((FolksAntiLinkable*) self));
		break;
		case EDSF_PERSONA_SYSTEM_GROUPS:
		g_value_set_object (value, edsf_persona_get_system_groups (self));
		break;
		case EDSF_PERSONA_IN_GOOGLE_PERSONAL_GROUP:
		g_value_set_boolean (value, edsf_persona_get_in_google_personal_group (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_edsf_persona_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	EdsfPersona * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, EDSF_TYPE_PERSONA, EdsfPersona);
	switch (property_id) {
		case EDSF_PERSONA_CONTACT:
		edsf_persona_set_contact (self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_WEB_SERVICE_ADDRESSES:
		folks_web_service_details_set_web_service_addresses ((FolksWebServiceDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_LOCAL_IDS:
		folks_local_id_details_set_local_ids ((FolksLocalIdDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_LOCATION:
		folks_location_details_set_location ((FolksLocationDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_POSTAL_ADDRESSES:
		folks_postal_address_details_set_postal_addresses ((FolksPostalAddressDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_PHONE_NUMBERS:
		folks_phone_details_set_phone_numbers ((FolksPhoneDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_EMAIL_ADDRESSES:
		folks_email_details_set_email_addresses ((FolksEmailDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_NOTES:
		folks_note_details_set_notes ((FolksNoteDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_AVATAR:
		folks_avatar_details_set_avatar ((FolksAvatarDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_STRUCTURED_NAME:
		folks_name_details_set_structured_name ((FolksNameDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_CONTACT_ID:
		edsf_persona_set_contact_id (self, g_value_get_string (value));
		break;
		case EDSF_PERSONA_FULL_NAME:
		folks_name_details_set_full_name ((FolksNameDetails*) self, g_value_get_string (value));
		break;
		case EDSF_PERSONA_NICKNAME:
		folks_name_details_set_nickname ((FolksNameDetails*) self, g_value_get_string (value));
		break;
		case EDSF_PERSONA_GENDER:
		folks_gender_details_set_gender ((FolksGenderDetails*) self, g_value_get_enum (value));
		break;
		case EDSF_PERSONA_URLS:
		folks_url_details_set_urls ((FolksUrlDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_IM_ADDRESSES:
		folks_im_details_set_im_addresses ((FolksImDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_GROUPS:
		folks_group_details_set_groups ((FolksGroupDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_CALENDAR_EVENT_ID:
		folks_birthday_details_set_calendar_event_id ((FolksBirthdayDetails*) self, g_value_get_string (value));
		break;
		case EDSF_PERSONA_BIRTHDAY:
		folks_birthday_details_set_birthday ((FolksBirthdayDetails*) self, g_value_get_boxed (value));
		break;
		case EDSF_PERSONA_ROLES:
		folks_role_details_set_roles ((FolksRoleDetails*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_IS_FAVOURITE:
		folks_favourite_details_set_is_favourite ((FolksFavouriteDetails*) self, g_value_get_boolean (value));
		break;
		case EDSF_PERSONA_ANTI_LINKS:
		folks_anti_linkable_set_anti_links ((FolksAntiLinkable*) self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_SYSTEM_GROUPS:
		edsf_persona_set_system_groups (self, g_value_get_object (value));
		break;
		case EDSF_PERSONA_IN_GOOGLE_PERSONAL_GROUP:
		edsf_persona_set_in_google_personal_group (self, g_value_get_boolean (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



